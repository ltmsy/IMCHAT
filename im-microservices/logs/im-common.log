2025-08-15 00:00:18.723 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:00:19.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:00:19.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:00:19.172 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:00:48.722 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:00:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:00:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:01:18.721 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:01:19.131 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:01:19.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:01:48.725 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:01:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:01:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:02:18.723 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:02:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:02:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:02:48.728 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:02:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:02:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:03:18.730 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:03:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:03:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:03:48.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:03:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:03:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:04:18.731 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:04:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:04:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:04:48.728 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:04:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:04:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:05:18.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:05:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:05:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:05:19.174 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:05:48.724 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:05:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:05:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:06:18.730 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:06:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:06:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:06:48.730 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:06:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:06:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:07:18.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:07:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:07:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:07:48.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:07:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:07:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:08:18.725 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:08:19.130 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:08:19.130 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:08:48.730 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:08:49.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:08:49.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:09:18.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:09:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:09:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:09:48.728 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:09:49.129 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:09:49.130 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:10:18.727 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:10:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:10:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:10:19.173 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:10:48.724 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:10:49.133 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:10:49.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:11:18.721 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:11:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:11:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:11:48.729 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:11:49.131 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:11:49.131 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:12:18.729 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:12:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:12:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:12:48.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:12:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:12:49.133 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:13:18.727 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:13:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:13:19.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:13:48.711 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:13:49.122 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:13:49.123 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:14:18.692 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:14:19.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:14:19.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:14:48.691 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:14:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:14:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:15:18.691 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:15:19.097 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:15:19.097 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:15:19.140 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:15:48.695 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:15:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:15:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:16:18.695 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:16:19.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:16:19.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:16:48.690 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:16:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:16:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:17:18.688 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:17:19.096 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:17:19.096 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:17:48.690 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:17:49.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:17:49.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:18:18.690 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:18:19.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:18:19.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:18:48.695 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:18:49.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:18:49.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:19:18.688 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:19:19.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:19:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:19:48.694 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:19:49.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:19:49.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:20:18.689 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:20:19.097 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:20:19.097 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:20:19.139 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:20:48.693 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:20:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:20:49.103 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:21:18.688 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:21:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:21:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:21:48.693 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:21:49.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:21:49.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:22:18.688 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:22:19.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:22:19.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:22:48.692 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:22:49.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:22:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:23:18.687 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:23:19.093 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:23:19.093 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:23:48.690 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:23:49.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:23:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:24:18.691 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:24:19.092 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:24:19.092 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:24:48.691 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:24:49.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:24:49.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:25:18.691 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:25:19.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:25:19.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:25:19.134 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:25:48.691 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:25:49.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:25:49.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:26:18.685 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:26:19.090 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:26:19.091 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:26:48.690 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:26:49.093 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:26:49.093 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:27:18.683 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:27:19.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:27:19.099 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:27:48.690 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:27:49.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:27:49.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:28:18.696 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:28:19.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:28:19.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:28:48.689 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:28:49.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:28:49.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:29:18.687 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:29:19.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:29:19.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:29:48.684 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:29:49.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:29:49.096 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:30:18.685 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:30:19.096 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:30:19.096 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:30:19.133 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:30:48.687 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:30:49.097 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:30:49.098 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:31:18.687 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:31:19.090 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:31:19.091 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:31:48.689 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:31:49.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:31:49.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:32:18.687 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:32:19.091 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:32:19.092 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:32:48.679 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:32:49.090 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:32:49.091 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:33:18.681 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:33:19.093 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:33:19.094 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:33:48.679 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:33:49.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:33:49.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:34:18.687 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:34:19.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:34:19.089 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:34:48.679 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:34:49.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:34:49.096 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:35:18.684 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:35:19.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:35:19.095 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:35:19.132 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:35:48.711 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:35:49.123 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:35:49.123 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:36:18.726 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:36:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:36:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:36:48.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:36:49.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:36:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:37:18.725 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:37:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:37:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:37:48.727 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:37:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:37:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:38:18.721 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:38:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:38:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:38:48.727 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:38:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:38:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:39:18.728 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:39:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:39:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:39:48.727 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:39:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:39:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:40:18.727 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:40:19.133 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:40:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:40:19.170 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:40:48.727 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:40:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:40:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:41:18.727 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:41:19.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:41:19.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:41:48.730 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:41:49.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:41:49.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:42:18.731 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:42:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:42:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:42:48.731 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:42:49.131 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:42:49.132 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:43:18.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:43:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:43:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:43:48.731 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:43:49.131 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:43:49.131 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:44:18.724 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:44:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:44:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:44:48.728 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:44:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:44:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:45:18.731 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:45:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:45:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:45:19.173 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:45:48.731 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:45:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:45:49.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:46:18.728 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:46:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:46:19.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:46:48.728 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:46:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:46:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:47:18.731 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:47:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:47:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:47:48.728 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:47:49.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:47:49.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:48:18.731 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:48:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:48:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:48:48.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:48:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:48:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:49:18.729 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:49:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:49:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:49:48.726 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:49:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:49:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:50:18.726 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:50:19.133 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:50:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:50:19.179 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:50:47.825 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 92591 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 00:50:47.826 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 00:50:47.826 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 00:50:48.084 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 00:50:48.084 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 00:50:48.091 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 00:50:48.230 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 00:50:48.230 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 00:50:48.232 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 00:50:48.269 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 00:50:48.624 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 00:50:48.628 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 00:50:48.628 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 00:50:48.647 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 00:50:48.647 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 801 ms
2025-08-15 00:50:48.724 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=4, success=4, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 00:50:48.742 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 00:50:48.758 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 00:50:48.759 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 00:50:48.760 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 00:50:48.779 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 00:50:48.810 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 00:50:48.824 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 00:50:48.824 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 00:50:48.834 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 00:50:48.836 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 00:50:48.963 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 00:50:49.116 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 00:50:49.119 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 00:50:49.131 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 00:50:49.132 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 00:50:49.132 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 00:50:49.132 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 00:50:49.132 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 00:50:49.133 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 00:50:49.134 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 00:50:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:50:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:50:49.140 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 00:50:49.140 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 00:50:49.141 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 00:50:49.146 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 00:50:49.151 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 00:50:49.151 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 00:50:49.151 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 00:50:49.152 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 00:50:49.152 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 00:50:49.152 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 00:50:49.165 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 00:50:49.165 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 00:50:49.167 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 00:50:49.167 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@8aafd70[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:49.168 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 00:50:49.168 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 00:50:49.264 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 00:50:49.264 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3e7fc07e[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:49.265 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 00:50:49.265 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@377d55[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:49.266 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 00:50:49.266 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1ef7e4c7[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:49.268 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 00:50:49.268 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6c0bf8f4[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:49.269 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 00:50:49.269 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@52b77d5e[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:49.272 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 00:50:49.272 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 00:50:49.278 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 00:50:49.375 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 00:50:49.385 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 00:50:49.385 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 00:50:49.394 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 00:50:49.394 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 00:50:49.394 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 00:50:49.469 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 00:50:49.520 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 00:50:49.618 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 00:50:49.857 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 00:50:49.892 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@17cea679, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1f3c3291, org.springframework.security.web.context.SecurityContextHolderFilter@b6a5cf5, org.springframework.security.web.header.HeaderWriterFilter@46c6541f, com.acme.im.common.security.jwt.JwtAuthenticationFilter@66dd04e2, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5771adf3, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@32e9c8, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@1a0c384d, org.springframework.security.web.session.SessionManagementFilter@21590b35, org.springframework.security.web.access.ExceptionTranslationFilter@779e66e5, org.springframework.security.web.access.intercept.AuthorizationFilter@143abb21]
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 00:50:50.187 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 00:50:50.188 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 00:50:50.188 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 00:50:50.190 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 00:50:50.190 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 00:50:50.190 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 00:50:50.190 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 00:50:50.190 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 00:50:50.191 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 00:50:50.192 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 00:50:50.193 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 00:50:50.193 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 00:50:50.209 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 00:50:50.209 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 00:50:50.210 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 00:50:50.210 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 00:50:50.218 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 00:50:50.219 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 00:50:50.219 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4d05b931]]
2025-08-15 00:50:50.219 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 00:50:50.226 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.554 seconds (process running for 2.718)
2025-08-15 00:50:50.229 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 00:50:50.229 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 00:50:50.229 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 00:50:50.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 00:50:50.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 00:50:50.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 00:50:50.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 00:50:50.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 00:50:50.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 00:50:50.231 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 00:50:50.231 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 00:50:50.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 00:50:50.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 00:50:50.232 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 00:50:50.232 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 00:50:50.232 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 00:50:50.268 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 00:50:50.636 [RMI TCP Connection(1)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 00:50:50.637 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 00:50:50.637 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 00:50:50.660 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 00:50:50.660 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 00:50:50.660 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 00:50:50.660 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 00:50:50.660 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 00:50:50.660 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 00:50:50.660 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 00:50:50.662 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 00:50:50.663 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 00:50:50.663 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 00:50:50.663 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=4
2025-08-15 00:50:51.977 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 92611 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 00:50:51.978 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 00:50:51.978 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 00:50:52.275 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 00:50:52.275 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 00:50:52.281 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 00:50:52.412 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 00:50:52.412 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 00:50:52.417 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 00:50:52.796 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 00:50:52.800 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 00:50:52.800 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 00:50:52.821 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 00:50:52.821 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 811 ms
2025-08-15 00:50:52.919 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 00:50:52.924 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 00:50:52.941 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 00:50:52.971 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 00:50:52.985 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 00:50:52.985 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 00:50:52.988 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 00:50:52.988 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 00:50:52.988 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 00:50:52.988 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 00:50:53.050 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 00:50:53.051 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 00:50:53.294 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 00:50:53.363 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 00:50:53.367 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 00:50:53.384 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 00:50:53.385 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 00:50:53.385 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 00:50:53.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 00:50:53.386 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 00:50:53.387 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 00:50:53.394 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 00:50:53.394 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 00:50:53.395 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 00:50:53.398 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 00:50:53.407 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 00:50:53.408 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 00:50:53.408 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 00:50:53.409 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 00:50:53.409 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 00:50:53.409 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 00:50:53.420 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 00:50:53.420 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 00:50:53.422 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 00:50:53.422 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@34525143[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:53.423 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 00:50:53.423 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 00:50:53.431 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 00:50:53.431 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6aed4a23[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:53.432 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 00:50:53.432 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5cf6ba1c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:53.433 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 00:50:53.433 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2fcad739[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:53.434 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 00:50:53.434 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@79a92277[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:53.435 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 00:50:53.435 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@e98adb2[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 00:50:53.441 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 00:50:53.441 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 00:50:53.447 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 00:50:53.541 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 00:50:53.550 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 00:50:53.550 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 00:50:53.557 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 00:50:53.557 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 00:50:53.557 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 00:50:53.621 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 00:50:53.671 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 00:50:54.027 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 00:50:54.067 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@45144fdf, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@57cc7d9e, org.springframework.security.web.context.SecurityContextHolderFilter@54950027, org.springframework.security.web.header.HeaderWriterFilter@5c934077, com.acme.im.common.security.jwt.JwtAuthenticationFilter@16e5344c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5498d2a2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@453c10c2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@23c07745, org.springframework.security.web.session.SessionManagementFilter@4c627575, org.springframework.security.web.access.ExceptionTranslationFilter@1476e447, org.springframework.security.web.access.intercept.AuthorizationFilter@72e36d0f]
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 00:50:54.355 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 00:50:54.356 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 00:50:54.357 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 00:50:54.357 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 00:50:54.358 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 00:50:54.359 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 00:50:54.359 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 00:50:54.374 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 00:50:54.374 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 00:50:54.375 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 00:50:54.375 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 00:50:54.387 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 00:50:54.394 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.566 seconds (process running for 2.731)
2025-08-15 00:50:54.397 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 00:50:54.397 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 00:50:54.397 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 00:50:54.397 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 00:50:54.398 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 00:50:54.398 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 00:50:54.398 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 00:50:54.398 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 00:50:54.398 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 00:50:54.398 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 00:50:54.398 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 00:50:54.398 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 00:50:54.398 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 00:50:54.398 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 00:50:54.398 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 00:50:54.398 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 00:50:54.400 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 00:50:54.855 [RMI TCP Connection(4)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 00:50:54.855 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 00:50:54.856 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 00:50:55.237 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 00:50:55.238 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 00:50:55.238 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 00:50:55.238 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 00:50:55.244 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 00:50:55.244 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 00:50:59.400 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 00:50:59.401 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 00:50:59.401 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 00:50:59.402 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 00:50:59.417 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 00:50:59.417 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 00:51:18.826 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:51:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:51:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:51:22.991 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:51:23.389 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:51:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:51:48.826 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:51:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:51:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:51:50.212 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 00:51:52.990 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:51:53.386 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:51:53.387 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:52:18.826 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:52:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:52:19.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:52:22.990 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:52:23.390 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:52:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:52:48.829 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:52:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:52:49.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:52:52.987 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:52:53.386 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:52:53.386 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:53:08.938 [http-nio-8080-exec-1] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<java.lang.String>> com.acme.im.business.module.user.controller.UserController.loginUser(com.acme.im.business.module.user.dto.UserLoginRequest): [Field error in object 'userLoginRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userLoginRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userLoginRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 00:53:14.312 [http-nio-8080-exec-2] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<java.lang.String>> com.acme.im.business.module.user.controller.UserController.loginUser(com.acme.im.business.module.user.dto.UserLoginRequest): [Field error in object 'userLoginRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userLoginRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userLoginRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 00:53:18.830 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:53:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:53:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:53:20.022 [http-nio-8080-exec-3] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<com.acme.im.business.module.user.dto.UserDTO>> com.acme.im.business.module.user.controller.UserController.registerUser(com.acme.im.business.module.user.dto.UserRegisterRequest): [Field error in object 'userRegisterRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userRegisterRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 00:53:22.990 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:53:23.389 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:53:23.390 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:53:48.827 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:53:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:53:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:53:52.991 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:53:53.386 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:53:53.387 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:54:18.829 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:54:19.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:54:19.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:54:22.988 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:54:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:54:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:54:48.829 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:54:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:54:49.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:54:52.987 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:54:53.389 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:54:53.390 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:55:18.827 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:55:19.137 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:55:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:55:22.989 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:55:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:55:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:55:48.827 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:55:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:55:49.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:55:49.171 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:55:50.236 [cache-3] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 00:55:50.236 [cache-4] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 00:55:52.986 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:55:53.388 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:55:53.388 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:55:53.427 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 00:56:18.827 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:56:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:56:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:56:22.991 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:56:23.390 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:56:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:56:48.827 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:56:49.134 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:56:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:56:49.170 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 00:56:52.989 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:56:53.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:56:53.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:56:53.424 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 00:57:18.830 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:57:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:57:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:57:22.988 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:57:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:57:23.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:57:48.826 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:57:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:57:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:57:52.991 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:57:53.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:57:53.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:58:18.829 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:58:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:58:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:58:22.988 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:58:23.387 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:58:23.387 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:58:48.827 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:58:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:58:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:58:52.991 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:58:53.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:58:53.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:59:18.827 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:59:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:59:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:59:22.989 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:59:23.391 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:59:23.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:59:48.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:59:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:59:49.135 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 00:59:52.992 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 00:59:53.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 00:59:53.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:00:18.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:00:19.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:00:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:00:22.992 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:00:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:00:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:00:48.834 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:00:49.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:00:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:00:49.174 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:00:50.243 [cache-5] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:00:50.244 [cache-6] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:00:52.997 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:00:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:00:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:00:53.430 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:01:18.835 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:01:19.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:01:19.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:01:22.995 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:01:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:01:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:01:48.827 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:01:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:01:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:01:52.994 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:01:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:01:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:02:18.835 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:02:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:02:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:02:22.992 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:02:23.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:02:23.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:02:48.829 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:02:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:02:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:02:52.994 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:02:53.388 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:02:53.388 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:03:18.834 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:03:19.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:03:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:03:22.996 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:03:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:03:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:03:48.837 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:03:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:03:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:03:52.995 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:03:53.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:03:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:04:18.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:04:19.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:04:19.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:04:22.996 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:04:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:04:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:04:48.829 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:04:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:04:49.136 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:04:52.998 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:04:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:04:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:05:18.832 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:05:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:05:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:05:22.996 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:05:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:05:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:05:48.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:05:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:05:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:05:49.176 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:05:50.254 [cache-8] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:05:50.255 [cache-7] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:05:52.994 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:05:53.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:05:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:05:53.431 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:06:18.830 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:06:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:06:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:06:22.989 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:06:23.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:06:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:06:48.831 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:06:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:06:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:06:52.997 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:06:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:06:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:07:18.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:07:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:07:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:07:22.994 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:07:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:07:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:07:48.830 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:07:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:07:49.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:07:52.997 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:07:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:07:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:08:18.832 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:08:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:08:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:08:22.990 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:08:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:08:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:08:48.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:08:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:08:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:08:52.996 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:08:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:08:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:09:18.833 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:09:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:09:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:09:22.996 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:09:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:09:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:09:48.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:09:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:09:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:09:52.993 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:09:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:09:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:10:18.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:10:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:10:19.138 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:10:22.993 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:10:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:10:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:10:48.834 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:10:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:10:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:10:49.177 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:10:50.267 [cache-9] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:10:50.267 [cache-10] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:10:52.994 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:10:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:10:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:10:53.427 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:11:18.837 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:11:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:11:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:11:22.998 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:11:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:11:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:11:48.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:11:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:11:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:11:52.997 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:11:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:11:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:12:18.829 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:12:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:12:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:12:22.995 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:12:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:12:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:12:48.833 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:12:49.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:12:49.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:12:52.994 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:12:53.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:12:53.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:13:18.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:13:19.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:13:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:13:22.995 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:13:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:13:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:13:48.836 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:13:49.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:13:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:13:52.994 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:13:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:13:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:14:18.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:14:19.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:14:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:14:22.996 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:14:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:14:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:14:48.835 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:14:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:14:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:14:52.999 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:14:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:14:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:15:18.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:15:19.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:15:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:15:22.992 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:15:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:15:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:15:48.837 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:15:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:15:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:15:49.179 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:15:50.278 [cache-12] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:15:50.279 [cache-11] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:15:52.999 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:15:53.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:15:53.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:15:53.433 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:16:18.838 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:16:19.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:16:19.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:16:22.992 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:16:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:16:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:16:48.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:16:49.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:16:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:16:52.993 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:16:53.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:16:53.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:17:18.833 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:17:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:17:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:17:22.998 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:17:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:17:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:17:48.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:17:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:17:49.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:17:52.995 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:17:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:17:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:18:18.830 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:18:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:18:19.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:18:22.997 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:18:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:18:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:18:48.830 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:18:49.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:18:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:18:52.991 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:18:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:18:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:19:18.831 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:19:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:19:19.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:19:22.998 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:19:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:19:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:19:48.830 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:19:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:19:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:19:52.998 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:19:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:19:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:20:18.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:20:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:20:19.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:20:23.000 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:20:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:20:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:20:48.831 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:20:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:20:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:20:49.177 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:20:50.284 [cache-14] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:20:50.285 [cache-13] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:20:52.995 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:20:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:20:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:20:53.432 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:21:18.838 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:21:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:21:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:21:22.999 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:21:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:21:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:21:48.833 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:21:49.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:21:49.141 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:21:50.224 [MessageBroker-11] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 3, completed tasks = 16]
2025-08-15 01:21:52.991 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:21:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:21:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:22:18.834 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:22:19.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:22:19.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:22:22.997 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:22:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:22:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:22:48.831 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:22:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:22:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:22:52.999 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:22:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:22:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:23:18.831 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:23:19.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:23:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:23:22.996 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:23:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:23:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:23:48.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:23:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:23:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:23:52.993 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:23:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:23:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:24:18.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:24:19.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:24:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:24:22.998 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:24:23.392 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:24:23.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:24:48.839 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:24:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:24:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:24:52.997 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:24:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:24:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:25:18.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:25:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:25:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:25:22.996 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:25:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:25:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:25:48.833 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:25:49.139 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:25:49.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:25:49.181 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:25:50.296 [cache-15] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:25:50.296 [cache-16] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:25:52.997 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:25:53.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:25:53.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:25:53.434 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:26:18.840 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:26:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:26:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:26:22.998 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:26:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:26:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:26:48.836 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:26:49.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:26:49.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:26:52.998 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:26:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:26:53.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:27:18.834 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:27:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:27:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:27:22.999 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:27:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:27:23.395 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:27:48.838 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:27:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:27:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:27:52.994 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:27:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:27:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:28:18.836 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:28:19.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:28:19.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:28:22.997 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:28:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:28:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:28:48.839 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:28:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:28:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:28:53.000 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:28:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:28:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:29:18.838 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:29:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:29:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:29:22.991 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:29:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:29:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:29:48.835 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:29:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:29:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:29:53.000 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:29:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:29:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:30:18.840 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:30:19.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:30:19.140 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:30:22.994 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:30:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:30:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:30:48.839 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:30:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:30:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:30:49.177 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:30:50.307 [cache-18] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:30:50.308 [cache-17] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:30:52.994 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:30:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:30:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:30:53.434 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:31:18.832 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:31:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:31:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:31:23.000 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:31:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:31:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:31:48.837 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:31:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:31:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:31:53.000 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:31:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:31:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:32:18.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:32:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:32:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:32:22.999 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:32:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:32:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:32:48.837 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:32:49.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:32:49.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:32:52.996 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:32:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:32:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:33:18.841 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:33:19.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:33:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:33:22.994 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:33:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:33:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:33:48.836 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:33:49.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:33:49.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:33:52.999 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:33:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:33:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:34:18.840 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:34:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:34:19.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:34:22.999 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:34:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:34:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:34:48.841 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:34:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:34:49.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:34:52.993 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:34:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:34:53.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:35:18.839 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:35:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:35:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:35:23.000 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:35:23.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:35:23.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:35:48.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:35:49.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:35:49.143 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:35:49.182 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:35:50.318 [cache-19] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:35:50.318 [cache-20] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:35:52.993 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:35:53.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:35:53.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:35:53.437 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:36:18.839 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:36:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:36:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:36:22.998 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:36:23.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:36:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:36:48.840 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:36:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:36:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:36:53.002 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:36:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:36:53.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:37:18.833 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:37:19.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:37:19.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:37:22.994 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:37:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:37:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:37:48.841 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:37:49.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:37:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:37:53.002 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:37:53.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:37:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:38:18.842 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:38:19.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:38:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:38:23.000 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:38:23.399 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:38:23.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:38:48.833 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:38:49.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:38:49.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:38:53.001 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:38:53.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:38:53.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:39:18.835 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:39:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:39:19.150 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:39:23.001 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:39:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:39:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:39:48.839 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:39:49.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:39:49.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:39:53.001 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:39:53.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:39:53.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:40:18.838 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:40:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:40:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:40:22.994 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:40:23.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:40:23.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:40:48.842 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:40:49.150 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:40:49.151 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:40:49.182 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:40:50.330 [cache-22] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:40:50.330 [cache-21] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:40:53.002 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:40:53.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:40:53.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:40:53.438 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:41:18.838 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:41:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:41:19.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:41:23.002 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:41:23.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:41:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:41:48.840 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:41:49.148 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:41:49.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:41:53.002 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:41:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:41:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:42:18.836 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:42:19.150 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:42:19.151 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:42:22.996 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:42:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:42:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:42:48.840 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:42:49.150 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:42:49.150 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:42:52.997 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:42:53.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:42:53.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:43:18.843 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:43:19.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:43:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:43:23.002 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:43:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:43:23.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:43:48.842 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:43:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:43:49.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:43:53.002 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:43:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:43:53.400 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:44:18.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:44:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:44:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:44:23.003 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:44:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:44:23.404 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:44:48.842 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:44:49.149 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:44:49.150 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:44:52.995 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:44:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:44:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:45:18.843 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:45:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:45:19.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:45:23.003 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:45:23.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:45:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:45:48.835 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:45:49.151 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:45:49.151 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:45:49.179 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:45:50.341 [cache-24] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:45:50.341 [cache-23] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:45:52.998 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:45:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:45:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:45:53.438 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:46:18.842 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:46:19.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:46:19.147 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:46:22.998 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:46:23.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:46:23.402 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:46:48.842 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:46:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:46:49.144 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:46:53.003 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:46:53.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:46:53.396 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:47:18.836 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:47:19.151 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:47:19.151 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:47:23.003 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:47:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:47:23.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:47:48.835 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:47:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:47:49.146 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:47:53.003 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:47:53.397 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:47:53.398 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:48:18.841 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:48:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:48:19.142 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:48:22.995 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:48:23.393 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:48:23.394 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:48:48.801 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:48:49.115 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:48:49.115 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:48:52.971 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:48:53.366 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:48:53.366 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:49:18.799 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:49:19.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:49:19.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:49:22.964 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:49:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:49:23.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:49:48.805 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:49:49.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:49:49.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:49:52.960 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:49:53.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:49:53.366 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:50:18.806 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:50:19.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:50:19.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:50:22.965 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:50:23.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:50:23.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:50:48.798 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:50:49.112 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:50:49.113 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:50:49.141 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:50:50.307 [cache-25] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:50:50.308 [cache-26] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:50:52.963 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:50:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:50:53.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:50:53.401 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:51:18.804 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:51:19.112 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:51:19.112 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:51:22.964 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:51:23.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:51:23.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:51:48.804 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:51:49.114 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:51:49.115 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:51:50.192 [MessageBroker-14] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 3, completed tasks = 30]
2025-08-15 01:51:52.964 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:51:53.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:51:53.366 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:52:18.805 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:52:19.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:52:19.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:52:22.965 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:52:23.366 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:52:23.366 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:52:48.803 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:52:49.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:52:49.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:52:52.963 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:52:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:52:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:53:18.800 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:53:19.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:53:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:53:22.964 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:53:23.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:53:23.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:53:48.803 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:53:49.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:53:49.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:53:52.958 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:53:53.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:53:53.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:54:18.796 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:54:19.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:54:19.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:54:22.965 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:54:23.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:54:23.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:54:48.803 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:54:49.112 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:54:49.112 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:54:52.967 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:54:53.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:54:53.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:55:18.800 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:55:19.112 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:55:19.112 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:55:22.964 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:55:23.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:55:23.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:55:48.795 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:55:49.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:55:49.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:55:49.141 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:55:50.347 [cache-28] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 01:55:50.347 [cache-27] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 01:55:52.964 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:55:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:55:53.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:55:53.399 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 01:56:18.801 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:56:19.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:56:19.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:56:22.957 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:56:23.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:56:23.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:56:48.802 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:56:49.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:56:49.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:56:52.959 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:56:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:56:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:57:18.799 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:57:19.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:57:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:57:22.955 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:57:23.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:57:23.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:57:48.795 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:57:49.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:57:49.111 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:57:52.961 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:57:53.363 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:57:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:58:18.797 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:58:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:58:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:58:22.964 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:58:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:58:23.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:58:48.803 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:58:49.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:58:49.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:58:52.964 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:58:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:58:53.365 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:59:18.797 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:59:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:59:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:59:22.957 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:59:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:59:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:59:48.801 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:59:49.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:59:49.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 01:59:52.957 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 01:59:53.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 01:59:53.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:00:18.795 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:00:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:00:19.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:00:22.963 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:00:23.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:00:23.363 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:00:48.802 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:00:49.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:00:49.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:00:49.137 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:00:50.324 [cache-29] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:00:50.348 [cache-30] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:00:52.959 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:00:53.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:00:53.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:00:53.398 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:01:18.798 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:01:19.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:01:19.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:01:22.962 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:01:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:01:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:01:48.801 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:01:49.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:01:49.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:01:52.962 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:01:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:01:53.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:02:18.799 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:02:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:02:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:02:22.958 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:02:23.363 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:02:23.364 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:02:48.801 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:02:49.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:02:49.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:02:52.954 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:02:53.355 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:02:53.355 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:03:18.800 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:03:19.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:03:19.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:03:22.961 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:03:23.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:03:23.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:03:48.801 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:03:49.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:03:49.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:03:52.962 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:03:53.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:03:53.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:04:18.795 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:04:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:04:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:04:22.960 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:04:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:04:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:04:48.801 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:04:49.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:04:49.110 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:04:52.953 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:04:53.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:04:53.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:05:18.792 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:05:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:05:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:05:22.962 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:05:23.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:05:23.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:05:48.794 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:05:49.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:05:49.109 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:05:49.142 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:05:50.333 [cache-31] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:05:50.353 [cache-32] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:05:52.960 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:05:53.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:05:53.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:05:53.398 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:06:18.801 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:06:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:06:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:06:22.953 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:06:23.353 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:06:23.353 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:06:48.797 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:06:49.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:06:49.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:06:52.961 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:06:53.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:06:53.362 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:07:18.794 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:07:19.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:07:19.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:07:22.960 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:07:23.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:07:23.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:07:48.800 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:07:49.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:07:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:07:52.956 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:07:53.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:07:53.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:08:18.794 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:08:19.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:08:19.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:08:22.960 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:08:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:08:23.361 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:08:48.799 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:08:49.100 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:08:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:08:52.954 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:08:53.357 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:08:53.357 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:09:18.795 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:09:19.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:09:19.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:09:22.961 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:09:23.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:09:23.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:09:48.798 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:09:49.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:09:49.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:09:52.961 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:09:53.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:09:53.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:10:18.800 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:10:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:10:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:10:22.959 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:10:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:10:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:10:48.793 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:10:49.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:10:49.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:10:49.137 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:10:50.342 [cache-33] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:10:50.354 [cache-34] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:10:52.960 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:10:53.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:10:53.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:10:53.396 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:11:18.796 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:11:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:11:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:11:22.951 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:11:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:11:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:11:48.796 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:11:49.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:11:49.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:11:52.959 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:11:53.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:11:53.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:12:18.793 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:12:19.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:12:19.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:12:22.951 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:12:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:12:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:12:48.795 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:12:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:12:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:12:52.959 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:12:53.351 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:12:53.352 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:13:18.795 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:13:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:13:19.103 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:13:22.952 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:13:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:13:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:13:48.798 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:13:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:13:49.101 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:13:52.950 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:13:53.353 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:13:53.354 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:14:18.799 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:14:19.103 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:14:19.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:14:22.960 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:14:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:14:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:14:48.797 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:14:49.103 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:14:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:14:52.960 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:14:53.352 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:14:53.352 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:15:18.798 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:15:19.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:15:19.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:15:22.950 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:15:23.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:15:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:15:48.794 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:15:49.103 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:15:49.103 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:15:49.135 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:15:50.350 [cache-35] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:15:50.356 [cache-36] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:15:52.957 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:15:53.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:15:53.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:15:53.395 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:16:18.796 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:16:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:16:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:16:22.958 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:16:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:16:23.360 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:16:48.791 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:16:49.104 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:16:49.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:16:52.952 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:16:53.355 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:16:53.355 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:17:18.794 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:17:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:17:19.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:17:22.956 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:17:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:17:23.359 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:17:48.792 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:17:49.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:17:49.105 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:17:52.959 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:17:53.351 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:17:53.352 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:18:18.798 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:18:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:18:19.102 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:18:22.955 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:18:23.354 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:18:23.354 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:18:48.789 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:18:49.106 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:18:49.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:18:52.953 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:18:53.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:18:53.358 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:19:18.789 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:19:19.107 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:19:19.108 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:19:22.958 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:19:23.351 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:19:23.351 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:19:48.782 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:19:49.092 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:19:49.092 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:19:52.945 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:19:53.345 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:19:53.345 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:20:18.781 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:20:19.087 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:20:19.087 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:20:22.941 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:20:23.339 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:20:23.340 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:20:48.774 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:20:49.087 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:20:49.088 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:20:49.121 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:20:50.335 [cache-37] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:20:50.340 [cache-38] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:20:52.939 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:20:53.337 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:20:53.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:20:53.374 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:21:18.777 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:21:19.085 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:21:19.086 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:21:22.933 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:21:23.335 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:21:23.335 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:21:48.778 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:21:49.082 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:21:49.083 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:21:50.171 [MessageBroker-14] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 3, completed tasks = 43]
2025-08-15 02:21:52.932 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:21:53.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:21:53.339 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:22:18.775 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:22:19.082 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:22:19.082 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:22:22.932 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:22:23.337 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:22:23.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:22:48.770 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:22:49.082 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:22:49.082 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:22:52.937 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:22:53.331 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:22:53.331 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:23:18.773 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:23:19.085 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:23:19.085 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:23:22.937 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:23:23.333 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:23:23.333 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:23:48.777 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:23:49.084 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:23:49.084 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:23:52.939 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:23:53.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:23:53.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:24:18.777 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:24:19.082 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:24:19.082 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:24:22.937 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:24:23.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:24:23.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:24:48.768 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:24:49.081 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:24:49.081 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:24:52.933 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:24:53.337 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:24:53.338 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:25:13.509 [http-nio-8080-exec-4] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<com.acme.im.business.module.user.dto.UserDTO>> com.acme.im.business.module.user.controller.UserController.registerUser(com.acme.im.business.module.user.dto.UserRegisterRequest): [Field error in object 'userRegisterRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userRegisterRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 02:25:18.770 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:25:19.078 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:25:19.078 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:25:22.931 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:25:23.331 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:25:23.331 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:25:48.769 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:25:49.080 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:25:49.080 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:25:49.113 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:25:50.343 [cache-40] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:25:50.343 [cache-39] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:25:52.929 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:25:53.333 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:25:53.333 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:25:53.368 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:26:18.771 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:26:19.079 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:26:19.080 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:26:22.932 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:26:23.328 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:26:23.328 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:26:48.769 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:26:49.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:26:49.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:26:52.931 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:26:53.330 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:26:53.330 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:27:18.771 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:27:19.079 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:27:19.079 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:27:22.932 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:27:23.332 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:27:23.332 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:27:48.770 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:27:49.075 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:27:49.075 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:27:52.932 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:27:53.327 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:27:53.328 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:28:18.771 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:28:19.078 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:28:19.079 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:28:22.932 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:28:23.330 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:28:23.330 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:28:48.770 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:28:49.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:28:49.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:28:52.930 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:28:53.331 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:28:53.331 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:29:18.770 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:29:19.078 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:29:19.078 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:29:22.930 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:29:23.326 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:29:23.327 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:29:25.334 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:29:25.668 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:29:25.668 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:29:25.668 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:29:25.668 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:29:25.669 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:29:25.669 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:29:25.669 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:29:25.671 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:29:25.671 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:29:25.671 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:29:25.672 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 02:29:28.353 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 14771 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:29:28.353 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:29:28.353 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 02:29:28.656 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:29:28.656 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:29:28.662 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:29:28.827 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:29:28.827 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:29:28.832 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 02:29:28.841 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 14773 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:29:28.841 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:29:28.842 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 02:29:29.128 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:29:29.128 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:29:29.134 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:29:29.248 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 02:29:29.252 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:29:29.252 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:29:29.273 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:29:29.273 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 902 ms
2025-08-15 02:29:29.278 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:29:29.278 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:29:29.283 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 02:29:29.388 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:29:29.395 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 02:29:29.413 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:29:29.442 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:29:29.457 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:29:29.458 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:29:29.461 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 02:29:29.462 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 02:29:29.462 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 02:29:29.462 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 02:29:29.522 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:29:29.524 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:29:29.692 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 02:29:29.696 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:29:29.696 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:29:29.718 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:29:29.718 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 855 ms
2025-08-15 02:29:29.782 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:29:29.823 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:29:29.829 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 02:29:29.847 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:29:29.853 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:29:29.856 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:29:29.874 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:29:29.874 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:29:29.874 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:29:29.874 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:29:29.875 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:29:29.875 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:29:29.876 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:29:29.884 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 02:29:29.884 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 02:29:29.885 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:29:29.887 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:29:29.889 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:29:29.890 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:29:29.893 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 02:29:29.893 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 02:29:29.893 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 02:29:29.893 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 02:29:29.898 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:29:29.898 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:29:29.899 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:29:29.900 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:29:29.900 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:29:29.900 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:29:29.912 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:29:29.913 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:29:29.914 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:29:29.914 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@34525143[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:29.916 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:29:29.916 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:29:29.926 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:29:29.926 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6aed4a23[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:29.927 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:29:29.927 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5cf6ba1c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:29.928 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:29:29.928 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2fcad739[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:29.929 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:29:29.930 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@79a92277[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:29.931 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:29:29.931 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@e98adb2[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:29.937 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:29:29.937 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:29:29.944 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:29:29.956 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:29:29.958 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:29:30.047 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:29:30.056 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:29:30.056 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:29:30.064 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:29:30.064 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:29:30.064 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:29:30.133 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:29:30.191 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:29:30.217 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:29:30.284 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:29:30.288 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:29:30.306 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:29:30.307 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:29:30.307 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:29:30.308 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:29:30.308 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:29:30.309 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:29:30.317 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 02:29:30.317 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 02:29:30.317 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:29:30.320 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:29:30.330 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:29:30.331 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:29:30.331 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:29:30.332 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:29:30.332 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:29:30.332 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:29:30.344 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:29:30.345 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:29:30.346 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:29:30.346 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1529d534[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:30.348 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:29:30.348 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:29:30.357 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:29:30.357 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5f7c1de0[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:30.359 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:29:30.359 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2fcad739[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:30.360 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:29:30.360 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@79a92277[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:30.361 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:29:30.361 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@e98adb2[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:30.362 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:29:30.362 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1cb73a92[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:30.368 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:29:30.368 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:29:30.375 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:29:30.479 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:29:30.488 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:29:30.488 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:29:30.497 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:29:30.497 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:29:30.497 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:29:30.564 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:29:30.580 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:29:30.619 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:29:30.621 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@18ee9a8f, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@61aaec51, org.springframework.security.web.context.SecurityContextHolderFilter@50fbb66a, org.springframework.security.web.header.HeaderWriterFilter@5ca67657, com.acme.im.common.security.jwt.JwtAuthenticationFilter@6a0c7af6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4c1dc246, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@489ec791, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@69dc0dd1, org.springframework.security.web.session.SessionManagementFilter@3c41b4b, org.springframework.security.web.access.ExceptionTranslationFilter@38e1442a, org.springframework.security.web.access.intercept.AuthorizationFilter@58179860]
2025-08-15 02:29:30.777 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 02:29:30.777 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4d05b931]]
2025-08-15 02:29:30.777 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 02:29:30.893 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:29:30.927 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 02:29:30.928 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 02:29:30.930 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:29:30.930 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:29:30.931 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:29:30.932 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:29:30.932 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:29:30.949 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:30.949 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:30.951 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:30.951 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:30.962 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 02:29:30.969 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.771 seconds (process running for 2.937)
2025-08-15 02:29:30.972 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:29:30.973 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:29:30.973 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:29:30.973 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 02:29:30.973 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:29:30.974 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:29:30.974 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 02:29:30.974 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 02:29:30.975 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:29:31.003 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:29:31.042 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@69dc0dd1, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@9d10078, org.springframework.security.web.context.SecurityContextHolderFilter@466fb9be, org.springframework.security.web.header.HeaderWriterFilter@3ed79f41, com.acme.im.common.security.jwt.JwtAuthenticationFilter@5d5ae6aa, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2a0c76d6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@24a38ef3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6587c92f, org.springframework.security.web.session.SessionManagementFilter@5066a895, org.springframework.security.web.access.ExceptionTranslationFilter@d3effcb, org.springframework.security.web.access.intercept.AuthorizationFilter@582ea857]
2025-08-15 02:29:31.153 [RMI TCP Connection(2)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:29:31.153 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:29:31.154 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 02:29:31.359 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 02:29:31.361 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:29:31.361 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:29:31.362 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:29:31.363 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:29:31.363 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:29:31.378 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:31.378 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:31.379 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:31.380 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:29:31.409 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:29:31.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:29:31.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:29:31.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:29:31.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:29:31.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:29:31.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:29:31.412 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:29:31.412 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:29:31.412 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:29:31.413 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 02:29:31.496 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-15 02:29:31.504 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:29:32.351 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:29:32.352 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:29:32.352 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:29:32.352 [main] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:29:32.352 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:29:32.352 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:29:32.352 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:29:32.354 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:29:32.355 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:29:32.355 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:29:32.355 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 02:29:32.364 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 02:29:32.370 [main] ERROR o.s.b.diagnostics.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-15 02:29:32.730 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 14792 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:29:32.730 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:29:32.731 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 02:29:33.026 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:29:33.026 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:29:33.033 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:29:33.181 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:29:33.181 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:29:33.182 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:29:33.217 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 02:29:33.560 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 02:29:33.564 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:29:33.564 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:29:33.583 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:29:33.583 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 831 ms
2025-08-15 02:29:33.678 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:29:33.694 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 02:29:33.694 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:29:33.695 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 02:29:33.713 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:29:33.750 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:29:33.765 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:29:33.765 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:29:33.778 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:29:33.780 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:29:33.904 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:29:34.057 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:29:34.061 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:29:34.073 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:29:34.073 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:29:34.073 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:29:34.074 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:29:34.074 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:29:34.075 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:29:34.075 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 02:29:34.081 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 02:29:34.081 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 02:29:34.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:29:34.087 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:29:34.092 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:29:34.092 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:29:34.092 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:29:34.093 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:29:34.093 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:29:34.093 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:29:34.106 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:29:34.106 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:29:34.108 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:29:34.108 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@7b44e98e[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:34.109 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:29:34.109 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:29:34.204 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:29:34.204 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@cbaabfb[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:34.206 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:29:34.206 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@78723798[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:34.207 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:29:34.207 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@35d62807[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:34.208 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:29:34.208 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6e70861[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:34.209 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:29:34.209 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5b5d6f9c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:29:34.212 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:29:34.212 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:29:34.219 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:29:34.316 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:29:34.330 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:29:34.330 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:29:34.341 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:29:34.341 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:29:34.341 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:29:34.407 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:29:34.457 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:29:34.553 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 02:29:34.795 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:29:34.831 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@435b944c, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@635900ef, org.springframework.security.web.context.SecurityContextHolderFilter@7fda0e30, org.springframework.security.web.header.HeaderWriterFilter@429ad94a, com.acme.im.common.security.jwt.JwtAuthenticationFilter@3856d0cb, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5813046e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1f3c3291, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@615d74e9, org.springframework.security.web.session.SessionManagementFilter@56b4951a, org.springframework.security.web.access.ExceptionTranslationFilter@3057728e, org.springframework.security.web.access.intercept.AuthorizationFilter@64903a20]
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 02:29:35.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 02:29:35.127 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:29:35.128 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:29:35.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:29:35.130 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:29:35.130 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:29:35.146 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:29:35.146 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:29:35.148 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:29:35.148 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:29:35.156 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 02:29:35.156 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 02:29:35.156 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12026d62]]
2025-08-15 02:29:35.156 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 02:29:35.164 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.586 seconds (process running for 2.754)
2025-08-15 02:29:35.167 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:29:35.167 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 02:29:35.167 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 02:29:35.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 02:29:35.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 02:29:35.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 02:29:35.169 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 02:29:35.169 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 02:29:35.169 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:29:35.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:29:35.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:29:35.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:29:35.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:29:35.170 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:29:35.170 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:29:35.170 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:29:35.616 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:29:35.616 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:29:35.617 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 02:29:35.980 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:29:35.980 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:29:35.980 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:29:35.980 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:29:35.986 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:29:35.986 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:29:40.172 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:29:40.173 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:29:40.173 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:29:40.173 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:29:40.183 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:29:40.183 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:29:59.026 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 测试Token验证: token=test_token_123
2025-08-15 02:29:59.029 [http-nio-8081-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=security.token.validate, queueSize=1
2025-08-15 02:29:59.458 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:29:59.769 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:29:59.771 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 02:29:59.789 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=security.token.validate, useJetStream=false
2025-08-15 02:29:59.789 [http-nio-8081-exec-2] DEBUG c.a.i.communication.service.TokenValidationService - 发送Token验证请求: requestId=token_val_1755199799027_107
2025-08-15 02:29:59.877 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:29:59.878 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:30:03.768 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:30:04.075 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:30:04.075 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:30:09.799 [http-nio-8081-exec-2] WARN  c.a.i.communication.service.TokenValidationService - Token验证超时: requestId=token_val_1755199799027_107
2025-08-15 02:30:29.458 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:30:29.878 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:30:29.878 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:30:33.766 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:30:34.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:30:34.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:30:35.152 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 02:30:59.460 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:30:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:30:59.876 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:31:03.769 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:31:04.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:31:04.078 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:31:29.461 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:31:29.878 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:31:29.879 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:31:33.768 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:31:34.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:31:34.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:31:59.458 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:31:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:31:59.876 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:32:03.769 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:32:04.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:32:04.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:32:29.457 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:32:29.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:32:29.876 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:32:33.768 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:32:34.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:32:34.078 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:32:59.460 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:32:59.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:32:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:33:03.766 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:33:04.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:33:04.077 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:33:29.460 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:33:29.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:33:29.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:33:31.158 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - 测试Token验证: token=test_token_123
2025-08-15 02:33:31.158 [http-nio-8081-exec-4] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=security.token.validate, queueSize=1
2025-08-15 02:33:31.766 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:33:31.766 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=2, total=10
2025-08-15 02:33:31.767 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=security.token.validate, useJetStream=false
2025-08-15 02:33:31.767 [http-nio-8081-exec-4] DEBUG c.a.i.communication.service.TokenValidationService - 发送Token验证请求: requestId=token_val_1755200011158_109
2025-08-15 02:33:33.767 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:33:34.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:33:34.076 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:33:41.772 [http-nio-8081-exec-4] WARN  c.a.i.communication.service.TokenValidationService - Token验证超时: requestId=token_val_1755200011158_109
2025-08-15 02:33:59.461 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:33:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:33:59.876 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:34:03.763 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:34:04.074 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:34:04.074 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:34:29.459 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:34:29.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:34:29.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:34:29.914 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:34:33.768 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:34:34.073 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:34:34.073 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:34:34.109 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:34:35.167 [cache-3] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:34:35.167 [cache-4] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:34:59.459 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:34:59.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:34:59.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:35:03.767 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:35:04.074 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:35:04.074 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:35:29.456 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:35:29.873 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:35:29.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:35:29.915 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 02:35:33.168 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 02:35:33.168 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12026d62]]
2025-08-15 02:35:33.168 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 02:35:33.289 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:35:33.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:35:33.412 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:35:33.412 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:35:33.413 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:35:33.413 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:35:33.413 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:35:33.414 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:35:33.420 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:35:33.421 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:35:33.421 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:35:33.423 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=2
2025-08-15 02:35:34.848 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 19240 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:35:34.848 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:35:34.849 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 02:35:35.119 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:35:35.119 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:35:35.126 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 02:35:35.264 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:35:35.264 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:35:35.265 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:35:35.301 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 02:35:35.637 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 02:35:35.641 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:35:35.641 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:35:35.660 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:35:35.660 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 794 ms
2025-08-15 02:35:35.750 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:35:35.765 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:35:35.766 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:35:35.767 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 02:35:35.783 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:35:35.817 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:35:35.832 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:35:35.833 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:35:35.844 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:35:35.845 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:35:35.965 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:35:36.108 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:35:36.112 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:35:36.124 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:35:36.124 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:35:36.125 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:35:36.125 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:35:36.126 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:35:36.127 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:35:36.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 02:35:36.134 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 02:35:36.134 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 02:35:36.134 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:35:36.140 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:35:36.145 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:35:36.145 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:35:36.145 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:35:36.146 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:35:36.146 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:35:36.146 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:35:36.160 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:35:36.161 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:35:36.162 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:35:36.162 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@7b44e98e[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:35:36.163 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:35:36.163 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:35:36.255 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:35:36.255 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@cbaabfb[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:35:36.256 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:35:36.257 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@78723798[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:35:36.258 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:35:36.258 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@35d62807[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:35:36.259 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:35:36.259 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6e70861[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:35:36.260 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:35:36.260 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5b5d6f9c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:35:36.263 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:35:36.263 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:35:36.269 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:35:36.361 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:35:36.374 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:35:36.374 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:35:36.384 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:35:36.385 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:35:36.385 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:35:36.449 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:35:36.497 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:35:36.591 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 02:35:36.828 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:35:36.863 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11b26693, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7f4f432b, org.springframework.security.web.context.SecurityContextHolderFilter@453ff774, org.springframework.security.web.header.HeaderWriterFilter@3594b4b4, com.acme.im.common.security.jwt.JwtAuthenticationFilter@3856d0cb, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@17f43f4a, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4cdd0f2f, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@435b944c, org.springframework.security.web.session.SessionManagementFilter@2d170dac, org.springframework.security.web.access.ExceptionTranslationFilter@4b45016d, org.springframework.security.web.access.intercept.AuthorizationFilter@57d71569]
2025-08-15 02:35:37.148 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 02:35:37.149 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 02:35:37.151 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 02:35:37.151 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:35:37.151 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:35:37.151 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:35:37.151 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:35:37.151 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:35:37.151 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:35:37.152 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:35:37.153 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:35:37.153 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:35:37.170 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:35:37.170 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:35:37.171 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:35:37.171 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:35:37.179 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 02:35:37.179 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 02:35:37.179 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@16066bf4]]
2025-08-15 02:35:37.179 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 02:35:37.186 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.486 seconds (process running for 2.654)
2025-08-15 02:35:37.189 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:35:37.189 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 02:35:37.190 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 02:35:37.190 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 02:35:37.190 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 02:35:37.190 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 02:35:37.191 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 02:35:37.191 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 02:35:37.191 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:35:37.192 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:35:37.192 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:35:37.192 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:35:37.192 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:35:37.192 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:35:37.192 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:35:37.192 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:35:37.732 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:35:37.732 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:35:37.733 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 02:35:42.193 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:35:42.195 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:35:42.195 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:35:42.195 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:35:42.208 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:35:42.209 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:35:59.459 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:35:59.873 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:35:59.873 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:36:05.834 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:36:06.129 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:36:06.131 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:36:06.421 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 直接发布NATS事件: subject=security.token.validate
2025-08-15 02:36:06.423 [http-nio-8081-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=security.token.validate, queueSize=1
2025-08-15 02:36:06.835 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:36:06.836 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 02:36:06.841 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=security.token.validate, useJetStream=false
2025-08-15 02:36:06.841 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - NATS事件发布成功: subject=security.token.validate, requestId=test_direct_1755200166422
2025-08-15 02:36:18.579 [http-nio-8081-exec-3] INFO  c.acme.im.communication.controller.TestController - 直接发布NATS事件: subject=security.token.validate
2025-08-15 02:36:18.580 [http-nio-8081-exec-3] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=security.token.validate, queueSize=1
2025-08-15 02:36:18.837 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:36:18.837 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=2, total=10
2025-08-15 02:36:18.837 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=security.token.validate, useJetStream=false
2025-08-15 02:36:18.837 [http-nio-8081-exec-3] INFO  c.acme.im.communication.controller.TestController - NATS事件发布成功: subject=security.token.validate, requestId=test_direct_1755200178580
2025-08-15 02:36:29.459 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:36:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:36:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:36:35.833 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:36:36.128 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:36:36.128 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:36:37.171 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 02:36:59.458 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:36:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:36:59.876 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:37:05.836 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:37:06.125 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:37:06.126 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:37:29.455 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:37:29.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:37:29.876 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:37:35.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:37:36.125 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:37:36.126 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:37:59.457 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:37:59.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:37:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:38:05.834 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:38:06.129 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:38:06.145 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:38:29.457 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:38:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:38:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:38:35.836 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:38:36.128 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:38:36.129 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:38:59.457 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:38:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:38:59.875 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:39:05.831 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:39:06.127 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:39:06.128 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:39:29.457 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:39:29.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:39:29.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:39:29.910 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:39:35.833 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:39:36.124 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:39:36.125 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:39:59.458 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:39:59.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:39:59.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:40:05.835 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:40:06.128 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:40:06.128 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:40:29.456 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:40:29.869 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:40:29.869 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:40:35.832 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:40:36.126 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:40:36.126 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:40:36.159 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:40:37.189 [cache-4] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:40:37.189 [cache-3] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:40:59.454 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:40:59.873 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:40:59.874 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:41:05.831 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:41:06.127 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:41:06.127 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:41:29.457 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:41:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:41:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:41:35.833 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:41:36.127 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:41:36.128 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:41:36.163 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 02:41:59.455 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:41:59.872 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:41:59.873 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:42:05.834 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:42:06.126 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:42:06.127 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:42:29.455 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:42:29.873 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:42:29.873 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:42:35.833 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:42:36.125 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:42:36.126 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:42:59.456 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:42:59.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:42:59.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:43:05.830 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=2, success=2, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:43:06.126 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:43:06.127 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:43:29.456 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:43:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:43:29.871 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:43:33.349 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 02:43:33.350 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@16066bf4]]
2025-08-15 02:43:33.350 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 02:43:33.468 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:43:33.892 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:43:33.893 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:43:33.893 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:43:33.893 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:43:33.893 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:43:33.893 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:43:33.893 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:43:33.895 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:43:33.895 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:43:33.895 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:43:33.895 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=2
2025-08-15 02:43:36.806 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 22649 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:43:36.806 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:43:36.806 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 02:43:37.061 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:43:37.062 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:43:37.068 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:43:37.200 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:43:37.200 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:43:37.202 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:43:37.236 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 02:43:37.569 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 02:43:37.573 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:43:37.573 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:43:37.594 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:43:37.594 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 770 ms
2025-08-15 02:43:37.686 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:43:37.702 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 02:43:37.702 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:43:37.703 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 02:43:37.717 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:43:37.752 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:43:37.768 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:43:37.768 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:43:37.781 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:43:37.783 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:43:37.910 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:43:38.064 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:43:38.068 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:43:38.080 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:43:38.081 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:43:38.081 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:43:38.081 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:43:38.081 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:43:38.082 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:43:38.083 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 02:43:38.090 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 02:43:38.090 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 02:43:38.090 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:43:38.095 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:43:38.100 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:43:38.100 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:43:38.100 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:43:38.101 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:43:38.102 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:43:38.102 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:43:38.114 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:43:38.115 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:43:38.116 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:43:38.116 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@39921410[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:38.117 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:43:38.117 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:43:38.209 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:43:38.209 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1d5fc340[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:38.211 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:43:38.211 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@55b78dad[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:38.212 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:43:38.212 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@689fcf08[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:38.213 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:43:38.213 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1a3272e0[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:38.214 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:43:38.214 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6db2a260[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:38.217 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:43:38.217 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:43:38.223 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:43:38.320 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:43:38.329 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:43:38.329 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:43:38.338 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:43:38.338 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:43:38.338 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:43:38.408 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:43:38.457 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:43:38.550 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 02:43:38.794 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:43:38.829 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5269aa68, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7dcd8e74, org.springframework.security.web.context.SecurityContextHolderFilter@4467c026, org.springframework.security.web.header.HeaderWriterFilter@758e8b8d, com.acme.im.common.security.jwt.JwtAuthenticationFilter@d190639, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@59f0ef6e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4e791e53, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6a7c0932, org.springframework.security.web.session.SessionManagementFilter@40cb19d5, org.springframework.security.web.access.ExceptionTranslationFilter@661ec798, org.springframework.security.web.access.intercept.AuthorizationFilter@509d0d21]
2025-08-15 02:43:39.122 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 02:43:39.123 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 02:43:39.125 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:43:39.125 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:43:39.126 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:43:39.127 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:43:39.127 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:43:39.143 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:43:39.143 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:43:39.144 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:43:39.144 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:43:39.156 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 02:43:39.157 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 02:43:39.157 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3c8eaee3]]
2025-08-15 02:43:39.157 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 02:43:39.165 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.51 seconds (process running for 2.67)
2025-08-15 02:43:39.168 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:43:39.168 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:43:39.168 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 02:43:39.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:43:39.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:43:39.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:43:39.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:43:39.169 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:43:39.169 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:43:39.169 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 02:43:39.169 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 02:43:39.170 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 02:43:39.170 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 02:43:39.171 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:43:39.608 [RMI TCP Connection(2)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:43:39.609 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:43:39.609 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 02:43:41.547 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:43:41.932 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:43:41.933 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:43:41.933 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:43:41.933 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:43:41.933 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:43:41.933 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:43:41.933 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:43:41.937 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:43:41.937 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:43:41.937 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:43:41.938 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 02:43:42.883 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 22669 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:43:42.884 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:43:42.884 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 02:43:43.180 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:43:43.181 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:43:43.188 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 02:43:43.335 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:43:43.335 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:43:43.343 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-08-15 02:43:43.713 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 02:43:43.717 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:43:43.717 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:43:43.736 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:43:43.736 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 835 ms
2025-08-15 02:43:43.830 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:43:43.836 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 02:43:43.852 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:43:43.884 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:43:43.898 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:43:43.899 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:43:43.902 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 02:43:43.902 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 02:43:43.902 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 02:43:43.902 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 02:43:43.960 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:43:43.962 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:43:44.176 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:43:44.176 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:43:44.176 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:43:44.176 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:43:44.181 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:43:44.181 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:43:44.209 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:43:44.276 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:43:44.280 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:43:44.298 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:43:44.298 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:43:44.298 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:43:44.298 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:43:44.299 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:43:44.300 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:43:44.308 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 02:43:44.308 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 02:43:44.308 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:43:44.311 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:43:44.322 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:43:44.322 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:43:44.322 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:43:44.323 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:43:44.323 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:43:44.323 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:43:44.335 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:43:44.335 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:43:44.336 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:43:44.337 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1529d534[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:44.338 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:43:44.338 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:43:44.346 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:43:44.347 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5f7c1de0[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:44.348 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:43:44.348 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2fcad739[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:44.349 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:43:44.349 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@79a92277[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:44.350 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:43:44.350 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@e98adb2[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:44.351 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:43:44.351 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1cb73a92[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:43:44.357 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:43:44.357 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:43:44.363 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:43:44.455 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:43:44.464 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:43:44.465 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:43:44.473 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:43:44.473 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:43:44.473 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:43:44.537 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:43:44.587 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:43:44.938 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:43:44.975 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@4d87553b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@31efe094, org.springframework.security.web.context.SecurityContextHolderFilter@106a6420, org.springframework.security.web.header.HeaderWriterFilter@4fdb338e, com.acme.im.common.security.jwt.JwtAuthenticationFilter@5d5ae6aa, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@42f15e87, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6717f504, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@d69fd7a, org.springframework.security.web.session.SessionManagementFilter@6999dca2, org.springframework.security.web.access.ExceptionTranslationFilter@26db7540, org.springframework.security.web.access.intercept.AuthorizationFilter@6a7a8e1e]
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 02:43:45.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 02:43:45.262 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 02:43:45.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:43:45.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:43:45.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:43:45.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:43:45.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:43:45.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:43:45.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:43:45.264 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:43:45.264 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:43:45.279 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:43:45.279 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:43:45.280 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:43:45.280 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:43:45.288 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 02:43:45.295 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.567 seconds (process running for 2.732)
2025-08-15 02:43:45.298 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 02:43:45.298 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 02:43:45.298 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 02:43:45.298 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 02:43:45.298 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 02:43:45.298 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:43:45.298 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:43:45.299 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 02:43:45.299 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 02:43:45.299 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:43:45.299 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:43:45.299 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:43:45.299 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:43:45.299 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:43:45.299 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:43:45.299 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:43:45.300 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:43:45.698 [RMI TCP Connection(2)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:43:45.698 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:43:45.699 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 02:43:50.301 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:43:50.302 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:43:50.302 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:43:50.303 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:43:50.316 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:43:50.316 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:44:07.772 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:44:08.083 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:44:08.084 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:44:13.901 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:44:14.303 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:44:14.304 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:44:25.831 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:44:25.833 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:44:31.946 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 👤 开始测试用户注册接口
2025-08-15 02:44:31.947 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 📤 发送用户注册请求: URL=http://localhost:8080/api/users/register, username=test_user_1755200671947
2025-08-15 02:44:31.947 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 📝 模拟用户注册请求: {"username":"test_user_1755200671947","password":"test123456","email":"test_user_1755200671947@test.com"}
2025-08-15 02:44:31.947 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - ✅ 用户注册测试完成: username=test_user_1755200671947
2025-08-15 02:44:36.969 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - 🔐 开始测试用户登录接口
2025-08-15 02:44:36.970 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - 📤 发送用户登录请求: URL=http://localhost:8080/api/users/login, username=bbbb
2025-08-15 02:44:36.970 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - 📝 模拟用户登录请求: {"username":"bbbb","password":"123456"}
2025-08-15 02:44:36.970 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - ✅ 用户登录测试完成: username=bbbb
2025-08-15 02:44:37.770 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:44:38.084 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:44:38.085 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:44:39.149 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 02:44:41.852 [http-nio-8081-exec-6] INFO  c.acme.im.communication.controller.TestController - 🔌 开始测试WebSocket连接
2025-08-15 02:44:41.852 [http-nio-8081-exec-6] INFO  c.acme.im.communication.controller.TestController - 📡 WebSocket端点信息: wsUrl=ws://localhost:8081/ws, stompUrl=http://localhost:8081/ws
2025-08-15 02:44:41.852 [http-nio-8081-exec-6] INFO  c.acme.im.communication.controller.TestController - ✅ WebSocket连接测试完成
2025-08-15 02:44:43.901 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:44:44.302 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:44:44.303 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:44:47.042 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - 📡 开始测试NATS订阅
2025-08-15 02:44:47.042 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - 📡 测试订阅主题: test.subscribe.1755200687042
2025-08-15 02:44:47.043 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - 💡 提示: 请使用nats-cli工具监听此主题: nats sub 'test.subscribe.1755200687042'
2025-08-15 02:44:47.043 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - ✅ NATS订阅测试完成: subject=test.subscribe.1755200687042
2025-08-15 02:44:54.290 [http-nio-8081-exec-9] INFO  c.acme.im.communication.controller.TestController - 🚀 开始测试NATS事件发布: subject=security.token.validate, message=null
2025-08-15 02:44:54.292 [http-nio-8081-exec-9] INFO  c.acme.im.communication.controller.TestController - 📤 准备发布NATS事件: subject=security.token.validate, requestId=test_direct_1755200694290, event=BaseEvent(eventId=15521843-2e0e-4113-83c8-5d2753cf7b61, subject=security.token.validate, eventType=REQUEST, status=PENDING, priority=MEDIUM, sourceService=communication-service, sourceInstance=test-controller, targetService=null, targetInstance=null, userId=null, deviceId=null, sessionId=null, data=UserEvents.TokenValidationRequest(requestId=test_direct_1755200694290, token=test_token_1755200694291, deviceId=test_device_001, timestamp=1755200694291), metadata={requestId=test_direct_1755200694290, testType=manual-test, timestamp=1755200694292}, createdAt=2025-08-15T02:44:54.292714, expiresAt=null, retryCount=0, maxRetries=3, errorMessage=null, errorCode=null)
2025-08-15 02:44:54.300 [http-nio-8081-exec-9] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=security.token.validate, queueSize=1
2025-08-15 02:44:54.772 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:44:54.773 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 02:44:54.776 [http-nio-8081-exec-9] INFO  c.acme.im.communication.controller.TestController - 📤 事件发布请求已发送
2025-08-15 02:44:54.776 [http-nio-8081-exec-9] INFO  c.acme.im.communication.controller.TestController - ✅ NATS事件发布成功: subject=security.token.validate, requestId=test_direct_1755200694290
2025-08-15 02:44:54.776 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=security.token.validate, useJetStream=false
2025-08-15 02:44:55.912 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:44:55.912 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:44:55.915 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:44:55.915 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:45:01.738 [http-nio-8081-exec-3] INFO  c.acme.im.communication.controller.TestController - 📋 获取所有测试端点信息
2025-08-15 02:45:01.739 [http-nio-8081-exec-3] INFO  c.acme.im.communication.controller.TestController - ✅ 返回测试端点信息: {endpoints=/api/test/endpoints, testUserLogin=/api/test/test-user-login, testWebSocket=/api/test/test-websocket, serviceStatus=/api/test/status, testNatsSubscribe=/api/test/test-nats-subscribe, testUserRegister=/api/test/test-user-register, publishNatsEvent=/api/test/publish-nats-event?subject={subject}}
2025-08-15 02:45:04.288 [http-nio-8080-exec-3] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<com.acme.im.business.module.user.dto.UserDTO>> com.acme.im.business.module.user.controller.UserController.registerUser(com.acme.im.business.module.user.dto.UserRegisterRequest) with 2 errors: [Field error in object 'userRegisterRequest' on field 'username': rejected value [test_user_001]; codes [Pattern.userRegisterRequest.username,Pattern.username,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.username,username]; arguments []; default message [username],[Ljakarta.validation.constraints.Pattern$Flag;@35208692,^[a-zA-Z]+$]; default message [用户名只能包含字母]] [Field error in object 'userRegisterRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userRegisterRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 02:45:07.768 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:45:08.085 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:45:08.085 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:45:13.181 [http-nio-8080-exec-5] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<com.acme.im.business.module.user.dto.UserDTO>> com.acme.im.business.module.user.controller.UserController.registerUser(com.acme.im.business.module.user.dto.UserRegisterRequest) with 2 errors: [Field error in object 'userRegisterRequest' on field 'username': rejected value [test_usera]; codes [Pattern.userRegisterRequest.username,Pattern.username,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.username,username]; arguments []; default message [username],[Ljakarta.validation.constraints.Pattern$Flag;@35208692,^[a-zA-Z]+$]; default message [用户名只能包含字母]] [Field error in object 'userRegisterRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userRegisterRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 02:45:13.904 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:45:14.298 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:45:14.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:45:37.767 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=1, success=1, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:45:38.081 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:45:38.081 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:45:43.901 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:45:44.302 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:45:44.303 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:45:59.950 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 02:45:59.950 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3c8eaee3]]
2025-08-15 02:45:59.951 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 02:46:00.101 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:46:00.640 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:46:00.641 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:46:00.642 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:46:00.642 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:46:00.642 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:46:00.643 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:46:00.643 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:46:00.652 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:46:00.653 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:46:00.653 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:46:00.660 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=1
2025-08-15 02:46:13.902 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:46:14.301 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:46:14.303 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:46:43.899 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:46:44.301 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:46:44.301 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:47:13.902 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:47:14.301 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:47:14.301 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:47:35.104 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 26892 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:47:35.105 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:47:35.105 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 02:47:35.364 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:47:35.364 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:47:35.371 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 02:47:35.511 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:47:35.511 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:47:35.512 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:47:35.547 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 02:47:35.897 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 02:47:35.901 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:47:35.901 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:47:35.920 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:47:35.920 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 797 ms
2025-08-15 02:47:36.016 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:47:36.033 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:47:36.033 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:47:36.034 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:47:36.034 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 02:47:36.051 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:47:36.087 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:47:36.101 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:47:36.102 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:47:36.114 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:47:36.116 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:47:36.237 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:47:36.387 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:47:36.391 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:47:36.403 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:47:36.403 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:47:36.403 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:47:36.404 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:47:36.404 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:47:36.405 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:47:36.405 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 02:47:36.412 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 02:47:36.412 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 02:47:36.413 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:47:36.418 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:47:36.423 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:47:36.423 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:47:36.423 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:47:36.425 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:47:36.425 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:47:36.425 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:47:36.438 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:47:36.439 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:47:36.440 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:47:36.440 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@39921410[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:47:36.441 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:47:36.441 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:47:36.536 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:47:36.536 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1d01fa0c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:47:36.538 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:47:36.538 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6fc03cf6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:47:36.539 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:47:36.539 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5fcff272[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:47:36.540 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:47:36.540 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3514df8d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:47:36.541 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:47:36.541 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2bf2523f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:47:36.544 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:47:36.544 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:47:36.551 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:47:36.646 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:47:36.655 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:47:36.655 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:47:36.663 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:47:36.663 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:47:36.663 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:47:36.737 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:47:36.787 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:47:36.882 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 02:47:37.130 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:47:37.167 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@58453967, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6f34d178, org.springframework.security.web.context.SecurityContextHolderFilter@5c937c92, org.springframework.security.web.header.HeaderWriterFilter@7fda0e30, com.acme.im.common.security.jwt.JwtAuthenticationFilter@d190639, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4cde5d66, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1c9fa12, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@75c8ba94, org.springframework.security.web.session.SessionManagementFilter@5da61ee2, org.springframework.security.web.access.ExceptionTranslationFilter@2d170dac, org.springframework.security.web.access.intercept.AuthorizationFilter@3294b641]
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 02:47:37.457 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 02:47:37.459 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:47:37.460 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:47:37.461 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:47:37.462 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:47:37.462 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:47:37.462 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:47:37.462 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:47:37.462 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:47:37.462 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:47:37.462 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:47:37.478 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:47:37.479 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:47:37.480 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:47:37.480 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:47:37.488 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 02:47:37.489 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 02:47:37.489 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3cfd9459]]
2025-08-15 02:47:37.489 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 02:47:37.497 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.547 seconds (process running for 2.713)
2025-08-15 02:47:37.500 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:47:37.501 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:47:37.501 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 02:47:37.501 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:47:37.502 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:47:37.502 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 02:47:37.502 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 02:47:37.503 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 02:47:37.503 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 02:47:37.504 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:47:37.907 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:47:37.908 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:47:37.908 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 02:47:42.509 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:47:42.509 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:47:42.509 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:47:42.509 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:47:42.514 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:47:42.514 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:47:43.901 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:47:44.300 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:47:44.301 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:48:06.105 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:48:06.407 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:48:06.408 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:48:13.901 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:48:14.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:48:14.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:48:33.416 [http-nio-8080-exec-7] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<com.acme.im.business.module.user.dto.UserDTO>> com.acme.im.business.module.user.controller.UserController.registerUser(com.acme.im.business.module.user.dto.UserRegisterRequest): [Field error in object 'userRegisterRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userRegisterRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 02:48:36.106 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:48:36.408 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:48:36.409 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:48:37.483 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 02:48:43.901 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:48:44.297 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:48:44.297 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:48:44.334 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:49:06.106 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:49:06.408 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:49:06.408 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:49:10.218 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:49:10.218 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:49:10.227 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:49:10.228 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:49:13.900 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:49:14.301 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:49:14.302 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:49:20.724 [http-nio-8080-exec-10] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<com.acme.im.business.module.user.dto.UserDTO>> com.acme.im.business.module.user.controller.UserController.registerUser(com.acme.im.business.module.user.dto.UserRegisterRequest): [Field error in object 'userRegisterRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userRegisterRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 02:49:36.103 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:49:36.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:49:36.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:49:43.899 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:49:44.295 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:49:44.295 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:49:44.333 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 02:49:50.347 [http-nio-8080-exec-2] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<com.acme.im.business.module.user.dto.UserDTO>> com.acme.im.business.module.user.controller.UserController.registerUser(com.acme.im.business.module.user.dto.UserRegisterRequest): [Field error in object 'userRegisterRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userRegisterRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userRegisterRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 02:50:06.103 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:50:06.407 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:50:06.407 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:50:13.899 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:50:14.295 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:50:14.296 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:50:36.104 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:50:36.404 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:50:36.405 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:50:43.899 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:50:44.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:50:44.300 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:51:06.105 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:51:06.407 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:51:06.407 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:51:13.899 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:51:14.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:51:14.300 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:51:17.069 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:51:17.070 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:51:17.077 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:51:17.077 [http-nio-8081-exec-4] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:51:25.107 [http-nio-8080-exec-5] INFO  c.a.i.b.module.user.controller.UserController - 收到用户注册请求: username=cccc
2025-08-15 02:51:25.116 [http-nio-8080-exec-5] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户注册: username=cccc, deviceId=test_device_001
2025-08-15 02:51:25.137 [http-nio-8080-exec-5] DEBUG c.a.i.b.m.u.r.UserRepository.countByUsername - ==>  Preparing: SELECT COUNT(*) FROM users WHERE username = ?
2025-08-15 02:51:25.149 [http-nio-8080-exec-5] DEBUG c.a.i.b.m.u.r.UserRepository.countByUsername - ==> Parameters: cccc(String)
2025-08-15 02:51:25.157 [http-nio-8080-exec-5] DEBUG c.a.i.b.m.u.r.UserRepository.countByUsername - <==      Total: 1
2025-08-15 02:51:25.158 [http-nio-8080-exec-5] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 02:51:25.179 [http-nio-8080-exec-5] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行插入填充
2025-08-15 02:51:25.180 [http-nio-8080-exec-5] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 插入填充完成
2025-08-15 02:51:25.180 [http-nio-8080-exec-5] DEBUG c.a.i.b.m.user.repository.UserRepository.insert - ==>  Preparing: INSERT INTO users ( username, nickname, gender, status, online_status, last_active_at, password_hash, salt, two_factor_enabled, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-08-15 02:51:25.180 [http-nio-8080-exec-5] DEBUG c.a.i.b.m.user.repository.UserRepository.insert - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 0(Integer), 2025-08-15T02:51:25.158286(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25.158286(LocalDateTime), 2025-08-15T02:51:25.158286(LocalDateTime)
2025-08-15 02:51:25.183 [http-nio-8080-exec-5] DEBUG c.a.i.b.m.user.repository.UserRepository.insert - <==    Updates: 1
2025-08-15 02:51:25.184 [http-nio-8080-exec-5] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户注册成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:51:25.187 [http-nio-8080-exec-5] INFO  c.a.i.b.module.user.controller.UserController - 用户注册成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:51:36.100 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:51:36.406 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:51:36.406 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:51:37.409 [http-nio-8080-exec-7] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.acme.im.common.response.ApiResponse<java.lang.String>> com.acme.im.business.module.user.controller.UserController.loginUser(com.acme.im.business.module.user.dto.UserLoginRequest): [Field error in object 'userLoginRequest' on field 'deviceId': rejected value [null]; codes [NotBlank.userLoginRequest.deviceId,NotBlank.deviceId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [userLoginRequest.deviceId,deviceId]; arguments []; default message [deviceId]]; default message [设备号不能为空]] ]
2025-08-15 02:51:43.898 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:51:44.298 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:51:44.298 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:52:06.100 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:52:06.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:52:06.403 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:52:13.898 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:52:14.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:52:14.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:52:27.972 [http-nio-8081-exec-6] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:52:27.973 [http-nio-8081-exec-6] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:52:27.984 [http-nio-8081-exec-7] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 02:52:27.984 [http-nio-8081-exec-7] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 02:52:36.103 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:52:36.404 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:52:36.405 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:52:36.438 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:52:37.506 [cache-4] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 02:52:37.507 [cache-3] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:52:42.269 [http-nio-8080-exec-10] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 02:52:42.271 [http-nio-8080-exec-10] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 02:52:42.273 [http-nio-8080-exec-10] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 02:52:42.274 [http-nio-8080-exec-10] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 02:52:42.281 [http-nio-8080-exec-10] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 02:52:42.281 [http-nio-8080-exec-10] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 02:52:42.296 [http-nio-8080-exec-10] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 02:52:42.296 [http-nio-8080-exec-10] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 02:52:42.296 [http-nio-8080-exec-10] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 02:52:42.297 [http-nio-8080-exec-10] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T02:52:42.281413(LocalDateTime), 2025-08-15T02:52:42.281418(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 02:52:42.300 [http-nio-8080-exec-10] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 02:52:42.331 [http-nio-8080-exec-10] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 02:52:42.331 [http-nio-8080-exec-10] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:52:42.334 [http-nio-8080-exec-10] ERROR o.a.c.c.C.[.[localhost].[/].[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Handler dispatch failed: java.lang.NoSuchMethodError: 'void com.acme.im.business.module.user.event.UserLoginEvent.<init>(java.lang.String, com.acme.im.business.module.user.event.UserEventData)'] with root cause
java.lang.NoSuchMethodError: 'void com.acme.im.business.module.user.event.UserLoginEvent.<init>(java.lang.String, com.acme.im.business.module.user.event.UserEventData)'
	at com.acme.im.business.module.user.event.UserEventPublisher.publishUserLogin(UserEventPublisher.java:39)
	at com.acme.im.business.module.user.service.impl.UserServiceImpl.loginUser(UserServiceImpl.java:144)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.acme.im.business.module.user.service.impl.UserServiceImpl$$SpringCGLIB$$0.loginUser(<generated>)
	at com.acme.im.business.module.user.controller.UserController.loginUser(UserController.java:83)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.acme.im.common.security.jwt.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:50)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-08-15 02:52:43.897 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:52:44.298 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:52:44.299 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:53:06.104 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:53:06.406 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:53:06.406 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:53:13.898 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:53:14.298 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:53:14.298 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:53:36.103 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:53:36.404 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:53:36.405 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:53:36.439 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 02:53:43.897 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:53:44.297 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:53:44.297 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:53:44.331 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 02:54:06.103 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:54:06.405 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:54:06.405 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:54:13.897 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:54:14.297 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:54:14.297 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:54:36.103 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:54:36.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:54:36.401 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:54:40.170 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:54:40.633 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:54:40.634 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:54:40.634 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:54:40.634 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:54:40.634 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:54:40.634 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:54:40.634 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:54:40.637 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:54:40.637 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:54:40.637 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:54:40.638 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 02:54:43.668 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 28408 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:54:43.669 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:54:43.669 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 02:54:43.963 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:54:43.963 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:54:43.969 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:54:44.102 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:54:44.103 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:54:44.112 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-08-15 02:54:44.483 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 02:54:44.486 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:54:44.486 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:54:44.505 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:54:44.505 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 815 ms
2025-08-15 02:54:44.599 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:54:44.604 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 02:54:44.620 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:54:44.650 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:54:44.663 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:54:44.663 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:54:44.666 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 02:54:44.666 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 02:54:44.666 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 02:54:44.666 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 02:54:44.725 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:54:44.726 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:54:44.973 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:54:45.040 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:54:45.044 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:54:45.061 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:54:45.061 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:54:45.061 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:54:45.062 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:54:45.062 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:54:45.063 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:54:45.070 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 02:54:45.070 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 02:54:45.071 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:54:45.074 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:54:45.084 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:54:45.084 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:54:45.084 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:54:45.085 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:54:45.085 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:54:45.085 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:54:45.096 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:54:45.097 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:54:45.098 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:54:45.098 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5aa5b3af[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:45.099 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:54:45.099 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:54:45.107 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:54:45.107 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@55ff64fd[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:45.108 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:54:45.109 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@9d2c0ed[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:45.110 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:54:45.110 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6aed4a23[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:45.111 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:54:45.111 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5f7c1de0[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:45.112 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:54:45.112 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5cca5ff3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:45.117 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:54:45.117 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:54:45.123 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:54:45.224 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:54:45.233 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:54:45.233 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:54:45.241 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:54:45.241 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:54:45.241 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:54:45.312 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:54:45.341 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 02:54:45.341 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3cfd9459]]
2025-08-15 02:54:45.341 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 02:54:45.370 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:54:45.456 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:54:45.749 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:54:45.788 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@564b221e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@72e36d0f, org.springframework.security.web.context.SecurityContextHolderFilter@4c627575, org.springframework.security.web.header.HeaderWriterFilter@666033b1, com.acme.im.common.security.jwt.JwtAuthenticationFilter@3e0855b0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@58477355, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6f0124b5, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5031786b, org.springframework.security.web.session.SessionManagementFilter@63a6dffd, org.springframework.security.web.access.ExceptionTranslationFilter@6259f18e, org.springframework.security.web.access.intercept.AuthorizationFilter@25ea3a5f]
2025-08-15 02:54:45.951 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:54:45.951 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:54:45.951 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:54:45.951 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:54:45.951 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:54:45.951 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:54:45.951 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:54:45.953 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:54:45.953 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:54:45.953 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:54:45.954 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 02:54:46.078 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 02:54:46.079 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 02:54:46.079 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 02:54:46.079 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 02:54:46.079 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 02:54:46.079 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 02:54:46.079 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 02:54:46.080 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:54:46.081 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:54:46.082 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:54:46.083 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:54:46.083 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:54:46.097 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:54:46.097 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:54:46.099 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:54:46.099 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:54:46.106 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 02:54:46.113 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.6 seconds (process running for 2.767)
2025-08-15 02:54:46.116 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:54:46.117 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:54:46.117 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:54:46.117 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:54:46.117 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:54:46.118 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 02:54:46.118 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 02:54:46.119 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:54:46.296 [RMI TCP Connection(1)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:54:46.297 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:54:46.297 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 02:54:46.900 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 28423 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:54:46.901 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:54:46.901 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 02:54:47.195 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:54:47.195 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:54:47.203 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 02:54:47.340 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:54:47.340 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:54:47.341 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:54:47.375 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 02:54:47.714 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 02:54:47.718 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:54:47.718 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:54:47.736 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:54:47.736 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 818 ms
2025-08-15 02:54:47.829 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:54:47.845 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 02:54:47.845 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:54:47.846 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 02:54:47.863 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:54:47.895 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:54:47.909 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:54:47.909 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:54:47.922 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:54:47.923 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:54:48.044 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:54:48.190 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:54:48.195 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:54:48.207 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:54:48.207 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:54:48.207 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:54:48.208 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:54:48.208 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:54:48.209 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:54:48.209 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 02:54:48.216 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 02:54:48.216 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 02:54:48.216 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:54:48.222 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:54:48.227 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:54:48.227 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:54:48.227 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:54:48.228 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:54:48.228 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:54:48.228 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:54:48.242 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:54:48.242 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:54:48.243 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:54:48.243 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@769a9b7a[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:48.245 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:54:48.245 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:54:48.338 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:54:48.338 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@47f4dc8d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:48.340 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:54:48.340 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3514df8d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:48.341 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:54:48.341 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2bf2523f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:48.342 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:54:48.342 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@818a514[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:48.343 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:54:48.343 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@495e1ad1[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:54:48.346 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:54:48.346 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:54:48.353 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:54:48.448 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:54:48.457 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:54:48.457 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:54:48.465 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:54:48.465 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:54:48.465 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:54:48.538 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:54:48.590 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:54:48.687 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 02:54:48.936 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:54:48.972 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1c6ab85, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@45b221c7, org.springframework.security.web.context.SecurityContextHolderFilter@4e791e53, org.springframework.security.web.header.HeaderWriterFilter@5da61ee2, com.acme.im.common.security.jwt.JwtAuthenticationFilter@1f85904a, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4f091800, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1caff0db, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@14abde3e, org.springframework.security.web.session.SessionManagementFilter@22c5652b, org.springframework.security.web.access.ExceptionTranslationFilter@2ea82cef, org.springframework.security.web.access.intercept.AuthorizationFilter@75c8ba94]
2025-08-15 02:54:49.259 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 02:54:49.260 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 02:54:49.262 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:54:49.262 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:54:49.263 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:54:49.264 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:54:49.264 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:54:49.279 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:54:49.280 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:54:49.281 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:54:49.281 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:54:49.288 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 02:54:49.289 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 02:54:49.289 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@b7a2b89]]
2025-08-15 02:54:49.289 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 02:54:49.296 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.545 seconds (process running for 2.715)
2025-08-15 02:54:49.299 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:54:49.299 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:54:49.299 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 02:54:49.300 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:54:49.300 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:54:49.301 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:54:49.301 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 02:54:49.301 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 02:54:49.302 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 02:54:49.302 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 02:54:49.302 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 02:54:49.302 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 02:54:49.302 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 02:54:49.302 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 02:54:49.302 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 02:54:49.302 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 02:54:49.302 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:54:49.698 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:54:49.698 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:54:49.699 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 02:54:51.124 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:54:51.125 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:54:51.126 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:54:51.126 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:54:51.142 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:54:51.142 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:54:54.308 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:54:54.309 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:54:54.309 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:54:54.310 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:54:54.326 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:54:54.326 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:55:08.141 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 02:55:08.144 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 02:55:08.151 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 02:55:08.157 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 02:55:08.165 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 02:55:08.165 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 02:55:08.173 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 02:55:08.174 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 02:55:08.174 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 02:55:08.175 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 02:55:08.175 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 02:55:08.176 [http-nio-8080-exec-4] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 02:55:08.186 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 02:55:08.186 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 02:55:08.187 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 02:55:08.187 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 02:55:08.187 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 02:55:08.187 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 02:55:08.187 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T02:55:08.165700(LocalDateTime), 2025-08-15T02:55:08.165705(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 02:55:08.187 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T02:55:08.176174(LocalDateTime), 2025-08-15T02:55:08.176200(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 02:55:08.190 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 02:55:08.212 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:08.212 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:08.213 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 02:55:08.667 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:08.669 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 02:55:08.682 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 02:55:08.682 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:08.683 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.online.status.changed, queueSize=1
2025-08-15 02:55:08.689 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 02:55:08.689 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 02:55:08.690 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 02:55:08.690 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.*, method=handleAuthEvents, priority=200, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.cache.invalidated, method=handleCacheInvalidated, priority=300, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.*, method=handleAllBusinessEvents, priority=999, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 02:55:08.691 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 02:55:08.692 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 02:55:08.692 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 02:55:08.692 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 02:55:08.692 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.sent, method=handleMessageSent, priority=100, async=false
2025-08-15 02:55:08.692 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.received, method=handleMessageReceived, priority=100, async=false
2025-08-15 02:55:08.692 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.recalled, method=handleMessageRecalled, priority=200, async=true
2025-08-15 02:55:08.692 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.edited, method=handleMessageEdited, priority=200, async=false
2025-08-15 02:55:08.692 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.read, method=handleMessageRead, priority=150, async=false
2025-08-15 02:55:08.693 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.closed, method=handleConnectionClosed, priority=100, async=false
2025-08-15 02:55:08.693 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.heartbeat, method=handleHeartbeat, priority=300, async=false
2025-08-15 02:55:08.694 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.sent, method=handlePushSent, priority=100, async=false
2025-08-15 02:55:08.694 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.delivered, method=handlePushDelivered, priority=100, async=false
2025-08-15 02:55:08.694 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.profile, method=handleUserProfileSync, priority=100, async=false
2025-08-15 02:55:08.694 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.status, method=handleUserStatusSync, priority=100, async=false
2025-08-15 02:55:08.694 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.established, method=handleConnectionEstablished, priority=100, async=false
2025-08-15 02:55:08.695 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 02:55:08.695 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.*, method=onBusinessConversationChanged, priority=200, async=false
2025-08-15 02:55:08.695 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.*, method=handleAllCommunicationEvents, priority=999, async=false
2025-08-15 02:55:08.695 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationResponse, priority=100, async=false
2025-08-15 02:55:08.699 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 18 个处理器
2025-08-15 02:55:08.702 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 16 个处理器
2025-08-15 02:55:08.703 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 找到 1 个事件处理器: subject=business.user.*
2025-08-15 02:55:08.703 [im-common:28] DEBUG c.a.i.b.m.c.event.handler.BusinessEventHandler - 收到业务事件: subject=business.user.*, eventType=NOTIFICATION, data={userId=7.0, username=cccc, deviceId=test_device_001, ipAddress=null, userAgent=null, eventTime=2025-08-15 02:55:08, additionalData=null, description=null, success=true, errorMessage=null}
2025-08-15 02:55:08.704 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器执行成功: subject=business.*, method=handleAllBusinessEvents
2025-08-15 02:55:08.704 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.*, eventId=b04e9531-0166-47af-bef7-c0c10e4e457f
2025-08-15 02:55:08.707 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 未找到事件处理器: subject=business.user.login
2025-08-15 02:55:08.707 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.login, eventId=b04e9531-0166-47af-bef7-c0c10e4e457f
2025-08-15 02:55:09.666 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:09.667 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=2, total=10
2025-08-15 02:55:09.668 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.online.status.changed, useJetStream=false
2025-08-15 02:55:09.672 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=multi.device.user.status.sync, queueSize=1
2025-08-15 02:55:10.668 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:10.669 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=3, total=10
2025-08-15 02:55:10.670 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=multi.device.user.status.sync, useJetStream=false
2025-08-15 02:55:10.670 [http-nio-8080-exec-2] INFO  c.a.i.b.m.c.e.publisher.MultiDeviceSyncPublisher - 发布用户状态同步事件: userId=7, oldStatus=OFFLINE, newStatus=ONLINE, sourceDeviceId=test_device_001
2025-08-15 02:55:10.670 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户在线状态变更事件: userId=7, oldStatus=OFFLINE, newStatus=ONLINE
2025-08-15 02:55:10.676 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 02:55:10.679 [http-nio-8080-exec-4] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:10.679 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:10.679 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:10.679 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 02:55:11.667 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:11.667 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=4, total=10
2025-08-15 02:55:11.668 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 02:55:11.668 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:11.668 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.online.status.changed, queueSize=1
2025-08-15 02:55:11.669 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 找到 1 个事件处理器: subject=business.user.*
2025-08-15 02:55:11.670 [im-common:28] DEBUG c.a.i.b.m.c.event.handler.BusinessEventHandler - 收到业务事件: subject=business.user.*, eventType=NOTIFICATION, data={userId=7.0, username=cccc, deviceId=test_device_001, ipAddress=null, userAgent=null, eventTime=2025-08-15 02:55:10, additionalData=null, description=null, success=true, errorMessage=null}
2025-08-15 02:55:11.670 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器执行成功: subject=business.*, method=handleAllBusinessEvents
2025-08-15 02:55:11.670 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.*, eventId=45943323-8cf5-45fe-89e4-8357491ca497
2025-08-15 02:55:11.670 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 未找到事件处理器: subject=business.user.login
2025-08-15 02:55:11.670 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.login, eventId=45943323-8cf5-45fe-89e4-8357491ca497
2025-08-15 02:55:12.678 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:12.678 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=5, total=10
2025-08-15 02:55:12.678 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.online.status.changed, useJetStream=false
2025-08-15 02:55:12.678 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=multi.device.user.status.sync, queueSize=1
2025-08-15 02:55:13.668 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:13.668 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=6, total=10
2025-08-15 02:55:13.669 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=multi.device.user.status.sync, useJetStream=false
2025-08-15 02:55:13.670 [http-nio-8080-exec-4] INFO  c.a.i.b.m.c.e.publisher.MultiDeviceSyncPublisher - 发布用户状态同步事件: userId=7, oldStatus=OFFLINE, newStatus=ONLINE, sourceDeviceId=test_device_001
2025-08-15 02:55:13.670 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户在线状态变更事件: userId=7, oldStatus=OFFLINE, newStatus=ONLINE
2025-08-15 02:55:13.677 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:14.668 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=6, success=6, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:55:15.065 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:55:15.066 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:55:17.914 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:55:18.213 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:55:18.214 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:55:24.441 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 02:55:24.442 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.442 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 02:55:24.442 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 02:55:24.443 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 02:55:24.443 [http-nio-8080-exec-6] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 02:55:24.443 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 02:55:24.443 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 02:55:24.443 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 02:55:24.443 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T02:55:24.443337(LocalDateTime), 2025-08-15T02:55:24.443338(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 02:55:24.445 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 02:55:24.446 [http-nio-8080-exec-6] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.446 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.446 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 02:55:24.539 [http-nio-8080-exec-8] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 02:55:24.540 [http-nio-8080-exec-8] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.541 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 02:55:24.541 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 02:55:24.542 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 02:55:24.543 [http-nio-8080-exec-8] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 02:55:24.543 [http-nio-8080-exec-8] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 02:55:24.543 [http-nio-8080-exec-8] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 02:55:24.543 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 02:55:24.544 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T02:55:24.543084(LocalDateTime), 2025-08-15T02:55:24.543086(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 02:55:24.666 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:24.666 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=7, total=10
2025-08-15 02:55:24.667 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 02:55:24.667 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.669 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 找到 1 个事件处理器: subject=business.user.*
2025-08-15 02:55:24.670 [im-common:28] DEBUG c.a.i.b.m.c.event.handler.BusinessEventHandler - 收到业务事件: subject=business.user.*, eventType=NOTIFICATION, data={userId=7.0, username=cccc, deviceId=test_device_001, ipAddress=null, userAgent=null, eventTime=2025-08-15 02:55:24, additionalData=null, description=null, success=true, errorMessage=null}
2025-08-15 02:55:24.670 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器执行成功: subject=business.*, method=handleAllBusinessEvents
2025-08-15 02:55:24.670 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.*, eventId=452a2a9c-bb49-49e9-b763-dae269ba4d29
2025-08-15 02:55:24.670 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 未找到事件处理器: subject=business.user.login
2025-08-15 02:55:24.671 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.login, eventId=452a2a9c-bb49-49e9-b763-dae269ba4d29
2025-08-15 02:55:24.671 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.671 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 02:55:24.673 [http-nio-8080-exec-8] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.677 [http-nio-8080-exec-8] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:24.677 [http-nio-8080-exec-8] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 02:55:25.668 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 02:55:25.669 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=8, total=10
2025-08-15 02:55:25.669 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 02:55:25.670 [http-nio-8080-exec-8] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 02:55:25.675 [http-nio-8080-exec-8] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 02:55:25.676 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 找到 1 个事件处理器: subject=business.user.*
2025-08-15 02:55:25.676 [im-common:28] DEBUG c.a.i.b.m.c.event.handler.BusinessEventHandler - 收到业务事件: subject=business.user.*, eventType=NOTIFICATION, data={userId=7.0, username=cccc, deviceId=test_device_001, ipAddress=null, userAgent=null, eventTime=2025-08-15 02:55:24, additionalData=null, description=null, success=true, errorMessage=null}
2025-08-15 02:55:25.676 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器执行成功: subject=business.*, method=handleAllBusinessEvents
2025-08-15 02:55:25.676 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.*, eventId=73924dc1-cce9-4067-8fcc-d6be84b21b14
2025-08-15 02:55:25.676 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 未找到事件处理器: subject=business.user.login
2025-08-15 02:55:25.677 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 事件自动路由成功: subject=business.user.login, eventId=73924dc1-cce9-4067-8fcc-d6be84b21b14
2025-08-15 02:55:44.668 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:55:45.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:55:45.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:55:47.913 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:55:48.213 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:55:48.215 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:55:49.282 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 02:56:14.667 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:56:15.062 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:56:15.062 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:56:17.913 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:56:18.211 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:56:18.212 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:56:44.665 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:56:45.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:56:45.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:56:47.912 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:56:48.209 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:56:48.210 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:57:14.666 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:57:15.061 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:57:15.062 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:57:17.912 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:57:18.211 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:57:18.212 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:57:44.667 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:57:45.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:57:45.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:57:47.911 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:57:48.207 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:57:48.208 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:58:14.666 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:58:15.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:58:15.064 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:58:17.911 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:58:18.211 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:58:18.211 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:58:44.665 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:58:45.063 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:58:45.063 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:58:47.912 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:58:48.210 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:58:48.210 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:59:14.663 [async-event-scheduler-1] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=8, success=8, failed=0, retried=0, dropped=0, queue=0, successRate=100.00%}
2025-08-15 02:59:15.059 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:59:15.060 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:59:17.911 [async-event-scheduler-2] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步发布器统计: PublishStats{total=0, success=0, failed=0, retried=0, dropped=0, queue=0, successRate=0.00%}
2025-08-15 02:59:18.207 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 开始刷新配置缓存...
2025-08-15 02:59:18.208 [config-refresh] DEBUG com.acme.im.common.config.DynamicConfigManager - 配置缓存刷新完成: 缓存大小=0
2025-08-15 02:59:30.613 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 02:59:30.614 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@b7a2b89]]
2025-08-15 02:59:30.614 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 02:59:30.732 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:59:31.320 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:59:31.320 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:59:31.320 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:59:31.320 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:59:31.320 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:59:31.321 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:59:31.321 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:59:31.322 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:59:31.323 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:59:31.323 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:59:31.323 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 02:59:34.477 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 29504 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:59:34.478 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:59:34.478 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 02:59:34.736 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:59:34.736 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:59:34.742 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:59:34.880 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:59:34.881 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:59:34.882 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:59:34.914 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 02:59:35.272 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 02:59:35.276 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:59:35.276 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:59:35.296 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:59:35.297 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 802 ms
2025-08-15 02:59:35.402 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:59:35.419 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 02:59:35.420 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 02:59:35.438 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:59:35.469 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:59:35.484 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:59:35.485 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:59:35.498 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:59:35.500 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:59:35.622 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:59:35.774 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:59:35.778 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:59:35.790 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:59:35.791 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:59:35.791 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:59:35.792 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:59:35.792 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:59:35.793 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:59:35.793 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 02:59:35.801 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 02:59:35.801 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 02:59:35.801 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:59:35.807 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:59:35.812 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:59:35.812 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:59:35.812 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:59:35.813 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:59:35.814 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:59:35.814 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:59:35.827 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:59:35.827 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:59:35.828 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:59:35.828 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@39921410[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:35.829 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:59:35.830 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:59:35.924 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:59:35.924 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1d01fa0c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:35.925 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:59:35.926 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6fc03cf6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:35.927 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:59:35.927 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5fcff272[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:35.928 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:59:35.928 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3514df8d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:35.929 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:59:35.929 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2bf2523f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:35.932 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:59:35.932 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:59:35.938 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:59:36.038 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:59:36.047 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:59:36.047 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:59:36.055 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:59:36.055 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:59:36.055 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:59:36.132 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:59:36.184 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:59:36.285 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 02:59:36.530 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:59:36.569 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@509d0d21, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5a6dd1e7, org.springframework.security.web.context.SecurityContextHolderFilter@71d92487, org.springframework.security.web.header.HeaderWriterFilter@316a682b, com.acme.im.common.security.jwt.JwtAuthenticationFilter@d190639, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4467c026, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@59f0ef6e, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4fd9deed, org.springframework.security.web.session.SessionManagementFilter@29922188, org.springframework.security.web.access.ExceptionTranslationFilter@3c832820, org.springframework.security.web.access.intercept.AuthorizationFilter@2bdc2c26]
2025-08-15 02:59:36.641 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 02:59:36.876 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 02:59:36.878 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 02:59:36.879 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:59:36.880 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:59:36.881 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:59:36.883 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:59:36.884 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:59:36.884 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:59:36.906 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:59:36.906 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:59:36.908 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:59:36.908 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 02:59:36.919 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 02:59:36.919 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 02:59:36.920 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3746135b]]
2025-08-15 02:59:36.920 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 02:59:36.928 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.599 seconds (process running for 2.765)
2025-08-15 02:59:36.931 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 02:59:36.931 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:59:36.931 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 02:59:36.932 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:59:36.933 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:59:36.933 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 02:59:36.933 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 02:59:36.934 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 02:59:36.935 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 02:59:36.935 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:59:37.160 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 02:59:37.160 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 02:59:37.160 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 02:59:37.161 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 02:59:37.161 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 02:59:37.161 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 02:59:37.161 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 02:59:37.163 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 02:59:37.164 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 02:59:37.164 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 02:59:37.164 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=8
2025-08-15 02:59:37.284 [RMI TCP Connection(2)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:59:37.284 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:59:37.285 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 02:59:38.493 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 29529 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 02:59:38.494 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 02:59:38.494 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 02:59:38.831 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:59:38.831 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:59:38.837 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 02:59:38.982 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 02:59:38.982 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 02:59:38.987 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 02:59:39.373 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 02:59:39.377 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 02:59:39.377 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 02:59:39.396 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 02:59:39.396 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 881 ms
2025-08-15 02:59:39.484 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 02:59:39.490 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 02:59:39.507 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 02:59:39.545 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 02:59:39.561 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 02:59:39.562 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 02:59:39.565 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 02:59:39.565 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 02:59:39.565 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 02:59:39.565 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 02:59:39.625 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:59:39.627 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 02:59:39.871 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 02:59:39.939 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 02:59:39.942 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 02:59:39.960 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 02:59:39.960 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 02:59:39.960 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 02:59:39.961 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 02:59:39.961 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 02:59:39.962 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 02:59:39.970 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 02:59:39.970 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 02:59:39.970 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 02:59:39.975 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 02:59:39.986 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 02:59:39.986 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 02:59:39.986 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 02:59:39.987 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 02:59:39.988 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 02:59:39.988 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 02:59:39.999 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 02:59:39.999 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 02:59:40.001 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 02:59:40.001 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@32675dd4[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:40.002 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 02:59:40.003 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 02:59:40.011 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 02:59:40.011 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@35c9f527[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:40.012 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 02:59:40.012 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5d1eb214[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:40.013 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 02:59:40.013 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@4bd1b07d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:40.014 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 02:59:40.014 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5fafd099[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:40.015 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 02:59:40.015 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1e9a10e9[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 02:59:40.021 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 02:59:40.021 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 02:59:40.027 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 02:59:40.123 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 02:59:40.132 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 02:59:40.133 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 02:59:40.140 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 02:59:40.140 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 02:59:40.141 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 02:59:40.206 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 02:59:40.255 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 02:59:40.622 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 02:59:40.662 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3e711e84, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@61bbe16d, org.springframework.security.web.context.SecurityContextHolderFilter@453c10c2, org.springframework.security.web.header.HeaderWriterFilter@4dd11699, com.acme.im.common.security.jwt.JwtAuthenticationFilter@3e0855b0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@41a372c1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7e4f5062, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@426fb1c3, org.springframework.security.web.session.SessionManagementFilter@6f0124b5, org.springframework.security.web.access.ExceptionTranslationFilter@3ae648d2, org.springframework.security.web.access.intercept.AuthorizationFilter@5ac25491]
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 02:59:40.959 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 02:59:40.960 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 02:59:40.960 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 02:59:40.960 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 02:59:40.960 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 02:59:40.960 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 02:59:40.961 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 02:59:40.962 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 02:59:40.963 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 02:59:40.964 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 02:59:40.979 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:59:40.979 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:59:40.980 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:59:40.980 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 02:59:40.988 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 02:59:40.995 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.65 seconds (process running for 2.823)
2025-08-15 02:59:40.997 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 02:59:40.998 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 02:59:40.998 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 02:59:40.998 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 02:59:40.999 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 02:59:40.999 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 02:59:40.999 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 02:59:40.999 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 02:59:40.999 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 02:59:41.000 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 02:59:41.387 [RMI TCP Connection(2)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 02:59:41.388 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 02:59:41.388 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 02:59:41.938 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:59:41.938 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:59:41.938 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:59:41.938 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:59:41.946 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:59:41.946 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 02:59:46.002 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 02:59:46.003 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:59:46.003 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 02:59:46.003 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 02:59:46.032 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 02:59:46.032 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:00:00.403 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:00:00.405 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.412 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:00:00.419 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:00:00.426 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:00:00.426 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:00:00.445 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:00:00.445 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:00:00.445 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:00:00.446 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:00:00.426801(LocalDateTime), 2025-08-15T03:00:00.426805(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:00:00.448 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:00:00.469 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.469 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.470 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:00:00.475 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:00:00.475 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.475 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:00:00.476 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:00:00.477 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:00:00.477 [http-nio-8080-exec-4] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:00:00.477 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:00:00.477 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:00:00.477 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:00:00.478 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:00:00.477460(LocalDateTime), 2025-08-15T03:00:00.477464(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:00:00.566 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:00:00.567 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 03:00:00.569 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:00:00.569 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.571 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:00:00.571 [http-nio-8080-exec-4] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.571 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.571 [http-nio-8080-exec-4] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:00:00.572 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:00:00.573 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:00:00.574 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.*, replyTo=null, dataSize=630 bytes
2025-08-15 03:00:00.574 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:00:00.574 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:00:00.574 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:00:00.574 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:00:00.574 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 662 个Spring Bean
2025-08-15 03:00:00.575 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 687 个Spring Bean
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.established, method=handleConnectionEstablished, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.*, method=onBusinessConversationChanged, priority=200, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.*, method=handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.sent, method=handleMessageSent, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.received, method=handleMessageReceived, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.*, method=handleAuthEvents, priority=200, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.recalled, method=handleMessageRecalled, priority=200, async=true
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.cache.invalidated, method=handleCacheInvalidated, priority=300, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.edited, method=handleMessageEdited, priority=200, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.*, method=handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.read, method=handleMessageRead, priority=150, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.closed, method=handleConnectionClosed, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.heartbeat, method=handleHeartbeat, priority=300, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.sent, method=handlePushSent, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.delivered, method=handlePushDelivered, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.profile, method=handleUserProfileSync, priority=100, async=false
2025-08-15 03:00:00.575 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.status, method=handleUserStatusSync, priority=100, async=false
2025-08-15 03:00:00.575 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:00:00.578 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 18 个处理器
2025-08-15 03:00:00.578 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.*, business.user.logout, common.auth.validate, business.user.login, common.auth.*, common.cache.invalidated, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:00:00.579 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 18 个处理器
2025-08-15 03:00:00.579 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"f04521f6-0423-4a80-8859-b4a3ff92c819","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:00:00","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:00:00","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:00:00.581 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=f04521f6-0423-4a80-8859-b4a3ff92c819, eventType=NOTIFICATION, userId=7
2025-08-15 03:00:00.582 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.*
2025-08-15 03:00:00.582 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:00:00.582 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.*, eventId=f04521f6-0423-4a80-8859-b4a3ff92c819, eventType=NOTIFICATION
2025-08-15 03:00:00.582 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.*
2025-08-15 03:00:00.582 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:00:00.582 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleAllBusinessEvents
2025-08-15 03:00:00.582 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleAllBusinessEvents, subject=business.user.*, eventId=f04521f6-0423-4a80-8859-b4a3ff92c819
2025-08-15 03:00:00.582 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:00:00.582 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:00:00.582 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 16 个处理器
2025-08-15 03:00:00.582 [im-common:24] DEBUG c.a.i.b.m.c.event.handler.BusinessEventHandler - 收到业务事件: subject=business.user.*, eventType=NOTIFICATION, data={userId=7.0, username=cccc, deviceId=test_device_001, ipAddress=null, userAgent=null, eventTime=2025-08-15 03:00:00, additionalData=null, description=null, success=true, errorMessage=null}
2025-08-15 03:00:00.582 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [communication.connection.closed, communication.sync.user.status, communication.message.sent, communication.*, communication.connection.heartbeat, communication.push.sent, communication.message.read, business.user.status.changed, communication.message.edited, communication.connection.established, communication.message.recalled, communication.push.delivered, communication.message.received, communication.sync.user.profile, security.token.validate, business.conversation.*]
2025-08-15 03:00:00.582 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: BusinessEventHandler.handleAllBusinessEvents, subject=business.*, result=null
2025-08-15 03:00:00.582 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.*, eventId=f04521f6-0423-4a80-8859-b4a3ff92c819
2025-08-15 03:00:00.583 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 16 个处理器
2025-08-15 03:00:00.583 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"f04521f6-0423-4a80-8859-b4a3ff92c819","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:00:00","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:00:00","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:00:00.586 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=f04521f6-0423-4a80-8859-b4a3ff92c819, eventType=NOTIFICATION, userId=7
2025-08-15 03:00:00.586 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:00:00.586 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:00:00.586 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=f04521f6-0423-4a80-8859-b4a3ff92c819, eventType=NOTIFICATION
2025-08-15 03:00:00.586 [communication-service:33] WARN  c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 未找到事件处理器: subject=business.user.login
2025-08-15 03:00:00.586 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 当前已注册的主题: [communication.connection.closed, communication.sync.user.status, communication.message.sent, communication.*, communication.connection.heartbeat, communication.push.sent, communication.message.read, business.user.status.changed, communication.message.edited, communication.connection.established, communication.message.recalled, communication.push.delivered, communication.message.received, communication.sync.user.profile, security.token.validate, business.conversation.*]
2025-08-15 03:00:00.586 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=f04521f6-0423-4a80-8859-b4a3ff92c819
2025-08-15 03:00:01.567 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:00:01.568 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=2, total=10
2025-08-15 03:00:01.570 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:00:01.573 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:00:01.581 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:00:01.582 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"572da018-7215-437a-8735-ca10cf610171","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:00:00","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:00:00","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:00:01.582 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.*, replyTo=null, dataSize=630 bytes
2025-08-15 03:00:01.582 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"572da018-7215-437a-8735-ca10cf610171","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:00:00","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:00:00","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:00:01.582 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=572da018-7215-437a-8735-ca10cf610171, eventType=NOTIFICATION, userId=7
2025-08-15 03:00:01.582 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:00:01.582 [http-nio-8080-exec-4] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:00:01.582 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=572da018-7215-437a-8735-ca10cf610171, eventType=NOTIFICATION, userId=7
2025-08-15 03:00:01.582 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:00:01.582 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.*
2025-08-15 03:00:01.582 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:00:01.582 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=572da018-7215-437a-8735-ca10cf610171, eventType=NOTIFICATION
2025-08-15 03:00:01.582 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.*, eventId=572da018-7215-437a-8735-ca10cf610171, eventType=NOTIFICATION
2025-08-15 03:00:01.583 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.*
2025-08-15 03:00:01.583 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:00:01.583 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleAllBusinessEvents
2025-08-15 03:00:01.583 [communication-service:33] WARN  c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 未找到事件处理器: subject=business.user.login
2025-08-15 03:00:01.583 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleAllBusinessEvents, subject=business.user.*, eventId=572da018-7215-437a-8735-ca10cf610171
2025-08-15 03:00:01.583 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 当前已注册的主题: [communication.connection.closed, communication.sync.user.status, communication.message.sent, communication.*, communication.connection.heartbeat, communication.push.sent, communication.message.read, business.user.status.changed, communication.message.edited, communication.connection.established, communication.message.recalled, communication.push.delivered, communication.message.received, communication.sync.user.profile, security.token.validate, business.conversation.*]
2025-08-15 03:00:01.583 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:00:01.583 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=572da018-7215-437a-8735-ca10cf610171
2025-08-15 03:00:01.583 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:00:01.583 [im-common:24] DEBUG c.a.i.b.m.c.event.handler.BusinessEventHandler - 收到业务事件: subject=business.user.*, eventType=NOTIFICATION, data={userId=7.0, username=cccc, deviceId=test_device_001, ipAddress=null, userAgent=null, eventTime=2025-08-15 03:00:00, additionalData=null, description=null, success=true, errorMessage=null}
2025-08-15 03:00:01.583 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: BusinessEventHandler.handleAllBusinessEvents, subject=business.*, result=null
2025-08-15 03:00:01.583 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.*, eventId=572da018-7215-437a-8735-ca10cf610171
2025-08-15 03:00:36.912 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 03:00:37.129 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:00:37.130 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:00:37.130 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:00:37.131 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:00:37.133 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:00:37.133 [http-nio-8080-exec-6] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:00:37.134 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:00:37.134 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:00:37.134 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:00:37.135 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:00:37.133553(LocalDateTime), 2025-08-15T03:00:37.133559(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:00:37.136 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:00:37.138 [http-nio-8080-exec-6] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:00:37.138 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:00:37.138 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:00:37.578 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:00:37.579 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=3, total=10
2025-08-15 03:00:37.579 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:00:37.580 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:00:37.584 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:00:37.584 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.*, replyTo=null, dataSize=630 bytes
2025-08-15 03:00:37.584 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"cac2aec7-fa61-46a8-b060-083163cd3241","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:00:37","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:00:37","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:00:37.584 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:00:37.585 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=cac2aec7-fa61-46a8-b060-083163cd3241, eventType=NOTIFICATION, userId=7
2025-08-15 03:00:37.585 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.*
2025-08-15 03:00:37.585 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:00:37.585 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"cac2aec7-fa61-46a8-b060-083163cd3241","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:00:37","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:00:37","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:00:37.585 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.*, eventId=cac2aec7-fa61-46a8-b060-083163cd3241, eventType=NOTIFICATION
2025-08-15 03:00:37.585 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.*
2025-08-15 03:00:37.586 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:00:37.586 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleAllBusinessEvents
2025-08-15 03:00:37.586 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleAllBusinessEvents, subject=business.user.*, eventId=cac2aec7-fa61-46a8-b060-083163cd3241
2025-08-15 03:00:37.586 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=cac2aec7-fa61-46a8-b060-083163cd3241, eventType=NOTIFICATION, userId=7
2025-08-15 03:00:37.586 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:00:37.586 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:00:37.586 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:00:37.586 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:00:37.586 [im-common:24] DEBUG c.a.i.b.m.c.event.handler.BusinessEventHandler - 收到业务事件: subject=business.user.*, eventType=NOTIFICATION, data={userId=7.0, username=cccc, deviceId=test_device_001, ipAddress=null, userAgent=null, eventTime=2025-08-15 03:00:37, additionalData=null, description=null, success=true, errorMessage=null}
2025-08-15 03:00:37.586 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=cac2aec7-fa61-46a8-b060-083163cd3241, eventType=NOTIFICATION
2025-08-15 03:00:37.586 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: BusinessEventHandler.handleAllBusinessEvents, subject=business.*, result=null
2025-08-15 03:00:37.586 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.*, eventId=cac2aec7-fa61-46a8-b060-083163cd3241
2025-08-15 03:00:37.587 [communication-service:33] WARN  c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 未找到事件处理器: subject=business.user.login
2025-08-15 03:00:37.587 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 当前已注册的主题: [communication.connection.closed, communication.sync.user.status, communication.message.sent, communication.*, communication.connection.heartbeat, communication.push.sent, communication.message.read, business.user.status.changed, communication.message.edited, communication.connection.established, communication.message.recalled, communication.push.delivered, communication.message.received, communication.sync.user.profile, security.token.validate, business.conversation.*]
2025-08-15 03:00:37.587 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=cac2aec7-fa61-46a8-b060-083163cd3241
2025-08-15 03:04:35.841 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:04:36.949 [cache-4] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:04:36.950 [cache-3] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:04:40.013 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:05:35.842 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:05:40.013 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:09:35.840 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:09:36.954 [cache-6] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:09:36.954 [cache-5] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:09:40.013 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:11:01.364 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:11:01.439 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:11:01.439 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:11:01.439 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:11:01.439 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:11:01.439 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:11:01.440 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:11:01.440 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:11:01.443 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:11:01.443 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:11:01.443 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:11:01.444 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=3
2025-08-15 03:11:04.610 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 32076 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:11:04.611 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:11:04.611 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 03:11:04.891 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:11:04.891 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:11:04.897 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:11:05.040 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:11:05.040 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:11:05.045 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:11:05.431 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 03:11:05.436 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:11:05.436 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:11:05.457 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:11:05.458 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 829 ms
2025-08-15 03:11:05.556 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:11:05.561 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 03:11:05.577 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:11:05.606 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:11:05.620 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:11:05.621 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:11:05.624 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 03:11:05.624 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 03:11:05.624 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 03:11:05.624 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 03:11:05.688 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:11:05.689 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:11:05.949 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:11:06.016 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:11:06.020 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:11:06.039 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:11:06.039 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:11:06.039 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:11:06.040 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:11:06.040 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:11:06.041 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:11:06.049 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 03:11:06.050 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 03:11:06.050 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:11:06.053 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:11:06.064 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:11:06.065 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:11:06.065 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:11:06.066 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:11:06.066 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:11:06.066 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:11:06.078 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:11:06.079 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:11:06.080 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:11:06.080 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3e3a07ab[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:06.081 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:11:06.082 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:11:06.090 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:11:06.090 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@7ec176da[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:06.091 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:11:06.092 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@55ff64fd[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:06.093 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:11:06.093 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@445c693[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:06.094 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:11:06.094 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@272485a6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:06.095 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:11:06.095 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@40b678b3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:06.101 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:11:06.101 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:11:06.106 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:11:06.204 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:11:06.213 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:11:06.213 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:11:06.221 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:11:06.221 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:11:06.221 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:11:06.286 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:11:06.337 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:11:06.697 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:11:06.735 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5e16e521, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@51a4472d, org.springframework.security.web.context.SecurityContextHolderFilter@561f982f, org.springframework.security.web.header.HeaderWriterFilter@6e44825e, com.acme.im.common.security.jwt.JwtAuthenticationFilter@268f0ff3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3d707885, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6987a0f3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5930a229, org.springframework.security.web.session.SessionManagementFilter@1743c249, org.springframework.security.web.access.ExceptionTranslationFilter@1835b24b, org.springframework.security.web.access.intercept.AuthorizationFilter@40a0364a]
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:11:07.018 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 03:11:07.020 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:11:07.020 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:11:07.021 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:11:07.022 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:11:07.022 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:11:07.040 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:11:07.040 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:11:07.041 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:11:07.041 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:11:07.050 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 03:11:07.057 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.597 seconds (process running for 2.758)
2025-08-15 03:11:07.059 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:11:07.060 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 03:11:07.060 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:11:07.060 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.*
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.*
2025-08-15 03:11:07.060 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:11:07.061 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 03:11:07.061 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 03:11:07.062 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:11:07.227 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 03:11:07.227 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3746135b]]
2025-08-15 03:11:07.227 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 03:11:07.346 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:11:07.427 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:11:07.428 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:11:07.428 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 03:11:08.265 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:11:08.266 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:11:08.266 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:11:08.266 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:11:08.266 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:11:08.266 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:11:08.266 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:11:08.271 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:11:08.271 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:11:08.271 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:11:08.274 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 03:11:09.721 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 32097 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:11:09.722 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:11:09.722 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 03:11:10.030 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:11:10.030 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:11:10.036 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:11:10.178 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:11:10.178 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:11:10.183 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:11:10.219 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 03:11:10.582 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 03:11:10.586 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:11:10.586 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:11:10.606 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:11:10.607 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 864 ms
2025-08-15 03:11:10.708 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:11:10.727 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 03:11:10.727 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:11:10.728 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 03:11:10.747 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:11:10.781 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:11:10.797 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:11:10.798 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:11:10.811 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:11:10.813 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:11:10.951 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:11:11.110 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:11:11.114 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:11:11.127 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:11:11.127 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:11:11.127 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:11:11.127 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:11:11.128 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:11:11.129 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:11:11.129 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 03:11:11.136 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 03:11:11.137 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 03:11:11.137 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:11:11.143 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:11:11.147 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:11:11.148 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:11:11.148 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:11:11.149 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:11:11.149 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:11:11.149 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:11:11.163 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:11:11.163 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:11:11.164 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:11:11.165 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@51d2d336[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:11.166 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:11:11.166 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:11:11.273 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:11:11.274 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@48614fb3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:11.275 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:11:11.275 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@ab3b54[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:11.277 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:11:11.277 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6fc03cf6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:11.278 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:11:11.278 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5fcff272[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:11.279 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:11:11.279 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3514df8d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:11:11.282 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:11:11.282 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:11:11.288 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:11:11.387 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:11:11.397 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:11:11.397 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:11:11.405 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:11:11.405 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:11:11.405 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:11:11.478 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:11:11.530 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:11:11.630 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 03:11:11.897 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:11:11.935 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@13088030, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@71e6bac0, org.springframework.security.web.context.SecurityContextHolderFilter@491d36ef, org.springframework.security.web.header.HeaderWriterFilter@17f43f4a, com.acme.im.common.security.jwt.JwtAuthenticationFilter@3856d0cb, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2eb6a77f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@23389e2b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4c33bf70, org.springframework.security.web.session.SessionManagementFilter@1f3c3291, org.springframework.security.web.access.ExceptionTranslationFilter@4e44b713, org.springframework.security.web.access.intercept.AuthorizationFilter@c62d08a]
2025-08-15 03:11:12.063 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:11:12.064 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:11:12.064 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:11:12.064 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:11:12.070 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:11:12.070 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onBusinessConversationChanged, priority=200, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:11:12.246 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:11:12.248 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 16 个处理器
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:11:12.249 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:11:12.250 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:11:12.251 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:11:12.251 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:11:12.267 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:11:12.267 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:11:12.269 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:11:12.269 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:11:12.279 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 03:11:12.279 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 03:11:12.279 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@278e721e]]
2025-08-15 03:11:12.279 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 03:11:12.287 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.719 seconds (process running for 2.887)
2025-08-15 03:11:12.291 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:11:12.291 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 03:11:12.291 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:11:12.292 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 12/12 个主题
2025-08-15 03:11:12.293 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.conversation.created, business.conversation.updated, business.conversation.deleted, common.auth.token.expired, common.auth.permission.denied]
2025-08-15 03:11:12.293 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:11:12.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:11:12.294 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:11:12.294 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:11:12.294 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 03:11:12.294 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:11:12.294 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:11:12.563 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:11:12.563 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:11:12.564 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:11:17.299 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:11:17.300 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:11:17.300 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:11:17.300 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:11:17.306 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:11:17.306 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:11:21.984 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:11:21.986 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:11:21.993 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:11:21.999 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:11:22.007 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:11:22.007 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:11:22.024 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:11:22.025 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:11:22.025 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:11:22.025 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:11:22.007648(LocalDateTime), 2025-08-15T03:11:22.007652(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:11:22.028 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:11:22.049 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:11:22.049 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:11:22.050 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:11:22.623 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:11:22.624 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 03:11:22.631 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:11:22.631 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:11:22.638 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.*, replyTo=null, dataSize=630 bytes
2025-08-15 03:11:22.639 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:11:22.641 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:11:22.642 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:11:22.643 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 662 个Spring Bean
2025-08-15 03:11:22.645 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:11:22.645 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:11:22.645 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 03:11:22.645 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 03:11:22.645 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 03:11:22.645 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:11:22.646 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:11:22.645 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 03:11:22.646 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 03:11:22.646 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 03:11:22.647 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 687 个Spring Bean
2025-08-15 03:11:22.647 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:11:22.647 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 03:11:22.647 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 03:11:22.647 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.*, method=handleAuthEvents, priority=200, async=false
2025-08-15 03:11:22.647 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.cache.invalidated, method=handleCacheInvalidated, priority=300, async=false
2025-08-15 03:11:22.647 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.*, method=handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:11:22.647 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 03:11:22.648 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 03:11:22.648 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 03:11:22.648 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:11:22.648 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 03:11:22.649 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.sent, method=handleMessageSent, priority=100, async=false
2025-08-15 03:11:22.650 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.received, method=handleMessageReceived, priority=100, async=false
2025-08-15 03:11:22.650 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.recalled, method=handleMessageRecalled, priority=200, async=true
2025-08-15 03:11:22.650 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.edited, method=handleMessageEdited, priority=200, async=false
2025-08-15 03:11:22.650 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.read, method=handleMessageRead, priority=150, async=false
2025-08-15 03:11:22.651 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.closed, method=handleConnectionClosed, priority=100, async=false
2025-08-15 03:11:22.653 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.heartbeat, method=handleHeartbeat, priority=300, async=false
2025-08-15 03:11:22.653 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.sent, method=handlePushSent, priority=100, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.delivered, method=handlePushDelivered, priority=100, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.profile, method=handleUserProfileSync, priority=100, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.status, method=handleUserStatusSync, priority=100, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.established, method=handleConnectionEstablished, priority=100, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=onBusinessUserStatusChanged, priority=200, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.*, method=onBusinessConversationChanged, priority=200, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.*, method=handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:11:22.654 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:11:22.659 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 18 个处理器
2025-08-15 03:11:22.659 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.*, business.user.logout, common.auth.validate, business.user.login, common.auth.*, common.cache.invalidated, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:11:22.660 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 18 个处理器
2025-08-15 03:11:22.660 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"eec78176-1efc-4afa-866f-4366a1104f6d","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:11:22","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:11:22","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:11:22.661 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 16 个处理器
2025-08-15 03:11:22.661 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [communication.connection.closed, communication.sync.user.status, communication.message.sent, communication.connection.heartbeat, communication.push.sent, communication.*, communication.message.read, business.user.status.changed, communication.message.edited, communication.connection.established, communication.message.recalled, communication.push.delivered, communication.message.received, communication.sync.user.profile, security.token.validate, business.conversation.*]
2025-08-15 03:11:22.662 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 16 个处理器
2025-08-15 03:11:22.662 [communication-service:29] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"eec78176-1efc-4afa-866f-4366a1104f6d","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:11:22","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:11:22","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:11:22.663 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=eec78176-1efc-4afa-866f-4366a1104f6d, eventType=NOTIFICATION, userId=7
2025-08-15 03:11:22.663 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.*
2025-08-15 03:11:22.663 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:11:22.663 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.*, eventId=eec78176-1efc-4afa-866f-4366a1104f6d, eventType=NOTIFICATION
2025-08-15 03:11:22.663 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.*
2025-08-15 03:11:22.663 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:11:22.663 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleAllBusinessEvents
2025-08-15 03:11:22.663 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleAllBusinessEvents, subject=business.user.*, eventId=eec78176-1efc-4afa-866f-4366a1104f6d
2025-08-15 03:11:22.663 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:11:22.663 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:11:22.663 [im-common:28] INFO  c.a.i.b.m.c.event.handler.BusinessEventHandler - 📊 业务事件审计记录: subject=business.user.*, eventType=NOTIFICATION, userId=7, eventId=eec78176-1efc-4afa-866f-4366a1104f6d
2025-08-15 03:11:22.664 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: BusinessEventHandler.handleAllBusinessEvents, subject=business.*, result=null
2025-08-15 03:11:22.664 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.*, eventId=eec78176-1efc-4afa-866f-4366a1104f6d
2025-08-15 03:11:22.667 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=eec78176-1efc-4afa-866f-4366a1104f6d, eventType=NOTIFICATION, userId=7
2025-08-15 03:11:22.667 [communication-service:29] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:11:22.667 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:11:22.667 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=eec78176-1efc-4afa-866f-4366a1104f6d, eventType=NOTIFICATION
2025-08-15 03:11:22.667 [communication-service:29] WARN  c.a.i.c.i.nats.handler.EventHandlerRegistry - 未找到事件处理器: subject=business.user.login
2025-08-15 03:11:22.667 [communication-service:29] WARN  c.a.i.c.i.nats.handler.EventHandlerRegistry - 已注册的主题: [communication.connection.closed, communication.sync.user.status, communication.message.sent, communication.connection.heartbeat, communication.push.sent, communication.*, communication.message.read, business.user.status.changed, communication.message.edited, communication.connection.established, communication.message.recalled, communication.push.delivered, communication.message.received, communication.sync.user.profile, security.token.validate, business.conversation.*]
2025-08-15 03:11:22.667 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=eec78176-1efc-4afa-866f-4366a1104f6d
2025-08-15 03:12:12.271 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 03:15:34.707 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 03:15:34.707 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@278e721e]]
2025-08-15 03:15:34.707 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 03:15:34.827 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:15:35.313 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:15:35.314 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:15:35.314 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:15:35.314 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:15:35.314 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:15:35.314 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:15:35.315 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:15:35.318 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:15:35.319 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:15:35.319 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:15:35.320 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 03:15:38.308 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 33065 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:15:38.309 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:15:38.309 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 03:15:38.569 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:15:38.569 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:15:38.576 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:15:38.712 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:15:38.712 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:15:38.713 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:15:38.745 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 03:15:39.000 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:15:39.105 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:15:39.105 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:15:39.105 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:15:39.105 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:15:39.105 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:15:39.105 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:15:39.105 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:15:39.107 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:15:39.107 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:15:39.107 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:15:39.108 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=1
2025-08-15 03:15:39.109 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 03:15:39.113 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:15:39.113 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:15:39.134 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:15:39.134 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 805 ms
2025-08-15 03:15:39.256 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:15:39.275 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:15:39.276 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:15:39.277 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:15:39.277 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:15:39.277 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 03:15:39.295 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:15:39.326 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:15:39.341 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:15:39.342 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:15:39.355 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:15:39.356 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:15:39.477 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:15:39.655 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:15:39.658 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:15:39.672 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:15:39.673 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:15:39.673 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:15:39.674 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:15:39.674 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:15:39.675 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:15:39.675 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 03:15:39.683 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 03:15:39.684 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 03:15:39.684 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:15:39.691 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:15:39.698 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:15:39.698 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:15:39.698 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:15:39.700 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:15:39.700 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:15:39.700 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:15:39.717 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:15:39.717 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:15:39.719 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:15:39.719 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@39921410[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:39.720 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:15:39.720 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:15:39.833 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:15:39.833 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6e70861[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:39.835 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:15:39.835 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@4b3b2a4f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:39.836 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:15:39.836 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@7a3f3bc4[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:39.837 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:15:39.838 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1a3611b1[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:39.839 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:15:39.839 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@427c2c96[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:39.844 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:15:39.844 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:15:39.852 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:15:39.968 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:15:39.986 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:15:39.986 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:15:40.001 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:15:40.001 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:15:40.001 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:15:40.124 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 33077 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:15:40.125 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:15:40.126 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 03:15:40.257 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:15:40.397 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:15:40.523 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 03:15:40.648 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:15:40.648 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:15:40.658 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:15:40.822 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:15:40.830 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:15:40.830 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:15:40.835 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:15:40.861 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3294b641, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@799bb4ed, org.springframework.security.web.context.SecurityContextHolderFilter@1c0455c4, org.springframework.security.web.header.HeaderWriterFilter@2d58136, com.acme.im.common.security.jwt.JwtAuthenticationFilter@d190639, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5c937c92, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4cde5d66, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5269aa68, org.springframework.security.web.session.SessionManagementFilter@6faa24, org.springframework.security.web.access.ExceptionTranslationFilter@429ad94a, org.springframework.security.web.access.intercept.AuthorizationFilter@648e25f2]
2025-08-15 03:15:41.181 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=CommunicationEventHandler.onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=CommunicationEventHandler.onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.*, handler=CommunicationEventHandler.onAllBusinessConversationEvents, priority=999, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=CommunicationEventHandler.onBusinessUserLogout, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=CommunicationEventHandler.onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=CommunicationEventHandler.onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.*, handler=CommunicationEventHandler.onAllBusinessUserEvents, priority=999, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.*, handler=CommunicationEventHandler.onAllBusinessGroupEvents, priority=999, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.*, handler=CommunicationEventHandler.onAllBusinessFriendEvents, priority=999, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=CommunicationEventHandler.onAllCommonAuthEvents, priority=999, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.*, handler=CommunicationEventHandler.onAllSecurityEvents, priority=999, async=false
2025-08-15 03:15:41.182 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:15:41.184 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 27 个处理器
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:15:41.185 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:15:41.186 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:15:41.187 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:15:41.187 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:15:41.205 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:15:41.205 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:15:41.207 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:15:41.207 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:15:41.216 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 03:15:41.217 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 03:15:41.217 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1ac24c17]]
2025-08-15 03:15:41.217 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 03:15:41.224 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 3.068 seconds (process running for 3.231)
2025-08-15 03:15:41.228 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:15:41.228 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:15:41.228 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 03:15:41.229 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:15:41.229 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:15:41.229 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:15:41.229 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:15:41.229 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:15:41.229 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:15:41.229 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:15:41.230 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 03:15:41.230 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:15:41.230 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.*
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 03:15:41.231 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.*
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.*
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 03:15:41.232 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.*
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.validate
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.validate, sid=security.token.validate
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.refresh
2025-08-15 03:15:41.233 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.refresh, sid=security.token.refresh
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.revoke
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.revoke, sid=security.token.revoke
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.auth.failed
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.auth.failed, sid=security.auth.failed
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.permission.denied
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.permission.denied, sid=security.permission.denied
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.*
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.*, sid=security.*
2025-08-15 03:15:41.234 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 41/41 个主题
2025-08-15 03:15:41.234 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.user.*, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.conversation.*, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.group.*, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, business.friend.*, common.auth.token.expired, common.auth.permission.denied, common.auth.*, security.token.validate, security.token.refresh, security.token.revoke, security.auth.failed, security.permission.denied, security.*]
2025-08-15 03:15:41.234 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:15:41.259 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 03:15:41.264 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:15:41.265 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:15:41.286 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:15:41.286 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1032 ms
2025-08-15 03:15:41.394 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:15:41.402 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 03:15:41.427 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:15:41.464 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:15:41.480 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:15:41.481 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:15:41.485 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 03:15:41.485 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 03:15:41.485 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 03:15:41.485 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 03:15:41.549 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:15:41.551 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:15:41.630 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:15:41.630 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:15:41.631 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:15:41.827 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:15:41.896 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:15:42.006 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:15:42.027 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:15:42.027 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:15:42.027 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:15:42.028 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:15:42.029 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:15:42.030 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:15:42.040 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 03:15:42.040 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 03:15:42.041 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:15:42.044 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:15:42.058 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:15:42.058 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:15:42.058 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:15:42.060 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:15:42.060 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:15:42.060 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:15:42.074 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:15:42.075 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:15:42.076 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:15:42.076 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@126e2710[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:42.078 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:15:42.078 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:15:42.090 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:15:42.090 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@40b678b3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:42.091 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:15:42.091 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5cca5ff3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:42.092 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:15:42.092 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@10664c3d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:42.094 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:15:42.094 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@7712df76[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:42.095 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:15:42.095 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2c3d0ff8[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:15:42.102 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:15:42.102 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:15:42.108 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:15:42.211 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:15:42.220 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:15:42.220 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:15:42.228 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:15:42.228 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:15:42.228 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:15:42.297 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:15:42.353 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:15:42.725 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:15:42.767 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@57cc7d9e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@23c07745, org.springframework.security.web.context.SecurityContextHolderFilter@11b5b1f2, org.springframework.security.web.header.HeaderWriterFilter@63a6dffd, com.acme.im.common.security.jwt.JwtAuthenticationFilter@2bc2e022, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1d280bab, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@76b5b1e2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@62a07c01, org.springframework.security.web.session.SessionManagementFilter@7e32f76b, org.springframework.security.web.access.ExceptionTranslationFilter@2b991034, org.springframework.security.web.access.intercept.AuthorizationFilter@5031786b]
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.*, handler=BusinessEventHandler.handleAuthEvents, priority=200, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.cache.invalidated, handler=BusinessEventHandler.handleCacheInvalidated, priority=300, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.*, handler=BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:15:43.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 03:15:43.072 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 18 个处理器
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:15:43.072 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:15:43.073 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:15:43.074 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:15:43.074 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:15:43.089 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:15:43.089 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:15:43.090 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:15:43.090 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:15:43.098 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 03:15:43.105 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 3.228 seconds (process running for 3.405)
2025-08-15 03:15:43.108 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:15:43.108 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:15:43.108 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:15:43.108 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:15:43.109 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 03:15:43.109 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:15:43.109 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:15:43.109 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:15:43.110 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 03:15:43.110 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 03:15:43.111 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:15:43.331 [RMI TCP Connection(4)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:15:43.331 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:15:43.332 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 03:15:46.239 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:15:46.240 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:15:46.240 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:15:46.240 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:15:46.250 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:15:46.250 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:15:48.114 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:15:48.115 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:15:48.115 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:15:48.115 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:15:48.129 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:15:48.129 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:15:49.405 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:15:49.407 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:15:49.413 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:15:49.420 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:15:49.428 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:15:49.428 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:15:49.445 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:15:49.446 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:15:49.446 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:15:49.446 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:15:49.428844(LocalDateTime), 2025-08-15T03:15:49.428847(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:15:49.449 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:15:49.470 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:15:49.470 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:15:49.471 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:15:49.483 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:15:49.484 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 03:15:49.485 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:15:49.485 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:15:49.488 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.*, replyTo=null, dataSize=630 bytes
2025-08-15 03:15:49.488 [communication-service:38] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.*, replyTo=null, dataSize=630 bytes
2025-08-15 03:15:49.488 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:15:49.488 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:15:49.488 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:15:49.488 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:15:49.488 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 662 个Spring Bean
2025-08-15 03:15:49.488 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:15:49.488 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:15:49.488 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 687 个Spring Bean
2025-08-15 03:15:49.488 [communication-service:38] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:15:49.488 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:15:49.488 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 03:15:49.488 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 03:15:49.488 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 03:15:49.488 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.*, method=handleAuthEvents, priority=200, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.cache.invalidated, method=handleCacheInvalidated, priority=300, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.*, method=handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:15:49.489 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.*, method=onAllBusinessConversationEvents, priority=999, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.established, method=handleConnectionEstablished, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.sent, method=handleMessageSent, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.received, method=handleMessageReceived, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.recalled, method=handleMessageRecalled, priority=200, async=true
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.edited, method=handleMessageEdited, priority=200, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.read, method=handleMessageRead, priority=150, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.closed, method=handleConnectionClosed, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.heartbeat, method=handleHeartbeat, priority=300, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.sent, method=handlePushSent, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.delivered, method=handlePushDelivered, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.profile, method=handleUserProfileSync, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.status, method=handleUserStatusSync, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=onBusinessUserLogin, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=onBusinessUserLogout, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.*, method=onAllBusinessUserEvents, priority=999, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.*, method=onAllBusinessGroupEvents, priority=999, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.*, method=onAllBusinessFriendEvents, priority=999, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.*, method=onAllCommonAuthEvents, priority=999, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.*, method=onAllSecurityEvents, priority=999, async=false
2025-08-15 03:15:49.489 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:15:49.491 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 18 个处理器
2025-08-15 03:15:49.491 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.*, business.user.logout, common.auth.validate, business.user.login, common.auth.*, common.cache.invalidated, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:15:49.491 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 18 个处理器
2025-08-15 03:15:49.491 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"3938e38f-0490-43bc-a747-0c8a04d12c81","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:15:49","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:15:49","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:15:49.491 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 27 个处理器
2025-08-15 03:15:49.492 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, communication.message.edited, communication.connection.established, communication.message.recalled, communication.push.delivered, communication.message.received, business.user.login, communication.sync.user.profile, common.auth.*, business.friend.*, business.conversation.updated, business.group.created, communication.connection.closed, communication.sync.user.status, communication.message.sent, communication.connection.heartbeat, communication.push.sent, communication.message.read, business.user.status.changed, business.user.profile.updated, security.*, business.user.logout, business.group.*, business.user.*, security.token.validate, business.conversation.*]
2025-08-15 03:15:49.492 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 27 个处理器
2025-08-15 03:15:49.492 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"3938e38f-0490-43bc-a747-0c8a04d12c81","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:15:49","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:15:49","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:15:49.492 [communication-service:38] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"3938e38f-0490-43bc-a747-0c8a04d12c81","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:15:49","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:15:49","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=3938e38f-0490-43bc-a747-0c8a04d12c81, eventType=NOTIFICATION, userId=7
2025-08-15 03:15:49.493 [im-common:28] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.*
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.*, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81, eventType=NOTIFICATION
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.*
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleAllBusinessEvents, priority=999, async=false
2025-08-15 03:15:49.493 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleAllBusinessEvents
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleAllBusinessEvents, subject=business.user.*, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.493 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:15:49.493 [im-common:28] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.b.m.c.event.handler.BusinessEventHandler - 📊 业务事件审计记录: subject=business.user.*, eventType=NOTIFICATION, userId=7, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: BusinessEventHandler.handleAllBusinessEvents, subject=business.*, result=null
2025-08-15 03:15:49.493 [im-common:28] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.*, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=3938e38f-0490-43bc-a747-0c8a04d12c81, eventType=NOTIFICATION, userId=7
2025-08-15 03:15:49.495 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=3938e38f-0490-43bc-a747-0c8a04d12c81, eventType=NOTIFICATION, userId=7
2025-08-15 03:15:49.495 [communication-service:38] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.*
2025-08-15 03:15:49.495 [communication-service:33] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:15:49.495 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.*, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81, eventType=NOTIFICATION
2025-08-15 03:15:49.495 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81, eventType=NOTIFICATION
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.*
2025-08-15 03:15:49.495 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 2 个事件处理器: subject=business.user.login
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onAllBusinessUserEvents, priority=999, async=false
2025-08-15 03:15:49.495 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:15:49.495 [communication-service:38] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onAllBusinessUserEvents
2025-08-15 03:15:49.495 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onAllBusinessUserEvents, priority=999, async=false
2025-08-15 03:15:49.495 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserLogin
2025-08-15 03:15:49.495 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onAllBusinessUserEvents, subject=business.user.*, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.495 [communication-service:38] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:15:49.495 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:15:49.495 [communication-service:38] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:15:49.495 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.event.CommunicationEventHandler - 📊 业务用户事件审计记录: subject=business.user.*, eventType=NOTIFICATION, userId=7, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: CommunicationEventHandler.onAllBusinessUserEvents, subject=business.user.*, result=null
2025-08-15 03:15:49.495 [communication-service:38] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.*, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.495 [communication-service:33] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserOnlineEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserOnlineEvent are in unnamed module of loader 'app')
	at com.acme.im.communication.event.CommunicationEventHandler.onBusinessUserLogin(CommunicationEventHandler.java:315)
	... 21 common frames omitted
2025-08-15 03:15:49.496 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onAllBusinessUserEvents
2025-08-15 03:15:49.496 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onAllBusinessUserEvents, subject=business.user.login, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.496 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:15:49.496 [communication-service:33] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:15:49.496 [communication-service:33] INFO  c.a.i.c.event.CommunicationEventHandler - 📊 业务用户事件审计记录: subject=business.user.login, eventType=NOTIFICATION, userId=7, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:15:49.496 [communication-service:33] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: CommunicationEventHandler.onAllBusinessUserEvents, subject=business.user.*, result=null
2025-08-15 03:15:49.496 [communication-service:33] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=3938e38f-0490-43bc-a747-0c8a04d12c81
2025-08-15 03:16:41.203 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 03:20:39.727 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:20:41.236 [cache-3] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:20:41.236 [cache-4] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:20:42.084 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:21:39.727 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:21:42.085 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:24:52.718 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:24:53.085 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:24:53.085 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:24:53.085 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:24:53.085 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:24:53.086 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:24:53.086 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:24:53.086 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:24:53.089 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:24:53.090 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:24:53.090 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:24:53.093 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=1
2025-08-15 03:24:56.066 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 35138 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:24:56.066 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:24:56.067 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 03:24:56.345 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:24:56.346 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:24:56.352 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:24:56.356 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 03:24:56.356 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1ac24c17]]
2025-08-15 03:24:56.356 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 03:24:56.473 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:24:56.493 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:24:56.493 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:24:56.497 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:24:56.909 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 03:24:56.913 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:24:56.913 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:24:56.932 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:24:56.932 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 848 ms
2025-08-15 03:24:57.030 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:24:57.035 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 03:24:57.052 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:24:57.083 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:24:57.096 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:24:57.097 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:24:57.099 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 03:24:57.100 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 03:24:57.100 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 03:24:57.100 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 03:24:57.161 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:24:57.162 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:24:57.211 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:24:57.211 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:24:57.211 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:24:57.211 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:24:57.211 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:24:57.211 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:24:57.211 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:24:57.214 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:24:57.214 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:24:57.214 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:24:57.215 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 03:24:57.416 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:24:57.485 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:24:57.488 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:24:57.505 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:24:57.506 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:24:57.506 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:24:57.506 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:24:57.507 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:24:57.508 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:24:57.515 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 03:24:57.516 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 03:24:57.516 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:24:57.519 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:24:57.529 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:24:57.529 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:24:57.529 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:24:57.530 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:24:57.531 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:24:57.531 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:24:57.542 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:24:57.542 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:24:57.543 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:24:57.544 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@48224381[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:24:57.545 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:24:57.545 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:24:57.553 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:24:57.553 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@40dc2ade[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:24:57.554 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:24:57.554 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1bca9b64[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:24:57.555 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:24:57.555 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@508abc74[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:24:57.556 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:24:57.557 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@386ea60f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:24:57.558 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:24:57.558 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@99774ec[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:24:57.563 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:24:57.563 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:24:57.568 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:24:57.666 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:24:57.675 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:24:57.675 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:24:57.684 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:24:57.684 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:24:57.684 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:24:57.750 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:24:57.808 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:24:58.235 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:24:58.278 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5066a895, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6eec564c, org.springframework.security.web.context.SecurityContextHolderFilter@1cd50433, org.springframework.security.web.header.HeaderWriterFilter@63714a1, com.acme.im.common.security.jwt.JwtAuthenticationFilter@7e1762e6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2baf2c6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3ad9f06a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4dd11699, org.springframework.security.web.session.SessionManagementFilter@4170ee0f, org.springframework.security.web.access.ExceptionTranslationFilter@fabe3f8, org.springframework.security.web.access.intercept.AuthorizationFilter@559d9517]
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:24:58.654 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 03:24:58.657 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 15 个处理器
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:24:58.657 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:24:58.658 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:24:58.659 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:24:58.659 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:24:58.676 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:24:58.676 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:24:58.678 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:24:58.678 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:24:58.688 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 03:24:58.696 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.781 seconds (process running for 2.949)
2025-08-15 03:24:58.699 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.*, sid=business.user.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.*, sid=business.conversation.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.*, sid=business.group.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.*, sid=business.friend.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:24:58.700 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 6/6 个主题
2025-08-15 03:24:58.700 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.*, business.conversation.*, business.group.*, business.friend.*, common.auth.*, common.cache.*]
2025-08-15 03:24:58.700 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:24:58.700 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:24:58.701 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:24:58.701 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:24:58.701 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:24:58.701 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:24:58.701 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:24:58.701 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:24:58.701 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:24:58.701 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 03:24:58.701 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:24:58.703 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:24:58.876 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 35155 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:24:58.876 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:24:58.877 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 03:24:58.902 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:24:58.902 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:24:58.903 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:24:59.149 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:24:59.149 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:24:59.156 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:24:59.320 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:24:59.320 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:24:59.322 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:24:59.366 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 03:24:59.730 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 03:24:59.734 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:24:59.734 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:24:59.755 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:24:59.756 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 861 ms
2025-08-15 03:24:59.854 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:24:59.872 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 03:24:59.872 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:24:59.872 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:24:59.872 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:24:59.873 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 03:24:59.891 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:24:59.926 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:24:59.941 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:24:59.942 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:24:59.956 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:24:59.957 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:25:00.080 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:25:00.233 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:25:00.238 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:25:00.250 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:25:00.250 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:25:00.250 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:25:00.251 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:25:00.251 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:25:00.252 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:25:00.252 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 03:25:00.259 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 03:25:00.259 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 03:25:00.259 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:25:00.265 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:25:00.270 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:25:00.270 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:25:00.270 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:25:00.271 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:25:00.271 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:25:00.271 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:25:00.285 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:25:00.285 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:25:00.286 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:25:00.286 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@51d2d336[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:25:00.287 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:25:00.288 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:25:00.387 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:25:00.387 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@48614fb3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:25:00.389 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:25:00.389 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@ab3b54[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:25:00.390 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:25:00.390 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6fc03cf6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:25:00.391 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:25:00.391 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5fcff272[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:25:00.392 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:25:00.392 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3514df8d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:25:00.396 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:25:00.396 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:25:00.402 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:25:00.500 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:25:00.510 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:25:00.510 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:25:00.519 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:25:00.519 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:25:00.519 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:25:00.598 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:25:00.656 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:25:00.764 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 03:25:01.029 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:25:01.068 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@13088030, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@71e6bac0, org.springframework.security.web.context.SecurityContextHolderFilter@491d36ef, org.springframework.security.web.header.HeaderWriterFilter@17f43f4a, com.acme.im.common.security.jwt.JwtAuthenticationFilter@3856d0cb, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2eb6a77f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@23389e2b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4c33bf70, org.springframework.security.web.session.SessionManagementFilter@1f3c3291, org.springframework.security.web.access.ExceptionTranslationFilter@4e44b713, org.springframework.security.web.access.intercept.AuthorizationFilter@c62d08a]
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=CommunicationEventHandler.onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=CommunicationEventHandler.onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=CommunicationEventHandler.onBusinessUserLogout, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=CommunicationEventHandler.onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=CommunicationEventHandler.onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:25:01.387 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:25:01.389 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 22 个处理器
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:25:01.390 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:25:01.391 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:25:01.392 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:25:01.392 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:25:01.410 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:25:01.410 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:25:01.412 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:25:01.412 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:25:01.422 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 03:25:01.422 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 03:25:01.423 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@278e721e]]
2025-08-15 03:25:01.423 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 03:25:01.431 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.729 seconds (process running for 2.898)
2025-08-15 03:25:01.435 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:25:01.435 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 03:25:01.436 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 03:25:01.436 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 03:25:01.436 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 03:25:01.436 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 03:25:01.436 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:25:01.437 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 03:25:01.438 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.validate
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.validate, sid=security.token.validate
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.refresh
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.refresh, sid=security.token.refresh
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.revoke
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.revoke, sid=security.token.revoke
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.auth.failed
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.auth.failed, sid=security.auth.failed
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.permission.denied
2025-08-15 03:25:01.439 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.permission.denied, sid=security.permission.denied
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 35/35 个主题
2025-08-15 03:25:01.440 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, security.token.validate, security.token.refresh, security.token.revoke, security.auth.failed, security.permission.denied]
2025-08-15 03:25:01.440 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.*
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.*, sid=common.auth.*
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.*
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.*, sid=common.cache.*
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:25:01.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:25:01.440 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 4/4 个通用主题
2025-08-15 03:25:01.440 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.*, common.cache.*, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:25:01.441 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:25:01.852 [RMI TCP Connection(1)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:25:01.852 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:25:01.853 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:25:03.706 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:25:03.707 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:25:03.707 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:25:03.707 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:25:03.717 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:25:03.717 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:25:06.445 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:25:06.445 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:25:06.445 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:25:06.445 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:25:06.452 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:25:06.452 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:25:09.623 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:25:09.626 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:25:09.632 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:25:09.638 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:25:09.645 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:25:09.646 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:25:09.662 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:25:09.663 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:25:09.663 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:25:09.663 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:25:09.646133(LocalDateTime), 2025-08-15T03:25:09.646135(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:25:09.666 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:25:09.686 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:25:09.686 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:25:09.687 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:25:10.102 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:25:10.104 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 03:25:10.113 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:25:10.113 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:25:10.119 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.*, replyTo=null, dataSize=630 bytes
2025-08-15 03:25:10.121 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:25:10.122 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:25:10.122 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:25:10.122 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 662 个Spring Bean
2025-08-15 03:25:10.123 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:25:10.124 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:25:10.124 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:25:10.124 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 03:25:10.124 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 03:25:10.124 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 03:25:10.124 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 03:25:10.125 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 03:25:10.125 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:25:10.125 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 03:25:10.125 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 687 个Spring Bean
2025-08-15 03:25:10.125 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:25:10.125 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 03:25:10.126 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 03:25:10.126 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 03:25:10.126 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 03:25:10.126 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 03:25:10.126 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:25:10.126 [im-common:24] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 03:25:10.127 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.established, method=handleConnectionEstablished, priority=100, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.*, method=handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.sent, method=handleMessageSent, priority=100, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.received, method=handleMessageReceived, priority=100, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.recalled, method=handleMessageRecalled, priority=200, async=true
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.edited, method=handleMessageEdited, priority=200, async=false
2025-08-15 03:25:10.128 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.read, method=handleMessageRead, priority=150, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.closed, method=handleConnectionClosed, priority=100, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.heartbeat, method=handleHeartbeat, priority=300, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.sent, method=handlePushSent, priority=100, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.delivered, method=handlePushDelivered, priority=100, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.profile, method=handleUserProfileSync, priority=100, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.status, method=handleUserStatusSync, priority=100, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=onBusinessUserLogin, priority=100, async=false
2025-08-15 03:25:10.129 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=onBusinessUserLogout, priority=100, async=false
2025-08-15 03:25:10.130 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:25:10.130 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:25:10.130 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:25:10.133 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 15 个处理器
2025-08-15 03:25:10.133 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.user.logout, common.auth.validate, business.user.login, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:25:10.134 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 15 个处理器
2025-08-15 03:25:10.134 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"898d0a08-c3b2-462e-98bd-a6e28cc30802","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:25:09","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:25:09","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:25:10.135 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 22 个处理器
2025-08-15 03:25:10.135 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, communication.connection.closed, communication.sync.user.status, business.friend.added, communication.message.sent, communication.*, communication.connection.heartbeat, communication.push.sent, communication.message.read, business.user.status.changed, communication.message.edited, business.user.profile.updated, communication.connection.established, business.user.logout, communication.message.recalled, communication.push.delivered, communication.message.received, business.user.login, communication.sync.user.profile, business.conversation.updated, security.token.validate, business.group.created]
2025-08-15 03:25:10.136 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 22 个处理器
2025-08-15 03:25:10.136 [communication-service:29] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"898d0a08-c3b2-462e-98bd-a6e28cc30802","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:25:09","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:25:09","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:25:10.137 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802, eventType=NOTIFICATION, userId=7
2025-08-15 03:25:10.138 [im-common:24] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.*
2025-08-15 03:25:10.138 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:25:10.138 [im-common:24] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.*, eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802, eventType=NOTIFICATION
2025-08-15 03:25:10.138 [im-common:24] WARN  c.a.i.c.i.nats.handler.EventHandlerRegistry - 未找到事件处理器: subject=business.user.*
2025-08-15 03:25:10.138 [im-common:24] WARN  c.a.i.c.i.nats.handler.EventHandlerRegistry - 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.user.logout, common.auth.validate, business.user.login, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:25:10.138 [im-common:24] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.*, eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802, eventType=NOTIFICATION, userId=7
2025-08-15 03:25:10.141 [communication-service:29] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802, eventType=NOTIFICATION
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.login
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:25:10.141 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserLogin
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802
2025-08-15 03:25:10.141 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:25:10.141 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.event.CommunicationEventHandler - 监听到业务层用户登录事件: userId=7, eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.event.CommunicationEventHandler - 业务层用户登录事件同步成功: userId=7
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, result=null
2025-08-15 03:25:10.141 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=898d0a08-c3b2-462e-98bd-a6e28cc30802
2025-08-15 03:26:01.411 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 03:29:37.242 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 03:29:37.243 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@278e721e]]
2025-08-15 03:29:37.243 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 03:29:37.363 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:29:37.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:29:37.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:29:37.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:29:37.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:29:37.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:29:37.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:29:37.410 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:29:37.413 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:29:37.413 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:29:37.413 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:29:37.414 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 03:29:40.222 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 36188 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:29:40.222 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:29:40.223 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 03:29:40.480 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:29:40.480 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:29:40.486 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:29:40.620 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:29:40.620 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:29:40.621 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:29:40.656 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 03:29:40.988 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:29:41.008 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 03:29:41.012 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:29:41.012 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:29:41.032 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:29:41.032 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 790 ms
2025-08-15 03:29:41.129 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:29:41.148 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 03:29:41.148 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:29:41.149 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 03:29:41.171 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:29:41.207 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:29:41.224 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:29:41.225 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:29:41.241 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:29:41.243 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:29:41.370 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:29:41.523 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:29:41.526 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:29:41.538 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:29:41.538 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:29:41.538 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:29:41.539 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:29:41.539 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:29:41.540 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:29:41.540 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 03:29:41.546 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 03:29:41.547 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 03:29:41.547 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:29:41.552 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:29:41.557 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:29:41.557 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:29:41.557 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:29:41.559 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:29:41.559 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:29:41.559 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:29:41.571 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:29:41.572 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:29:41.573 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:29:41.573 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@39921410[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:41.574 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:29:41.574 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:29:41.669 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:29:41.669 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1d01fa0c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:41.671 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:29:41.671 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6fc03cf6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:41.672 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:29:41.672 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5fcff272[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:41.673 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:29:41.673 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3514df8d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:41.674 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:29:41.674 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2bf2523f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:41.677 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:29:41.677 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:29:41.683 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:29:41.691 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:29:41.691 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:29:41.691 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:29:41.691 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:29:41.691 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:29:41.691 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:29:41.691 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:29:41.693 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:29:41.693 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:29:41.693 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:29:41.694 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=1
2025-08-15 03:29:41.778 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:29:41.786 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:29:41.786 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:29:41.794 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:29:41.794 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:29:41.794 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:29:41.870 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:29:41.922 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:29:42.019 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 03:29:42.286 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:29:42.327 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@c62d08a, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@598b15ba, org.springframework.security.web.context.SecurityContextHolderFilter@1a0c384d, org.springframework.security.web.header.HeaderWriterFilter@453ff774, com.acme.im.common.security.jwt.JwtAuthenticationFilter@d190639, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@491d36ef, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2eb6a77f, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@58453967, org.springframework.security.web.session.SessionManagementFilter@5813046e, org.springframework.security.web.access.ExceptionTranslationFilter@7266f136, org.springframework.security.web.access.intercept.AuthorizationFilter@5a1e28ee]
2025-08-15 03:29:42.655 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 36209 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:29:42.655 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:29:42.655 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.profile, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.sync.user.status, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=CommunicationEventHandler.onBusinessUserLogout, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=CommunicationEventHandler.onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=CommunicationEventHandler.onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=CommunicationEventHandler.onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=CommunicationEventHandler.onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:29:42.676 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:29:42.678 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 22 个处理器
2025-08-15 03:29:42.679 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:29:42.680 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:29:42.681 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:29:42.682 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:29:42.682 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:29:42.700 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:29:42.700 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:29:42.702 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:29:42.702 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:29:42.712 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 03:29:42.712 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 03:29:42.712 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@77e467d9]]
2025-08-15 03:29:42.712 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 03:29:42.721 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.65 seconds (process running for 2.817)
2025-08-15 03:29:42.724 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:29:42.724 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:29:42.725 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:29:42.724 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 03:29:42.725 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:29:42.725 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:29:42.726 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 03:29:42.726 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 03:29:42.726 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 03:29:42.727 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 03:29:42.728 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.validate
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.validate, sid=security.token.validate
2025-08-15 03:29:42.729 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.refresh
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.refresh, sid=security.token.refresh
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.revoke
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.revoke, sid=security.token.revoke
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.auth.failed
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.auth.failed, sid=security.auth.failed
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.permission.denied
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.permission.denied, sid=security.permission.denied
2025-08-15 03:29:42.730 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 35/35 个主题
2025-08-15 03:29:42.730 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, security.token.validate, security.token.refresh, security.token.revoke, security.auth.failed, security.permission.denied]
2025-08-15 03:29:42.730 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:29:43.017 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:29:43.018 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:29:43.025 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 03:29:43.042 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:29:43.042 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:29:43.043 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:29:43.180 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:29:43.180 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:29:43.184 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:29:43.599 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 03:29:43.604 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:29:43.604 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:29:43.627 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:29:43.627 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 952 ms
2025-08-15 03:29:43.729 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:29:43.736 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 03:29:43.758 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:29:43.789 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:29:43.804 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:29:43.805 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:29:43.808 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 03:29:43.808 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 03:29:43.808 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 03:29:43.808 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 03:29:43.869 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:29:43.871 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:29:44.120 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:29:44.184 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:29:44.188 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:29:44.208 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:29:44.208 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:29:44.208 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:29:44.209 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:29:44.209 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:29:44.210 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:29:44.218 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 03:29:44.218 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 03:29:44.218 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:29:44.221 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:29:44.232 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:29:44.232 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:29:44.232 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:29:44.234 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:29:44.234 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:29:44.234 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:29:44.245 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:29:44.246 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:29:44.247 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:29:44.247 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1529d534[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:44.248 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:29:44.249 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:29:44.257 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:29:44.257 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@7207f3c2[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:44.259 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:29:44.259 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6afb240d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:44.260 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:29:44.260 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@799557c8[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:44.261 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:29:44.261 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2c6d442d[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:44.262 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:29:44.262 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@227c0cf7[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:29:44.268 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:29:44.268 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:29:44.273 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:29:44.366 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:29:44.376 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:29:44.376 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:29:44.384 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:29:44.384 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:29:44.384 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:29:44.450 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:29:44.500 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:29:44.844 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:29:44.881 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7fe1a856, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5a7e0d68, org.springframework.security.web.context.SecurityContextHolderFilter@6717f504, org.springframework.security.web.header.HeaderWriterFilter@53a4637c, com.acme.im.common.security.jwt.JwtAuthenticationFilter@7e1762e6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2e8488f4, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@d3effcb, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@11f8d64, org.springframework.security.web.session.SessionManagementFilter@2333333c, org.springframework.security.web.access.ExceptionTranslationFilter@28e2d3ed, org.springframework.security.web.access.intercept.AuthorizationFilter@12639753]
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 03:29:45.165 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:29:45.166 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 03:29:45.167 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 15 个处理器
2025-08-15 03:29:45.167 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:29:45.168 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:29:45.169 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:29:45.169 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:29:45.184 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:29:45.184 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:29:45.185 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:29:45.185 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:29:45.193 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 03:29:45.200 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.709 seconds (process running for 2.889)
2025-08-15 03:29:45.202 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:29:45.203 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:29:45.203 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 03:29:45.203 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:29:45.203 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 03:29:45.204 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 03:29:45.205 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:29:45.206 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:29:45.206 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 27/27 个主题
2025-08-15 03:29:45.206 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated]
2025-08-15 03:29:45.208 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:29:45.437 [RMI TCP Connection(1)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:29:45.437 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:29:45.438 [RMI TCP Connection(1)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:29:47.734 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:29:47.734 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:29:47.734 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:29:47.734 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:29:47.742 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:29:47.742 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:29:50.209 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:29:50.210 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:29:50.210 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:29:50.210 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:29:50.221 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:29:50.222 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:29:54.890 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:29:54.893 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:29:54.899 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:29:54.905 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:29:54.911 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:29:54.912 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:29:54.928 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:29:54.929 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:29:54.929 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:29:54.929 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:29:54.912178(LocalDateTime), 2025-08-15T03:29:54.912180(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:29:54.932 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:29:54.952 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:29:54.952 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:29:54.952 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:29:55.810 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:29:55.811 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 03:29:55.819 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:29:55.819 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:29:55.822 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:29:55.823 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:29:55.823 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:29:55.823 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:29:55.824 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:29:55.824 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 662 个Spring Bean
2025-08-15 03:29:55.824 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:29:55.824 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:29:55.824 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 687 个Spring Bean
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.sent, method=handleMessageSent, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.received, method=handleMessageReceived, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.recalled, method=handleMessageRecalled, priority=200, async=true
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.edited, method=handleMessageEdited, priority=200, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.read, method=handleMessageRead, priority=150, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.closed, method=handleConnectionClosed, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.heartbeat, method=handleHeartbeat, priority=300, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.sent, method=handlePushSent, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.delivered, method=handlePushDelivered, priority=100, async=false
2025-08-15 03:29:55.825 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 03:29:55.825 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.profile, method=handleUserProfileSync, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.sync.user.status, method=handleUserStatusSync, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=onBusinessUserLogin, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=onBusinessUserLogout, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.established, method=handleConnectionEstablished, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.*, method=handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:29:55.826 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:29:55.834 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 22 个处理器
2025-08-15 03:29:55.834 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [communication.connection.closed, business.conversation.created, communication.sync.user.status, business.friend.added, communication.message.sent, communication.connection.heartbeat, communication.push.sent, communication.*, communication.message.read, business.user.status.changed, communication.message.edited, business.user.profile.updated, communication.connection.established, business.user.logout, communication.message.recalled, communication.push.delivered, communication.message.received, business.user.login, communication.sync.user.profile, business.conversation.updated, security.token.validate, business.group.created]
2025-08-15 03:29:55.835 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 15 个处理器
2025-08-15 03:29:55.835 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.user.logout, common.auth.validate, business.user.login, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:29:55.836 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 15 个处理器
2025-08-15 03:29:55.836 [im-common:30] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"032556fb-f667-40f8-990d-0f4eb5e62101","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:29:54","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:29:54","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:29:55.836 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 22 个处理器
2025-08-15 03:29:55.837 [communication-service:34] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"032556fb-f667-40f8-990d-0f4eb5e62101","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:29:54","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:29:54","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:29:55.842 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=032556fb-f667-40f8-990d-0f4eb5e62101, eventType=NOTIFICATION, userId=7
2025-08-15 03:29:55.842 [im-common:30] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:29:55.842 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:29:55.842 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=032556fb-f667-40f8-990d-0f4eb5e62101, eventType=NOTIFICATION
2025-08-15 03:29:55.842 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.login
2025-08-15 03:29:55.842 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:29:55.842 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleUserLogin
2025-08-15 03:29:55.843 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleUserLogin, subject=business.user.login, eventId=032556fb-f667-40f8-990d-0f4eb5e62101
2025-08-15 03:29:55.843 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:29:55.843 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:29:55.844 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=032556fb-f667-40f8-990d-0f4eb5e62101, eventType=NOTIFICATION, userId=7
2025-08-15 03:29:55.844 [communication-service:34] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:29:55.844 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:29:55.844 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=032556fb-f667-40f8-990d-0f4eb5e62101, eventType=NOTIFICATION
2025-08-15 03:29:55.844 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.login
2025-08-15 03:29:55.845 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:29:55.845 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserLogin
2025-08-15 03:29:55.845 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, eventId=032556fb-f667-40f8-990d-0f4eb5e62101
2025-08-15 03:29:55.845 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:29:55.845 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:29:55.845 [communication-service:34] INFO  c.a.i.c.event.CommunicationEventHandler - 监听到业务层用户登录事件: userId=7, eventId=032556fb-f667-40f8-990d-0f4eb5e62101
2025-08-15 03:29:55.845 [communication-service:34] INFO  c.a.i.c.event.CommunicationEventHandler - 业务层用户登录事件同步成功: userId=7
2025-08-15 03:29:55.845 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, result=null
2025-08-15 03:29:55.845 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=032556fb-f667-40f8-990d-0f4eb5e62101
2025-08-15 03:29:55.843 [im-common:30] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: BusinessEventHandler.handleUserLogin, subject=business.user.login, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserOnlineEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserOnlineEvent are in unnamed module of loader 'app')
	at com.acme.im.business.module.common.event.handler.BusinessEventHandler.handleUserLogin(BusinessEventHandler.java:101)
	... 21 common frames omitted
2025-08-15 03:29:55.845 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=032556fb-f667-40f8-990d-0f4eb5e62101
2025-08-15 03:30:42.700 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 03:30:55.640 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:30:56.442 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:30:56.443 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:30:56.443 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:30:56.444 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:30:56.444 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:30:56.444 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:30:56.445 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:30:56.452 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:30:56.453 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:30:56.453 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:30:56.454 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=1
2025-08-15 03:30:57.799 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 36479 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:30:57.799 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:30:57.799 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 03:30:58.168 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:30:58.168 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:30:58.175 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:30:58.314 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:30:58.315 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:30:58.319 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:30:58.696 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 03:30:58.700 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:30:58.700 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:30:58.719 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:30:58.720 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 889 ms
2025-08-15 03:30:58.814 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:30:58.819 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 03:30:58.836 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:30:58.867 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:30:58.881 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:30:58.882 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:30:58.884 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 03:30:58.885 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 03:30:58.885 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 03:30:58.885 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 03:30:58.943 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:30:58.944 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:30:59.198 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:30:59.268 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:30:59.273 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:30:59.293 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:30:59.293 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:30:59.293 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:30:59.293 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:30:59.294 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:30:59.295 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:30:59.302 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 03:30:59.302 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 03:30:59.303 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:30:59.306 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:30:59.316 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:30:59.316 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:30:59.316 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:30:59.317 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:30:59.318 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:30:59.318 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:30:59.329 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:30:59.329 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:30:59.330 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:30:59.330 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@344cf00f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:30:59.331 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:30:59.332 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:30:59.340 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:30:59.340 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@20fdaf3e[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:30:59.341 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:30:59.341 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@272485a6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:30:59.342 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:30:59.342 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@40b678b3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:30:59.343 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:30:59.343 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5cf6ba1c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:30:59.344 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:30:59.344 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2fcad739[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:30:59.350 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:30:59.350 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:30:59.356 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:30:59.452 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:30:59.461 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:30:59.461 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:30:59.468 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:30:59.468 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:30:59.468 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:30:59.534 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:30:59.587 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:30:59.959 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:31:00.004 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@582ea857, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@650ee893, org.springframework.security.web.context.SecurityContextHolderFilter@6eec564c, org.springframework.security.web.header.HeaderWriterFilter@14404be2, com.acme.im.common.security.jwt.JwtAuthenticationFilter@16e5344c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@466fb9be, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2a0c76d6, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@13eb8ca, org.springframework.security.web.session.SessionManagementFilter@559d9517, org.springframework.security.web.access.ExceptionTranslationFilter@2e8488f4, org.springframework.security.web.access.intercept.AuthorizationFilter@204d101]
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:31:00.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 03:31:00.323 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 15 个处理器
2025-08-15 03:31:00.323 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:31:00.323 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:31:00.323 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:31:00.323 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:31:00.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:31:00.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:31:00.326 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:31:00.326 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:31:00.343 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:31:00.343 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:31:00.344 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:31:00.345 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:31:00.353 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 03:31:00.361 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.709 seconds (process running for 2.886)
2025-08-15 03:31:00.364 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 03:31:00.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 03:31:00.365 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 03:31:00.369 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 03:31:00.370 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:31:00.371 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:31:00.372 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 27/27 个主题
2025-08-15 03:31:00.372 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated]
2025-08-15 03:31:00.372 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:31:00.372 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:31:00.373 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 03:31:00.373 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:31:00.374 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:31:00.671 [RMI TCP Connection(3)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:31:00.671 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:31:00.672 [RMI TCP Connection(3)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:31:05.376 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:31:05.378 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:31:05.378 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:31:05.378 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:31:05.400 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:31:05.400 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:31:05.948 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:31:05.950 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:31:05.956 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:31:05.962 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:31:05.969 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:31:05.970 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:31:05.986 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:31:05.986 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:31:05.986 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:31:05.987 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), cccc(String), 0(Integer), 1(Integer), 1(Integer), 2025-08-15T03:31:05.970149(LocalDateTime), 2025-08-15T03:31:05.970152(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T02:51:25(LocalDateTime), 7(Long)
2025-08-15 03:31:05.989 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:31:06.009 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:31:06.009 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:31:06.010 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:31:06.884 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:31:06.885 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 03:31:06.894 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:31:06.896 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:31:06.898 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:31:06.898 [im-common:25] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:31:06.898 [communication-service:34] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"80ec074d-93ef-48c1-a955-81d8890fab6f","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:31:06","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:31:06","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:31:06.899 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=80ec074d-93ef-48c1-a955-81d8890fab6f, eventType=NOTIFICATION, userId=7
2025-08-15 03:31:06.899 [communication-service:34] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:31:06.899 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:31:06.899 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f, eventType=NOTIFICATION
2025-08-15 03:31:06.899 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.login
2025-08-15 03:31:06.899 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:31:06.900 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserLogin
2025-08-15 03:31:06.900 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f
2025-08-15 03:31:06.900 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:31:06.900 [communication-service:34] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:31:06.900 [communication-service:34] INFO  c.a.i.c.event.CommunicationEventHandler - 监听到业务层用户登录事件: userId=7, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f
2025-08-15 03:31:06.900 [communication-service:34] INFO  c.a.i.c.event.CommunicationEventHandler - 业务层用户登录事件同步成功: userId=7
2025-08-15 03:31:06.900 [communication-service:34] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, result=null
2025-08-15 03:31:06.900 [communication-service:34] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f
2025-08-15 03:31:06.900 [im-common:25] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:31:06.901 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:31:06.901 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 662 个Spring Bean
2025-08-15 03:31:06.902 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:31:06.903 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:31:06.903 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 03:31:06.903 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 03:31:06.903 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:31:06.904 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 03:31:06.914 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 15 个处理器
2025-08-15 03:31:06.914 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.user.logout, common.auth.validate, business.user.login, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:31:06.915 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 15 个处理器
2025-08-15 03:31:06.915 [im-common:25] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"80ec074d-93ef-48c1-a955-81d8890fab6f","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:31:06","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:31:06","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:31:06.919 [im-common:25] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=80ec074d-93ef-48c1-a955-81d8890fab6f, eventType=NOTIFICATION, userId=7
2025-08-15 03:31:06.919 [im-common:25] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:31:06.919 [im-common:25] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:31:06.919 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f, eventType=NOTIFICATION
2025-08-15 03:31:06.919 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.login
2025-08-15 03:31:06.919 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:31:06.919 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleUserLogin
2025-08-15 03:31:06.919 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleUserLogin, subject=business.user.login, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f
2025-08-15 03:31:06.919 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:31:06.920 [im-common:25] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:31:06.920 [im-common:25] INFO  c.a.i.b.m.c.event.handler.BusinessEventHandler - 处理用户登录事件: userId=7, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f
2025-08-15 03:31:06.920 [im-common:25] WARN  c.a.i.b.module.common.event.EventProcessorRegistry - 没有找到主题 business.user.login 的处理器: eventId=80ec074d-93ef-48c1-a955-81d8890fab6f
2025-08-15 03:31:06.920 [im-common:25] INFO  c.a.i.b.m.c.event.handler.BusinessEventHandler - 用户登录事件处理成功: userId=7
2025-08-15 03:31:06.920 [im-common:25] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: BusinessEventHandler.handleUserLogin, subject=business.user.login, result=null
2025-08-15 03:31:06.920 [im-common:25] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=80ec074d-93ef-48c1-a955-81d8890fab6f
2025-08-15 03:31:52.459 [http-nio-8080-exec-3] DEBUG c.acme.im.common.security.UserDetailsServiceImpl - 加载用户详情: cccc
2025-08-15 03:31:52.459 [http-nio-8080-exec-3] WARN  c.acme.im.common.security.UserDetailsServiceImpl - 使用默认用户加载器，生产环境请注入真实的用户加载器
2025-08-15 03:31:52.460 [http-nio-8080-exec-3] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - JWT认证成功: cccc
2025-08-15 03:31:52.463 [http-nio-8080-exec-3] DEBUG c.a.i.b.module.user.controller.UserController - 从JWT获取用户名: cccc
2025-08-15 03:31:52.464 [http-nio-8080-exec-3] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:31:52.464 [http-nio-8080-exec-3] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:31:52.466 [http-nio-8080-exec-3] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:31:52.467 [http-nio-8080-exec-3] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==>  Preparing: SELECT id,username,email,phone,nickname,avatar_url,signature,gender,birthday,region,status,online_status,last_login_at,last_active_at,password_hash,salt,two_factor_enabled,two_factor_secret,created_at,updated_at FROM users WHERE id=?
2025-08-15 03:31:52.467 [http-nio-8080-exec-3] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==> Parameters: 7(Long)
2025-08-15 03:31:52.468 [http-nio-8080-exec-3] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - <==      Total: 1
2025-08-15 03:32:26.168 [http-nio-8080-exec-6] DEBUG c.acme.im.common.security.UserDetailsServiceImpl - 加载用户详情: cccc
2025-08-15 03:32:26.168 [http-nio-8080-exec-6] WARN  c.acme.im.common.security.UserDetailsServiceImpl - 使用默认用户加载器，生产环境请注入真实的用户加载器
2025-08-15 03:32:26.168 [http-nio-8080-exec-6] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - JWT认证成功: cccc
2025-08-15 03:32:26.174 [http-nio-8080-exec-6] DEBUG c.a.i.b.module.user.controller.UserController - 从JWT获取用户名: cccc
2025-08-15 03:32:26.175 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:32:26.175 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:32:26.176 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:32:26.177 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 更新用户信息: userId=7
2025-08-15 03:32:26.177 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==>  Preparing: SELECT id,username,email,phone,nickname,avatar_url,signature,gender,birthday,region,status,online_status,last_login_at,last_active_at,password_hash,salt,two_factor_enabled,two_factor_secret,created_at,updated_at FROM users WHERE id=?
2025-08-15 03:32:26.177 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==> Parameters: 7(Long)
2025-08-15 03:32:26.178 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - <==      Total: 1
2025-08-15 03:32:26.179 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:32:26.179 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:32:26.179 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, signature=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:32:26.180 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), 测试用户(String), 这是一个测试签名(String), 1(Integer), 1(Integer), 1(Integer), 2025-08-15T03:31:06(LocalDateTime), 2025-08-15T03:31:06(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T03:32:26.178691(LocalDateTime), 7(Long)
2025-08-15 03:32:26.182 [http-nio-8080-exec-6] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:32:26.182 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户信息更新成功: userId=7
2025-08-15 03:32:26.183 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.profile.updated, queueSize=1
2025-08-15 03:32:26.884 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:32:26.885 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=2, total=10
2025-08-15 03:32:26.886 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.profile.updated, useJetStream=false
2025-08-15 03:32:26.888 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.profile.updated, replyTo=null, dataSize=701 bytes
2025-08-15 03:32:26.888 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.profile.updated, replyTo=null, dataSize=701 bytes
2025-08-15 03:32:26.888 [im-common:27] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"9b70fa65-33a9-43ab-9c02-e527aa00143b","subject":"business.user.profile.updated","eventType":"NOTIFICATION","status":"PENDING","priority":"MEDIUM","sourceService":"business-service","sourceInstance":"default","targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":null,"ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:32:26","additionalData":{"newValue":"测试用户","field":"nickname","oldValue":"cccc"},"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:32:26","expiresAt":null,"retryCount":0,"maxRetries":3,"errorMessage":null,"errorCode":null}
2025-08-15 03:32:26.889 [communication-service:36] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"9b70fa65-33a9-43ab-9c02-e527aa00143b","subject":"business.user.profile.updated","eventType":"NOTIFICATION","status":"PENDING","priority":"MEDIUM","sourceService":"business-service","sourceInstance":"default","targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":null,"ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:32:26","additionalData":{"newValue":"测试用户","field":"nickname","oldValue":"cccc"},"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:32:26","expiresAt":null,"retryCount":0,"maxRetries":3,"errorMessage":null,"errorCode":null}
2025-08-15 03:32:26.889 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=multi.device.user.profile.sync, queueSize=1
2025-08-15 03:32:26.889 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b, eventType=NOTIFICATION, userId=7
2025-08-15 03:32:26.890 [im-common:27] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.profile.updated
2025-08-15 03:32:26.891 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:32:26.891 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b, eventType=NOTIFICATION, userId=7
2025-08-15 03:32:26.891 [communication-service:36] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.profile.updated
2025-08-15 03:32:26.891 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:32:26.891 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.profile.updated, eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b, eventType=NOTIFICATION
2025-08-15 03:32:26.891 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.profile.updated, eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b, eventType=NOTIFICATION
2025-08-15 03:32:26.891 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.profile.updated
2025-08-15 03:32:26.891 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:32:26.891 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserProfileUpdated
2025-08-15 03:32:26.891 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserProfileUpdated, subject=business.user.profile.updated, eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b
2025-08-15 03:32:26.891 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:32:26.891 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.profile.updated
2025-08-15 03:32:26.891 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:32:26.891 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:32:26.891 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleUserProfileUpdated
2025-08-15 03:32:26.891 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleUserProfileUpdated, subject=business.user.profile.updated, eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b
2025-08-15 03:32:26.891 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:32:26.891 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:32:26.892 [im-common:27] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: BusinessEventHandler.handleUserProfileUpdated, subject=business.user.profile.updated, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent are in unnamed module of loader 'app')
	at com.acme.im.business.module.common.event.handler.BusinessEventHandler.handleUserProfileUpdated(BusinessEventHandler.java:59)
	... 21 common frames omitted
2025-08-15 03:32:26.892 [communication-service:36] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: CommunicationEventHandler.onBusinessUserProfileUpdated, subject=business.user.profile.updated, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent are in unnamed module of loader 'app')
	at com.acme.im.communication.event.CommunicationEventHandler.onBusinessUserProfileUpdated(CommunicationEventHandler.java:387)
	... 21 common frames omitted
2025-08-15 03:32:26.898 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.profile.updated, eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b
2025-08-15 03:32:26.898 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.profile.updated, eventId=9b70fa65-33a9-43ab-9c02-e527aa00143b
2025-08-15 03:32:27.885 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:32:27.886 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=3, total=10
2025-08-15 03:32:27.887 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=multi.device.user.profile.sync, useJetStream=false
2025-08-15 03:32:27.887 [http-nio-8080-exec-6] INFO  c.a.i.b.m.c.e.publisher.MultiDeviceSyncPublisher - 发布用户信息同步事件: userId=7, field=nickname, sourceDeviceId=null
2025-08-15 03:32:27.887 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户资料更新事件: userId=7, field=nickname, oldValue=cccc, newValue=测试用户
2025-08-15 03:32:27.887 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.profile.updated, queueSize=1
2025-08-15 03:32:28.888 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:32:28.888 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=4, total=10
2025-08-15 03:32:28.889 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.profile.updated, useJetStream=false
2025-08-15 03:32:28.889 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=multi.device.user.profile.sync, queueSize=1
2025-08-15 03:32:28.893 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.profile.updated, replyTo=null, dataSize=712 bytes
2025-08-15 03:32:28.893 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.profile.updated, replyTo=null, dataSize=712 bytes
2025-08-15 03:32:28.893 [im-common:27] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"6407fef9-3580-4bc5-9983-f3f5b5eb8c2c","subject":"business.user.profile.updated","eventType":"NOTIFICATION","status":"PENDING","priority":"MEDIUM","sourceService":"business-service","sourceInstance":"default","targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":null,"ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:32:27","additionalData":{"newValue":"这是一个测试签名","field":"signature","oldValue":null},"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:32:27","expiresAt":null,"retryCount":0,"maxRetries":3,"errorMessage":null,"errorCode":null}
2025-08-15 03:32:28.893 [communication-service:36] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"6407fef9-3580-4bc5-9983-f3f5b5eb8c2c","subject":"business.user.profile.updated","eventType":"NOTIFICATION","status":"PENDING","priority":"MEDIUM","sourceService":"business-service","sourceInstance":"default","targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":null,"ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:32:27","additionalData":{"newValue":"这是一个测试签名","field":"signature","oldValue":null},"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:32:27","expiresAt":null,"retryCount":0,"maxRetries":3,"errorMessage":null,"errorCode":null}
2025-08-15 03:32:28.894 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c, eventType=NOTIFICATION, userId=7
2025-08-15 03:32:28.894 [im-common:27] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.profile.updated
2025-08-15 03:32:28.894 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:32:28.894 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.profile.updated, eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c, eventType=NOTIFICATION
2025-08-15 03:32:28.894 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.profile.updated
2025-08-15 03:32:28.894 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:32:28.894 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c, eventType=NOTIFICATION, userId=7
2025-08-15 03:32:28.895 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleUserProfileUpdated
2025-08-15 03:32:28.895 [communication-service:36] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.profile.updated
2025-08-15 03:32:28.895 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:32:28.895 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleUserProfileUpdated, subject=business.user.profile.updated, eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c
2025-08-15 03:32:28.895 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.profile.updated, eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c, eventType=NOTIFICATION
2025-08-15 03:32:28.895 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:32:28.895 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.profile.updated
2025-08-15 03:32:28.895 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:32:28.896 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:32:28.896 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserProfileUpdated
2025-08-15 03:32:28.896 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserProfileUpdated, subject=business.user.profile.updated, eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c
2025-08-15 03:32:28.896 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:32:28.896 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:32:28.896 [im-common:27] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: BusinessEventHandler.handleUserProfileUpdated, subject=business.user.profile.updated, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent are in unnamed module of loader 'app')
	at com.acme.im.business.module.common.event.handler.BusinessEventHandler.handleUserProfileUpdated(BusinessEventHandler.java:59)
	... 21 common frames omitted
2025-08-15 03:32:28.897 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.profile.updated, eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c
2025-08-15 03:32:28.896 [communication-service:36] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: CommunicationEventHandler.onBusinessUserProfileUpdated, subject=business.user.profile.updated, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent are in unnamed module of loader 'app')
	at com.acme.im.communication.event.CommunicationEventHandler.onBusinessUserProfileUpdated(CommunicationEventHandler.java:387)
	... 21 common frames omitted
2025-08-15 03:32:28.897 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.profile.updated, eventId=6407fef9-3580-4bc5-9983-f3f5b5eb8c2c
2025-08-15 03:32:29.889 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:32:29.890 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=5, total=10
2025-08-15 03:32:29.892 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=multi.device.user.profile.sync, useJetStream=false
2025-08-15 03:32:29.894 [http-nio-8080-exec-6] INFO  c.a.i.b.m.c.e.publisher.MultiDeviceSyncPublisher - 发布用户信息同步事件: userId=7, field=signature, sourceDeviceId=null
2025-08-15 03:32:29.895 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户资料更新事件: userId=7, field=signature, oldValue=null, newValue=这是一个测试签名
2025-08-15 03:32:29.899 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.profile.updated, queueSize=1
2025-08-15 03:32:30.887 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:32:30.888 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=6, total=10
2025-08-15 03:32:30.889 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.profile.updated, useJetStream=false
2025-08-15 03:32:30.889 [http-nio-8080-exec-6] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=multi.device.user.profile.sync, queueSize=1
2025-08-15 03:32:30.891 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.profile.updated, replyTo=null, dataSize=685 bytes
2025-08-15 03:32:30.891 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.profile.updated, replyTo=null, dataSize=685 bytes
2025-08-15 03:32:30.892 [im-common:27] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"6f903a5e-c4e5-4922-b8b3-dbdfadb1317a","subject":"business.user.profile.updated","eventType":"NOTIFICATION","status":"PENDING","priority":"MEDIUM","sourceService":"business-service","sourceInstance":"default","targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":null,"ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:32:29","additionalData":{"newValue":"1","field":"gender","oldValue":"0"},"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:32:29","expiresAt":null,"retryCount":0,"maxRetries":3,"errorMessage":null,"errorCode":null}
2025-08-15 03:32:30.892 [communication-service:36] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"6f903a5e-c4e5-4922-b8b3-dbdfadb1317a","subject":"business.user.profile.updated","eventType":"NOTIFICATION","status":"PENDING","priority":"MEDIUM","sourceService":"business-service","sourceInstance":"default","targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":null,"ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:32:29","additionalData":{"newValue":"1","field":"gender","oldValue":"0"},"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:32:29","expiresAt":null,"retryCount":0,"maxRetries":3,"errorMessage":null,"errorCode":null}
2025-08-15 03:32:30.892 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a, eventType=NOTIFICATION, userId=7
2025-08-15 03:32:30.892 [im-common:27] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.profile.updated
2025-08-15 03:32:30.892 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:32:30.892 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.profile.updated, eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a, eventType=NOTIFICATION
2025-08-15 03:32:30.892 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a, eventType=NOTIFICATION, userId=7
2025-08-15 03:32:30.893 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.profile.updated
2025-08-15 03:32:30.893 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:32:30.893 [communication-service:36] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.profile.updated
2025-08-15 03:32:30.893 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleUserProfileUpdated
2025-08-15 03:32:30.893 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:32:30.893 [im-common:27] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleUserProfileUpdated, subject=business.user.profile.updated, eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a
2025-08-15 03:32:30.893 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:32:30.893 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.profile.updated, eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a, eventType=NOTIFICATION
2025-08-15 03:32:30.893 [im-common:27] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:32:30.893 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.profile.updated
2025-08-15 03:32:30.893 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:32:30.893 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserProfileUpdated
2025-08-15 03:32:30.893 [communication-service:36] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserProfileUpdated, subject=business.user.profile.updated, eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a
2025-08-15 03:32:30.893 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:32:30.893 [communication-service:36] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:32:30.893 [im-common:27] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: BusinessEventHandler.handleUserProfileUpdated, subject=business.user.profile.updated, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent are in unnamed module of loader 'app')
	at com.acme.im.business.module.common.event.handler.BusinessEventHandler.handleUserProfileUpdated(BusinessEventHandler.java:59)
	... 21 common frames omitted
2025-08-15 03:32:30.894 [im-common:27] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.profile.updated, eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a
2025-08-15 03:32:30.893 [communication-service:36] ERROR c.a.i.c.i.nats.handler.EventHandlerRegistry - ❌ 事件处理器执行失败: CommunicationEventHandler.onBusinessUserProfileUpdated, subject=business.user.profile.updated, error=null
java.lang.reflect.InvocationTargetException: null
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.executeHandler(EventHandlerRegistry.java:263)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry.handleEvent(EventHandlerRegistry.java:191)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716)
	at com.acme.im.common.infrastructure.nats.handler.EventHandlerRegistry$$SpringCGLIB$$0.handleEvent(<generated>)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber.lambda$subscribeWithAutoRouting$1(EventSubscriber.java:147)
	at com.acme.im.common.infrastructure.nats.subscriber.EventSubscriber$1.onMessage(EventSubscriber.java:72)
	at io.nats.client.impl.NatsDispatcher.run(NatsDispatcher.java:91)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.ClassCastException: class com.google.gson.internal.LinkedTreeMap cannot be cast to class com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent (com.google.gson.internal.LinkedTreeMap and com.acme.im.common.infrastructure.nats.dto.UserEvents$UserProfileUpdatedEvent are in unnamed module of loader 'app')
	at com.acme.im.communication.event.CommunicationEventHandler.onBusinessUserProfileUpdated(CommunicationEventHandler.java:387)
	... 21 common frames omitted
2025-08-15 03:32:30.894 [communication-service:36] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.profile.updated, eventId=6f903a5e-c4e5-4922-b8b3-dbdfadb1317a
2025-08-15 03:32:31.885 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:32:31.885 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=7, total=10
2025-08-15 03:32:31.886 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=multi.device.user.profile.sync, useJetStream=false
2025-08-15 03:32:31.886 [http-nio-8080-exec-6] INFO  c.a.i.b.m.c.e.publisher.MultiDeviceSyncPublisher - 发布用户信息同步事件: userId=7, field=gender, sourceDeviceId=null
2025-08-15 03:32:31.886 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户资料更新事件: userId=7, field=gender, oldValue=0, newValue=1
2025-08-15 03:32:31.888 [http-nio-8080-exec-6] INFO  c.a.i.b.module.user.controller.UserController - 用户信息更新成功: userId=7
2025-08-15 03:32:46.473 [http-nio-8080-exec-8] DEBUG c.acme.im.common.security.UserDetailsServiceImpl - 加载用户详情: cccc
2025-08-15 03:32:46.473 [http-nio-8080-exec-8] WARN  c.acme.im.common.security.UserDetailsServiceImpl - 使用默认用户加载器，生产环境请注入真实的用户加载器
2025-08-15 03:32:46.473 [http-nio-8080-exec-8] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - JWT认证成功: cccc
2025-08-15 03:32:46.475 [http-nio-8080-exec-8] DEBUG c.a.i.b.module.user.controller.UserController - 从JWT获取用户名: cccc
2025-08-15 03:32:46.476 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:32:46.476 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:32:46.478 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:32:46.479 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==>  Preparing: SELECT id,username,email,phone,nickname,avatar_url,signature,gender,birthday,region,status,online_status,last_login_at,last_active_at,password_hash,salt,two_factor_enabled,two_factor_secret,created_at,updated_at FROM users WHERE id=?
2025-08-15 03:32:46.479 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==> Parameters: 7(Long)
2025-08-15 03:32:46.481 [http-nio-8080-exec-8] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - <==      Total: 1
2025-08-15 03:34:41.577 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:34:42.734 [cache-4] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:34:42.734 [cache-3] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:35:41.578 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:35:59.337 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:36:59.339 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:39:08.028 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:39:08.127 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:39:08.128 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:39:08.128 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:39:08.128 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:39:08.129 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:39:08.129 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:39:08.129 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:39:08.135 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:39:08.135 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:39:08.135 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:39:08.136 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=7
2025-08-15 03:39:10.113 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 39680 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:39:10.114 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:39:10.114 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 03:39:10.384 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:10.384 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:10.390 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:10.520 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:10.520 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:10.525 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:10.885 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 03:39:10.886 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@77e467d9]]
2025-08-15 03:39:10.886 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 03:39:10.904 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 03:39:10.908 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:39:10.908 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:39:10.929 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:39:10.929 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 797 ms
2025-08-15 03:39:11.000 [main] ERROR o.s.boot.web.embedded.tomcat.TomcatStarter - Error starting Tomcat context. Exception: org.springframework.beans.factory.BeanCreationException. Message: Error creating bean with name 'jwtAuthenticationFilter': Resolution of declared constructors on bean Class [com.acme.im.common.security.jwt.JwtAuthenticationFilter] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
2025-08-15 03:39:11.002 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 03:39:11.009 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 03:39:11.012 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2025-08-15 03:39:11.019 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 03:39:11.023 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:165)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:619)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.business.BusinessServiceApplication.main(BusinessServiceApplication.java:17)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:145)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:105)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:499)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:218)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:188)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:162)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jwtAuthenticationFilter': Resolution of declared constructors on bean Class [com.acme.im.common.security.jwt.JwtAuthenticationFilter] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:383)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1209)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:205)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:210)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:173)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:168)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:153)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:86)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:266)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:240)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4414)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:415)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:874)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:437)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:126)
	... 13 common frames omitted
Caused by: java.lang.NoClassDefFoundError: JwtTokenProvider
	at java.base/java.lang.Class.getDeclaredConstructors0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredConstructors(Class.java:3373)
	at java.base/java.lang.Class.getDeclaredConstructors(Class.java:2555)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:378)
	... 53 common frames omitted
Caused by: java.lang.ClassNotFoundException: JwtTokenProvider
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)
	... 57 common frames omitted
2025-08-15 03:39:11.703 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 03:39:11.704 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 03:39:11.704 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 03:39:11.704 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 03:39:11.704 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 03:39:11.705 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 03:39:11.705 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 03:39:11.711 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 03:39:11.711 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 03:39:11.711 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 03:39:11.713 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 03:39:13.263 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 39701 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:39:13.264 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:39:13.264 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 03:39:13.517 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:13.517 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:13.523 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:13.654 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:13.654 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:13.656 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:13.688 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 03:39:14.027 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 03:39:14.030 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:39:14.031 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:39:14.051 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:39:14.051 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 770 ms
2025-08-15 03:39:14.119 [main] ERROR o.s.boot.web.embedded.tomcat.TomcatStarter - Error starting Tomcat context. Exception: org.springframework.beans.factory.BeanCreationException. Message: Error creating bean with name 'jwtAuthenticationFilter': Resolution of declared constructors on bean Class [com.acme.im.common.security.jwt.JwtAuthenticationFilter] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
2025-08-15 03:39:14.129 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 03:39:14.132 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2025-08-15 03:39:14.139 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 03:39:14.144 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:165)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:619)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:145)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:105)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:499)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:218)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:188)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:162)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jwtAuthenticationFilter': Resolution of declared constructors on bean Class [com.acme.im.common.security.jwt.JwtAuthenticationFilter] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:383)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1209)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:205)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:210)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:173)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:168)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:153)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:86)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:266)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:240)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4414)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:415)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:874)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:437)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:126)
	... 13 common frames omitted
Caused by: java.lang.NoClassDefFoundError: JwtTokenProvider
	at java.base/java.lang.Class.getDeclaredConstructors0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredConstructors(Class.java:3373)
	at java.base/java.lang.Class.getDeclaredConstructors(Class.java:2555)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:378)
	... 53 common frames omitted
Caused by: java.lang.ClassNotFoundException: JwtTokenProvider
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)
	... 57 common frames omitted
2025-08-15 03:39:26.581 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 39789 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:39:26.582 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:39:26.582 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 03:39:26.847 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:26.848 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:26.854 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:26.996 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:26.996 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:26.997 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:27.033 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 03:39:27.389 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 03:39:27.393 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:39:27.393 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:39:27.413 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:39:27.414 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 814 ms
2025-08-15 03:39:27.509 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:39:27.525 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:39:27.526 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 03:39:27.527 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 03:39:27.544 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:39:27.578 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:39:27.592 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:39:27.592 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:39:27.605 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:39:27.607 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:39:27.729 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:39:27.879 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:39:27.883 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:39:27.896 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:39:27.896 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:39:27.896 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:39:27.897 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:39:27.897 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:39:27.898 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:39:27.899 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 03:39:27.906 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 03:39:27.906 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 03:39:27.906 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:39:27.912 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:39:27.917 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:39:27.917 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:39:27.917 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:39:27.919 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:39:27.919 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:39:27.919 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:39:27.937 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:39:27.937 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:39:27.939 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:39:27.939 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1c15a6aa[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:27.940 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:39:27.941 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:39:28.034 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:39:28.034 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@7bc3c59f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:28.036 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:39:28.036 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1df8e685[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:28.037 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:39:28.037 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@ab3b54[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:28.038 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:39:28.038 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@6fc03cf6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:28.039 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:39:28.039 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5fcff272[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:28.041 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:39:28.041 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:39:28.047 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:39:28.146 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:39:28.156 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:39:28.156 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:39:28.164 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:39:28.164 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:39:28.164 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:39:28.234 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:39:28.286 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:39:28.382 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 03:39:28.624 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:39:28.659 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6245303e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5a1e28ee, org.springframework.security.web.context.SecurityContextHolderFilter@17f43f4a, org.springframework.security.web.header.HeaderWriterFilter@7266f136, org.springframework.web.filter.CorsFilter@2b208574, com.acme.im.common.security.jwt.JwtAuthenticationFilter@515c732d, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4cdd0f2f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@8a0447e, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3294b641, org.springframework.security.web.session.SessionManagementFilter@5d8319a7, org.springframework.security.web.access.ExceptionTranslationFilter@6212dc7d, org.springframework.security.web.access.intercept.AuthorizationFilter@435b944c]
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.user.profile.sync, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.user.status.sync, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=CommunicationEventHandler.onBusinessUserLogout, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=CommunicationEventHandler.onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=CommunicationEventHandler.onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:39:28.949 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 03:39:28.950 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:39:28.950 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:39:28.950 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=CommunicationEventHandler.onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:39:28.950 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=CommunicationEventHandler.onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:39:28.950 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:39:28.950 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:39:28.952 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 22 个处理器
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:39:28.952 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:39:28.953 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:39:28.954 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:39:28.954 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:39:28.970 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:39:28.970 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:39:28.971 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:39:28.971 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 03:39:28.979 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 03:39:28.979 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 03:39:28.979 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@60d1b2a7]]
2025-08-15 03:39:28.980 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 03:39:28.987 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.558 seconds (process running for 2.723)
2025-08-15 03:39:28.990 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:39:28.990 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 03:39:28.990 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 03:39:28.991 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 03:39:28.992 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:39:28.993 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.validate
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.validate, sid=security.token.validate
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.refresh
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.refresh, sid=security.token.refresh
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.revoke
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.revoke, sid=security.token.revoke
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.auth.failed
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.auth.failed, sid=security.auth.failed
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.permission.denied
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.permission.denied, sid=security.permission.denied
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 35/35 个主题
2025-08-15 03:39:28.994 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, security.token.validate, security.token.refresh, security.token.revoke, security.auth.failed, security.permission.denied]
2025-08-15 03:39:28.994 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:39:28.994 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:39:28.995 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 03:39:28.995 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:39:28.995 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:39:29.393 [RMI TCP Connection(2)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:39:29.393 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:39:29.394 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:39:31.672 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 39807 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 03:39:31.673 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 03:39:31.673 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 03:39:31.944 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:31.945 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:31.951 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:32.084 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 03:39:32.084 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 03:39:32.089 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 03:39:32.472 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 03:39:32.476 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 03:39:32.476 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 03:39:32.494 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 03:39:32.495 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 805 ms
2025-08-15 03:39:32.592 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 03:39:32.598 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 03:39:32.614 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 03:39:32.645 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 03:39:32.658 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 03:39:32.659 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 03:39:32.661 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 03:39:32.662 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 03:39:32.662 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 03:39:32.662 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 03:39:32.720 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:39:32.721 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 03:39:32.967 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 03:39:33.035 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 03:39:33.039 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 03:39:33.056 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 03:39:33.057 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 03:39:33.057 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 03:39:33.057 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 03:39:33.057 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 03:39:33.058 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 03:39:33.066 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 03:39:33.066 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 03:39:33.067 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 03:39:33.070 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 03:39:33.080 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 03:39:33.080 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 03:39:33.080 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 03:39:33.082 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 03:39:33.082 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 03:39:33.082 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 03:39:33.097 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 03:39:33.098 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 03:39:33.099 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 03:39:33.099 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5d1eb214[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:33.100 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 03:39:33.100 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 03:39:33.109 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 03:39:33.109 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@4c1fed69[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:33.110 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 03:39:33.110 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@38ae69f7[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:33.111 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 03:39:33.111 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@623d222[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:33.112 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 03:39:33.112 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@4b3eaf39[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:33.113 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 03:39:33.113 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@154208f2[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 03:39:33.115 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 03:39:33.115 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 03:39:33.121 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 03:39:33.220 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 03:39:33.229 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 03:39:33.229 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 03:39:33.237 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 03:39:33.237 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 03:39:33.237 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 03:39:33.304 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 03:39:33.353 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 03:39:33.714 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 03:39:33.752 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@704205ef, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@18ee9a8f, org.springframework.security.web.context.SecurityContextHolderFilter@d69fd7a, org.springframework.security.web.header.HeaderWriterFilter@1a02063a, org.springframework.web.filter.CorsFilter@61aaec51, com.acme.im.common.security.jwt.JwtAuthenticationFilter@5d5ae6aa, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5dd47c88, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@11f8d64, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@69dc0dd1, org.springframework.security.web.session.SessionManagementFilter@39aa595, org.springframework.security.web.access.ExceptionTranslationFilter@4057babc, org.springframework.security.web.access.intercept.AuthorizationFilter@56ed6e17]
2025-08-15 03:39:33.996 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:39:33.996 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:39:33.996 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:39:33.996 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:39:34.001 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:39:34.001 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 03:39:34.042 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 03:39:34.043 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 03:39:34.043 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 03:39:34.043 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:39:34.043 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 03:39:34.044 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 15 个处理器
2025-08-15 03:39:34.044 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 03:39:34.045 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 03:39:34.046 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 03:39:34.046 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 03:39:34.061 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:39:34.061 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:39:34.063 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:39:34.063 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 03:39:34.073 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 03:39:34.080 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.559 seconds (process running for 2.718)
2025-08-15 03:39:34.082 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 03:39:34.083 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 03:39:34.083 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 03:39:34.084 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 03:39:34.084 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 03:39:34.084 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 03:39:34.085 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 03:39:34.086 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 03:39:34.086 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 27/27 个主题
2025-08-15 03:39:34.086 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated]
2025-08-15 03:39:34.087 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 03:39:34.492 [RMI TCP Connection(4)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 03:39:34.492 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 03:39:34.493 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 03:39:39.092 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 03:39:39.093 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:39:39.093 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 03:39:39.093 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 03:39:39.104 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 03:39:39.104 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 03:39:42.022 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 收到用户登录请求: username=cccc
2025-08-15 03:39:42.025 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 开始用户登录: username=cccc, deviceId=test_device_001
2025-08-15 03:39:42.031 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:39:42.037 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:39:42.044 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:39:42.045 [http-nio-8080-exec-2] DEBUG c.a.im.common.security.encryption.EncryptionUtils - 哈希计算成功: algorithm=SHA-256, dataLength=30, hashLength=44
2025-08-15 03:39:42.061 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 开始执行更新填充
2025-08-15 03:39:42.062 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.database.handler.MyMetaObjectHandler - 更新填充完成
2025-08-15 03:39:42.062 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==>  Preparing: UPDATE users SET username=?, nickname=?, signature=?, gender=?, status=?, online_status=?, last_login_at=?, last_active_at=?, password_hash=?, salt=?, two_factor_enabled=?, created_at=?, updated_at=? WHERE id=?
2025-08-15 03:39:42.062 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - ==> Parameters: cccc(String), 测试用户(String), 这是一个测试签名(String), 1(Integer), 1(Integer), 1(Integer), 2025-08-15T03:39:42.045183(LocalDateTime), 2025-08-15T03:39:42.045185(LocalDateTime), ezEBc2pzW+awAkvDrakLuvsZz7RssWAX2+4z25g12o0=(String), LbMgdW7XFD8diaI7raVpUg==(String), false(Boolean), 2025-08-15T02:51:25(LocalDateTime), 2025-08-15T03:32:26(LocalDateTime), 7(Long)
2025-08-15 03:39:42.064 [http-nio-8080-exec-2] DEBUG c.a.i.b.m.u.repository.UserRepository.updateById - <==    Updates: 1
2025-08-15 03:39:42.084 [http-nio-8080-exec-2] DEBUG c.a.i.b.module.user.service.impl.UserServiceImpl - JWT访问令牌生成成功: username=cccc, deviceId=test_device_001
2025-08-15 03:39:42.084 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.service.impl.UserServiceImpl - 用户登录成功: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:39:42.085 [http-nio-8080-exec-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=business.user.login, queueSize=1
2025-08-15 03:39:42.661 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 03:39:42.661 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 03:39:42.663 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=business.user.login, useJetStream=false
2025-08-15 03:39:42.663 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.event.UserEventPublisher - 发布用户登录事件: userId=7, username=cccc, deviceId=test_device_001
2025-08-15 03:39:42.665 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:39:42.665 [http-nio-8080-exec-2] INFO  c.a.i.b.module.user.controller.UserController - 用户登录成功: username=cccc, deviceId=test_device_001
2025-08-15 03:39:42.665 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 📨 收到NATS消息: subject=business.user.login, replyTo=null, dataSize=630 bytes
2025-08-15 03:39:42.666 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:39:42.666 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:39:42.666 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 662 个Spring Bean
2025-08-15 03:39:42.666 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔄 初始化EventHandlerRegistry...
2025-08-15 03:39:42.666 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始发现事件处理器...
2025-08-15 03:39:42.666 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📋 发现 687 个Spring Bean
2025-08-15 03:39:42.666 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.sent, method=handleMessageSent, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.received, method=handleMessageReceived, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.recalled, method=handleMessageRecalled, priority=200, async=true
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.edited, method=handleMessageEdited, priority=200, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.message.read, method=handleMessageRead, priority=150, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.closed, method=handleConnectionClosed, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.heartbeat, method=handleHeartbeat, priority=300, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.sent, method=handlePushSent, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.push.delivered, method=handlePushDelivered, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.user.profile.sync, method=handleUserProfileSync, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.user.status.sync, method=handleUserStatusSync, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=onBusinessUserLogin, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=onBusinessUserLogout, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=onBusinessGroupCreated, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=onBusinessFriendAdded, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.connection.established, method=handleConnectionEstablished, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=onBusinessConversationCreated, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=onBusinessConversationUpdated, priority=100, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=communication.*, method=handleAllCommunicationEvents, priority=999, async=false
2025-08-15 03:39:42.667 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationResponse, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.profile.updated, method=handleUserProfileUpdated, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.status.changed, method=handleUserStatusChanged, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.login, method=handleUserLogin, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.user.logout, method=handleUserLogout, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.created, method=handleConversationCreated, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.conversation.updated, method=handleConversationUpdated, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.created, method=handleGroupCreated, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.group.member.joined, method=handleGroupMemberJoined, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.request.sent, method=handleFriendRequestSent, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=business.friend.added, method=handleFriendAdded, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.chat, method=handleChatMessage, priority=50, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.message.control, method=handleControlMessage, priority=60, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=common.auth.validate, method=handleAuthValidation, priority=10, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=security.token.validate, method=handleTokenValidationRequest, priority=100, async=false
2025-08-15 03:39:42.667 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 注册事件处理器: subject=websocket.*, method=handleWebSocketEvents, priority=100, async=false
2025-08-15 03:39:42.669 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 22 个处理器
2025-08-15 03:39:42.670 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [communication.connection.closed, common.user.status.sync, business.conversation.created, business.friend.added, communication.message.sent, communication.connection.heartbeat, communication.push.sent, communication.*, communication.message.read, business.user.status.changed, communication.message.edited, business.user.profile.updated, common.user.profile.sync, communication.connection.established, business.user.logout, communication.message.recalled, communication.push.delivered, communication.message.received, business.user.login, business.conversation.updated, security.token.validate, business.group.created]
2025-08-15 03:39:42.670 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器发现完成，共发现 15 个处理器
2025-08-15 03:39:42.670 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📊 已注册的主题: [business.conversation.created, business.friend.added, business.friend.request.sent, business.user.status.changed, business.user.profile.updated, common.message.chat, business.user.logout, common.auth.validate, business.user.login, business.conversation.updated, common.message.control, websocket.*, business.group.member.joined, security.token.validate, business.group.created]
2025-08-15 03:39:42.670 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 22 个处理器
2025-08-15 03:39:42.670 [communication-service:29] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"d35e5d8d-154b-4d23-889a-ce9455e04cb6","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:39:42","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:39:42","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:39:42.670 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 事件处理器注册完成，共发现 15 个处理器
2025-08-15 03:39:42.670 [im-common:30] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📄 消息JSON内容: {"eventId":"d35e5d8d-154b-4d23-889a-ce9455e04cb6","subject":"im.user.user_login","eventType":"NOTIFICATION","status":"SUCCESS","priority":"MEDIUM","sourceService":null,"sourceInstance":null,"targetService":null,"targetInstance":null,"userId":"7","deviceId":null,"sessionId":null,"data":{"userId":7,"username":"cccc","deviceId":"test_device_001","ipAddress":null,"userAgent":null,"eventTime":"2025-08-15 03:39:42","additionalData":null,"description":null,"success":true,"errorMessage":null},"metadata":null,"createdAt":"2025-08-15 03:39:42","expiresAt":null,"retryCount":null,"maxRetries":null,"errorMessage":null,"errorCode":null}
2025-08-15 03:39:42.672 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6, eventType=NOTIFICATION, userId=7
2025-08-15 03:39:42.672 [im-common:30] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:39:42.672 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:39:42.672 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6, eventType=NOTIFICATION
2025-08-15 03:39:42.672 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.login
2025-08-15 03:39:42.672 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 03:39:42.672 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: BusinessEventHandler.handleUserLogin
2025-08-15 03:39:42.672 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: BusinessEventHandler.handleUserLogin, subject=business.user.login, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6
2025-08-15 03:39:42.672 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:39:42.672 [im-common:30] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:39:42.672 [im-common:30] INFO  c.a.i.b.m.c.event.handler.BusinessEventHandler - 处理用户登录事件: userId=7, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6
2025-08-15 03:39:42.672 [im-common:30] WARN  c.a.i.b.module.common.event.EventProcessorRegistry - 没有找到主题 business.user.login 的处理器: eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6
2025-08-15 03:39:42.673 [im-common:30] INFO  c.a.i.b.m.c.event.handler.BusinessEventHandler - 用户登录事件处理成功: userId=7
2025-08-15 03:39:42.673 [im-common:30] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: BusinessEventHandler.handleUserLogin, subject=business.user.login, result=null
2025-08-15 03:39:42.673 [im-common:30] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 成功解析BaseEvent: eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6, eventType=NOTIFICATION, userId=7
2025-08-15 03:39:42.673 [communication-service:29] DEBUG c.a.i.c.i.nats.subscriber.EventSubscriber - 📝 设置事件主题: business.user.login
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🚀 开始路由事件到EventHandlerRegistry...
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 📨 收到事件: subject=business.user.login, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6, eventType=NOTIFICATION
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 找到 1 个事件处理器: subject=business.user.login
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry -   - 处理器: CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 03:39:42.673 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - ⚡ 同步执行处理器: CommunicationEventHandler.onBusinessUserLogin
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - 🚀 开始执行处理器: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6
2025-08-15 03:39:42.673 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 🔍 处理器方法参数类型: [class com.acme.im.common.infrastructure.nats.dto.BaseEvent]
2025-08-15 03:39:42.673 [communication-service:29] DEBUG c.a.i.c.i.nats.handler.EventHandlerRegistry - 📤 调用处理器方法，传递BaseEvent参数
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.event.CommunicationEventHandler - 监听到业务层用户登录事件: userId=7, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.event.CommunicationEventHandler - 业务层用户登录事件同步成功: userId=7
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.handler.EventHandlerRegistry - ✅ 事件处理器执行成功: CommunicationEventHandler.onBusinessUserLogin, subject=business.user.login, result=null
2025-08-15 03:39:42.673 [communication-service:29] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - ✅ 事件自动路由成功: subject=business.user.login, eventId=d35e5d8d-154b-4d23-889a-ce9455e04cb6
2025-08-15 03:39:55.736 [http-nio-8080-exec-4] DEBUG c.acme.im.common.security.UserDetailsServiceImpl - 加载用户详情: cccc
2025-08-15 03:39:55.736 [http-nio-8080-exec-4] WARN  c.acme.im.common.security.UserDetailsServiceImpl - 使用默认用户加载器，生产环境请注入真实的用户加载器
2025-08-15 03:39:55.738 [http-nio-8080-exec-4] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - JWT认证成功: cccc
2025-08-15 03:39:55.744 [http-nio-8080-exec-4] DEBUG c.a.i.b.module.user.controller.UserController - 从JWT获取用户名: cccc
2025-08-15 03:39:55.745 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==>  Preparing: SELECT * FROM users WHERE username = ?
2025-08-15 03:39:55.746 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - ==> Parameters: cccc(String)
2025-08-15 03:39:55.747 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.r.UserRepository.findByUsername - <==      Total: 1
2025-08-15 03:39:55.748 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==>  Preparing: SELECT id,username,email,phone,nickname,avatar_url,signature,gender,birthday,region,status,online_status,last_login_at,last_active_at,password_hash,salt,two_factor_enabled,two_factor_secret,created_at,updated_at FROM users WHERE id=?
2025-08-15 03:39:55.749 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - ==> Parameters: 7(Long)
2025-08-15 03:39:55.750 [http-nio-8080-exec-4] DEBUG c.a.i.b.m.u.repository.UserRepository.selectById - <==      Total: 1
2025-08-15 03:40:28.974 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 03:42:45.920 [http-nio-8081-exec-9] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 03:42:45.924 [http-nio-8081-exec-9] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 03:44:20.560 [http-nio-8081-exec-4] ERROR o.s.w.s.server.support.DefaultHandshakeHandler - "Handshake failed due to invalid Upgrade header: null"
2025-08-15 03:44:27.945 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:44:28.996 [cache-4] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:44:28.996 [cache-3] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:44:33.102 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:45:27.946 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:45:33.104 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 03:46:02.444 [http-nio-8081-exec-5] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 03:46:02.445 [http-nio-8081-exec-5] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 03:46:02.451 [http-nio-8081-exec-6] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 03:46:02.451 [http-nio-8081-exec-6] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 03:46:17.633 [clientOutboundChannel-1] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket连接建立 - 会话ID: cijp02pr
2025-08-15 03:46:17.637 [http-nio-8081-exec-10] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: cijp02pr, 目标: /topic/public
2025-08-15 03:46:17.637 [http-nio-8081-exec-10] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: cijp02pr, 目标: /user/queue/private-messages
2025-08-15 03:46:17.638 [http-nio-8081-exec-10] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: cijp02pr, 目标: /topic/system
2025-08-15 03:46:32.519 [clientInboundChannel-16] ERROR o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Unhandled exception from message handler method
org.springframework.messaging.converter.MessageConversionException: Cannot convert from [[B] to [com.acme.im.common.websocket.proto.WebSocketMessage] for GenericMessage [payload=byte[90], headers={simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/app/chat], content-length=[90]}, simpSessionAttributes={}, simpHeartbeat=[J@e4e5beb, lookupDestination=/chat, simpSessionId=cijp02pr, simpDestination=/app/chat}]
	at org.springframework.messaging.handler.annotation.support.PayloadMethodArgumentResolver.resolveArgument(PayloadMethodArgumentResolver.java:151)
	at org.springframework.messaging.handler.invocation.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:118)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:147)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:115)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMatch(AbstractMethodMessageHandler.java:567)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:529)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:93)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessageInternal(AbstractMethodMessageHandler.java:522)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessage(AbstractMethodMessageHandler.java:457)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:152)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-08-15 03:46:55.769 [clientInboundChannel-19] ERROR o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Unhandled exception from message handler method
org.springframework.messaging.converter.MessageConversionException: Cannot convert from [[B] to [com.acme.im.common.websocket.proto.WebSocketMessage] for GenericMessage [payload=byte[93], headers={simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/app/chat], content-length=[93]}, simpSessionAttributes={}, simpHeartbeat=[J@47467abf, lookupDestination=/chat, simpSessionId=cijp02pr, simpDestination=/app/chat}]
	at org.springframework.messaging.handler.annotation.support.PayloadMethodArgumentResolver.resolveArgument(PayloadMethodArgumentResolver.java:151)
	at org.springframework.messaging.handler.invocation.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:118)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:147)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:115)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMatch(AbstractMethodMessageHandler.java:567)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:529)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:93)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessageInternal(AbstractMethodMessageHandler.java:522)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessage(AbstractMethodMessageHandler.java:457)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:152)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-08-15 03:49:27.947 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:49:29.001 [cache-5] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:49:29.001 [cache-6] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:49:33.108 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:54:27.953 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:54:29.013 [cache-7] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:54:29.013 [cache-8] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:54:33.111 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:59:27.953 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 03:59:29.020 [cache-10] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 03:59:29.020 [cache-9] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 03:59:33.122 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:04:27.957 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:04:29.034 [cache-11] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:04:29.033 [cache-12] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:04:33.127 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:09:27.962 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:09:29.045 [cache-13] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:09:29.046 [cache-14] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:09:33.130 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:10:29.002 [MessageBroker-12] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 21], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 365]
2025-08-15 04:14:27.937 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:14:29.031 [cache-16] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:14:29.031 [cache-15] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:14:33.106 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:19:27.948 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:19:29.037 [cache-18] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:19:29.037 [cache-17] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:19:33.108 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:24:27.947 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:24:29.047 [cache-19] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:24:29.047 [cache-20] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:24:33.104 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:29:27.951 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:29:29.058 [cache-22] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:29:29.058 [cache-21] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:29:33.112 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:34:27.945 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:34:29.067 [cache-24] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:34:29.066 [cache-23] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:34:33.113 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:39:27.952 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:39:29.073 [cache-25] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:39:29.073 [cache-26] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:39:33.107 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:40:28.991 [MessageBroker-13] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 21], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 811]
2025-08-15 04:44:27.952 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:44:29.083 [cache-27] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:44:29.084 [cache-28] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:44:33.115 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:49:27.953 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:49:29.087 [cache-29] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:49:29.087 [cache-30] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:49:33.115 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:54:27.959 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:54:29.091 [cache-31] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:54:29.091 [cache-32] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:54:33.115 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:59:27.961 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 04:59:29.104 [cache-34] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 04:59:29.103 [cache-33] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 04:59:33.120 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:04:27.963 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:04:29.114 [cache-36] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:04:29.114 [cache-35] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:04:33.122 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:09:27.956 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:09:29.116 [cache-37] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:09:29.117 [cache-38] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:09:33.126 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:10:29.006 [MessageBroker-2] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 21], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 1256]
2025-08-15 05:14:27.911 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:14:29.074 [cache-39] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:14:29.074 [cache-40] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:14:33.076 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:19:27.911 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:19:29.085 [cache-42] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:19:29.084 [cache-41] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:19:33.073 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:24:27.903 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:24:29.091 [cache-43] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:24:29.092 [cache-44] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:24:33.070 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:29:27.906 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:29:29.093 [cache-46] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:29:29.094 [cache-45] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:29:33.069 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:34:27.901 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:34:29.102 [cache-48] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:34:29.102 [cache-47] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:34:33.070 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:39:27.907 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:39:29.107 [cache-49] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:39:29.108 [cache-50] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:39:33.069 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:40:28.954 [MessageBroker-1] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 21], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 1701]
2025-08-15 05:44:27.900 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:44:29.109 [cache-51] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:44:29.110 [cache-52] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:44:33.060 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:49:27.900 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:49:29.115 [cache-53] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:49:29.116 [cache-54] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:49:33.065 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:54:27.943 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:54:29.162 [cache-56] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:54:29.163 [cache-55] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:54:33.103 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:59:27.952 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 05:59:29.173 [cache-57] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 05:59:29.173 [cache-58] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 05:59:33.112 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:04:27.953 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:04:29.177 [cache-59] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:04:29.177 [cache-60] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:04:33.114 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:09:27.949 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:09:29.190 [cache-61] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:09:29.190 [cache-62] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:09:33.109 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:10:29.006 [MessageBroker-14] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 21], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 2146]
2025-08-15 06:14:27.948 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:14:29.189 [cache-63] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:14:29.190 [cache-64] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:14:33.105 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:15:36.484 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 06:15:36.789 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 06:15:36.789 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 06:15:36.789 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 06:15:36.789 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 06:15:36.789 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 06:15:36.789 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 06:15:36.790 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 06:15:36.792 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 06:15:36.792 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 06:15:36.792 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 06:15:36.793 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=1
2025-08-15 06:15:38.991 [SpringApplicationShutdownHook] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket连接断开 - 会话ID: cijp02pr
2025-08-15 06:15:38.992 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 06:15:38.992 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@60d1b2a7]]
2025-08-15 06:15:38.992 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 06:15:39.115 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 06:15:39.567 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 69976 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 06:15:39.568 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 06:15:39.568 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 06:15:39.877 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 06:15:39.878 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 06:15:39.884 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 06:15:39.938 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 06:15:39.938 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 06:15:39.938 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 06:15:39.938 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 06:15:39.938 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 06:15:39.938 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 06:15:39.938 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 06:15:39.941 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 06:15:39.941 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 06:15:39.941 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 06:15:39.942 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 06:15:40.028 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 06:15:40.028 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 06:15:40.033 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 06:15:40.442 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 06:15:40.447 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 06:15:40.447 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 06:15:40.470 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 06:15:40.470 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 884 ms
2025-08-15 06:15:40.577 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 06:15:40.585 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 06:15:40.614 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 06:15:40.649 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 06:15:40.666 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 06:15:40.667 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 06:15:40.671 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 06:15:40.671 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 06:15:40.671 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 06:15:40.671 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 06:15:40.742 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 06:15:40.744 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 06:15:41.041 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 06:15:41.132 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 06:15:41.136 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 06:15:41.163 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 06:15:41.164 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 06:15:41.164 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 06:15:41.168 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 06:15:41.168 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 06:15:41.171 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 06:15:41.190 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 06:15:41.190 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 06:15:41.190 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 06:15:41.198 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 06:15:41.217 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 06:15:41.217 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 06:15:41.217 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 06:15:41.220 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 06:15:41.220 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 06:15:41.220 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 06:15:41.249 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 06:15:41.249 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 06:15:41.252 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 06:15:41.252 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@52b7c1d9[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:41.254 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 06:15:41.255 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 06:15:41.266 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 06:15:41.266 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@23adbd6b[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:41.267 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 06:15:41.267 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@629dfb5a[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:41.268 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 06:15:41.268 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@38ae69f7[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:41.270 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 06:15:41.270 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@623d222[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:41.271 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 06:15:41.271 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@4b3eaf39[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:41.274 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 06:15:41.274 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 06:15:41.280 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 06:15:41.411 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 06:15:41.425 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 06:15:41.425 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 06:15:41.434 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 06:15:41.434 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 06:15:41.434 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 06:15:41.510 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 06:15:41.576 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 06:15:41.671 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 69985 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 06:15:41.672 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 06:15:41.672 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 2 profiles are active: "common", "dev"
2025-08-15 06:15:42.142 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 06:15:42.143 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 06:15:42.150 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 06:15:42.188 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 06:15:42.233 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@43e55cfb, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@582ea857, org.springframework.security.web.context.SecurityContextHolderFilter@3c41b4b, org.springframework.security.web.header.HeaderWriterFilter@38e1442a, org.springframework.web.filter.CorsFilter@650ee893, com.acme.im.common.security.jwt.JwtAuthenticationFilter@5d5ae6aa, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1e5e0e75, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2e50ca51, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@13eb8ca, org.springframework.security.web.session.SessionManagementFilter@601c953c, org.springframework.security.web.access.ExceptionTranslationFilter@8b814b, org.springframework.security.web.access.intercept.AuthorizationFilter@6bd21eb7]
2025-08-15 06:15:42.314 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 06:15:42.314 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 06:15:42.315 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 06:15:42.353 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 06:15:42.551 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 06:15:42.553 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 15 个处理器
2025-08-15 06:15:42.553 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 06:15:42.553 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 06:15:42.553 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 06:15:42.553 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 06:15:42.554 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 06:15:42.555 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 06:15:42.555 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 06:15:42.572 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 06:15:42.572 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 06:15:42.575 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 06:15:42.575 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 06:15:42.585 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 06:15:42.593 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 3.178 seconds (process running for 3.351)
2025-08-15 06:15:42.596 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 06:15:42.597 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 06:15:42.598 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 06:15:42.598 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 06:15:42.598 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 06:15:42.598 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 06:15:42.599 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 06:15:42.600 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 06:15:42.601 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 06:15:42.601 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 27/27 个主题
2025-08-15 06:15:42.601 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated]
2025-08-15 06:15:42.603 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 06:15:42.726 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 06:15:42.730 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 06:15:42.730 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 06:15:42.752 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 06:15:42.752 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1061 ms
2025-08-15 06:15:42.872 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 06:15:42.889 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 06:15:42.890 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 06:15:42.890 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 06:15:42.890 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 06:15:42.890 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 06:15:42.890 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 06:15:42.890 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 06:15:42.890 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 06:15:42.891 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 06:15:42.891 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 06:15:42.891 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 06:15:42.891 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 06:15:42.907 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 06:15:42.915 [RMI TCP Connection(4)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 06:15:42.915 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 06:15:42.916 [RMI TCP Connection(4)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 06:15:42.942 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 06:15:42.958 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 06:15:42.959 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 06:15:42.973 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 06:15:42.975 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 06:15:43.106 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 06:15:43.267 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 06:15:43.273 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 06:15:43.288 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 06:15:43.288 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 06:15:43.288 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 06:15:43.289 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 06:15:43.289 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 06:15:43.291 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 06:15:43.291 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 06:15:43.299 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 06:15:43.299 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 06:15:43.300 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 06:15:43.306 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 06:15:43.312 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 06:15:43.312 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 06:15:43.312 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 06:15:43.314 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 06:15:43.314 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 06:15:43.314 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 06:15:43.336 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 06:15:43.336 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 06:15:43.338 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 06:15:43.338 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@54cce500[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:43.339 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 06:15:43.340 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 06:15:43.440 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 06:15:43.440 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@238d27ef[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:43.441 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 06:15:43.441 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1dfd6023[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:43.442 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 06:15:43.442 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3e7da4cb[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:43.443 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 06:15:43.443 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@41271320[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:43.444 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 06:15:43.444 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@69a031a4[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 06:15:43.447 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 06:15:43.447 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 06:15:43.453 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 06:15:43.560 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 06:15:43.569 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 06:15:43.570 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 06:15:43.578 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 06:15:43.578 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 06:15:43.578 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 06:15:43.652 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 06:15:43.707 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 06:15:43.813 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 06:15:44.069 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 06:15:44.105 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@598b15ba, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@58453967, org.springframework.security.web.context.SecurityContextHolderFilter@1f3c3291, org.springframework.security.web.header.HeaderWriterFilter@5d8319a7, org.springframework.web.filter.CorsFilter@6f34d178, com.acme.im.common.security.jwt.JwtAuthenticationFilter@1f85904a, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@602854ed, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@248e31a1, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@75c8ba94, org.springframework.security.web.session.SessionManagementFilter@143abb21, org.springframework.security.web.access.ExceptionTranslationFilter@7072606, org.springframework.security.web.access.intercept.AuthorizationFilter@2b208574]
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.user.profile.sync, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.user.status.sync, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=CommunicationEventHandler.onBusinessUserLogout, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=CommunicationEventHandler.onBusinessGroupCreated, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=CommunicationEventHandler.onBusinessFriendAdded, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=CommunicationEventHandler.onBusinessConversationCreated, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=CommunicationEventHandler.onBusinessConversationUpdated, priority=100, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 06:15:44.397 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 06:15:44.399 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 22 个处理器
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 06:15:44.400 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 06:15:44.401 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 06:15:44.402 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 06:15:44.402 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 06:15:44.418 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 06:15:44.418 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 06:15:44.420 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 06:15:44.420 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 06:15:44.428 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 06:15:44.428 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 06:15:44.429 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3cfd9459]]
2025-08-15 06:15:44.429 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 06:15:44.436 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 3.086 seconds (process running for 3.302)
2025-08-15 06:15:44.439 [cache-2] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:15:44.439 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 06:15:44.439 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 06:15:44.440 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 06:15:44.441 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 06:15:44.442 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.validate
2025-08-15 06:15:44.443 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.validate, sid=security.token.validate
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.refresh
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.refresh, sid=security.token.refresh
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.revoke
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.revoke, sid=security.token.revoke
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.auth.failed
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.auth.failed, sid=security.auth.failed
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.permission.denied
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.permission.denied, sid=security.permission.denied
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 35/35 个主题
2025-08-15 06:15:44.444 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, security.token.validate, security.token.refresh, security.token.revoke, security.auth.failed, security.permission.denied]
2025-08-15 06:15:44.444 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 06:15:44.444 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 06:15:44.445 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 06:15:44.445 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 06:15:44.445 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 06:15:44.445 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 06:15:44.763 [RMI TCP Connection(2)-192.168.2.8] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 06:15:44.763 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 06:15:44.763 [RMI TCP Connection(2)-192.168.2.8] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-15 06:15:47.608 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 06:15:47.609 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 06:15:47.609 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 06:15:47.609 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 06:15:47.623 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 06:15:47.623 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 06:15:49.445 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 06:15:49.446 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 06:15:49.446 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 06:15:49.446 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 06:15:49.451 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 06:15:49.451 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 06:16:04.990 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 06:16:04.990 [http-nio-8081-exec-1] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 06:16:04.998 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - 🔍 收到服务状态查询请求
2025-08-15 06:16:04.998 [http-nio-8081-exec-2] INFO  c.acme.im.communication.controller.TestController - ✅ 返回服务状态: Communication Service is running. NATS event mechanism is ready.
2025-08-15 06:16:16.001 [clientOutboundChannel-1] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket连接建立 - 会话ID: 34ynpute
2025-08-15 06:16:16.003 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: 34ynpute, 目标: /topic/public
2025-08-15 06:16:16.004 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: 34ynpute, 目标: /user/queue/private-messages
2025-08-15 06:16:16.004 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: 34ynpute, 目标: /topic/system
2025-08-15 06:16:16.004 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: 34ynpute, 目标: /user/queue/auth
2025-08-15 06:16:16.005 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: 34ynpute, 目标: /user/queue/heartbeat
2025-08-15 06:16:16.005 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: 34ynpute, 目标: /user/queue/status
2025-08-15 06:16:16.007 [clientInboundChannel-22] INFO  c.a.i.c.websocket.WebSocketMessageHandler - 收到认证消息: [123, 34, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 97, 117, 116, 104, 95, 49, 55, 53, 53, 50, 49, 51, 51, 55, 54, 48, 48, 51, 34, 44, 34, 116, 121, 112, 101, 34, 58, 49, 48, 44, 34, 115, 116, 97, 116, 117, 115, 34, 58, 48, 44, 34, 115, 101, 110, 100, 101, 114, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 117, 115, 101, 114, 34, 44, 34, 114, 101, 99, 101, 105, 118, 101, 114, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 99, 111, 110, 118, 101, 114, 115, 97, 116, 105, 111, 110, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 116, 105, 109, 101, 115, 116, 97, 109, 112, 34, 58, 49, 55, 53, 53, 50, 49, 51, 51, 55, 54, 48, 48, 51, 44, 34, 115, 101, 113, 117, 101, 110, 99, 101, 34, 58, 48, 44, 34, 99, 108, 105, 101, 110, 116, 95, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 97, 117, 116, 104, 95, 49, 55, 53, 53, 50, 49, 51, 51, 55, 54, 48, 48, 51, 34, 44, 34, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 46, 48, 34, 44, 34, 97, 117, 116, 104, 34, 58, 123, 34, 116, 111, 107, 101, 110, 34, 58, 34, 101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 73, 85, 122, 73, 49, 78, 105, 74, 57, 46, 101, 121, 74, 48, 101, 88, 66, 108, 73, 106, 111, 105, 89, 87, 78, 106, 90, 88, 78, 122, 73, 105, 119, 105, 90, 71, 86, 50, 97, 87, 78, 108, 83, 87, 81, 105, 79, 105, 74, 48, 90, 88, 78, 48, 88, 50, 82, 108, 100, 109, 108, 106, 90, 86, 56, 119, 77, 68, 69, 105, 76, 67, 74, 122, 100, 87, 73, 105, 79, 105, 74, 106, 89, 50, 78, 106, 73, 105, 119, 105, 97, 88, 78, 122, 73, 106, 111, 105, 83, 85, 48, 116, 85, 51, 108, 122, 100, 71, 86, 116, 73, 105, 119, 105, 89, 88, 86, 107, 73, 106, 112, 98, 73, 109, 108, 116, 76, 88, 86, 122, 90, 88, 74, 122, 73, 108, 48, 115, 73, 109, 108, 104, 100, 67, 73, 54, 77, 84, 99, 49, 78, 84, 73, 119, 77, 122, 107, 52, 77, 105, 119, 105, 90, 88, 104, 119, 73, 106, 111, 120, 78, 122, 85, 49, 77, 106, 65, 51, 78, 84, 103, 121, 102, 81, 46, 121, 118, 54, 56, 66, 117, 53, 117, 101, 77, 51, 70, 56, 122, 110, 111, 97, 48, 75, 54, 81, 75, 79, 53, 76, 69, 116, 72, 119, 115, 57, 114, 111, 83, 82, 51, 111, 100, 114, 97, 122, 67, 65, 34, 44, 34, 117, 115, 101, 114, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 117, 115, 101, 114, 34, 44, 34, 100, 101, 118, 105, 99, 101, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 100, 101, 118, 105, 99, 101, 95, 48, 48, 49, 34, 44, 34, 97, 117, 116, 104, 95, 100, 97, 116, 97, 34, 58, 34, 34, 125, 125]
2025-08-15 06:16:31.073 [clientInboundChannel-25] INFO  c.a.i.c.websocket.WebSocketMessageHandler - 收到聊天消息: [123, 34, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 109, 115, 103, 95, 49, 95, 49, 55, 53, 53, 50, 49, 51, 51, 57, 49, 48, 54, 57, 34, 44, 34, 116, 121, 112, 101, 34, 58, 50, 48, 44, 34, 115, 116, 97, 116, 117, 115, 34, 58, 48, 44, 34, 115, 101, 110, 100, 101, 114, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 117, 115, 101, 114, 34, 44, 34, 114, 101, 99, 101, 105, 118, 101, 114, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 99, 111, 110, 118, 101, 114, 115, 97, 116, 105, 111, 110, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 116, 105, 109, 101, 115, 116, 97, 109, 112, 34, 58, 49, 55, 53, 53, 50, 49, 51, 51, 57, 49, 48, 54, 57, 44, 34, 115, 101, 113, 117, 101, 110, 99, 101, 34, 58, 49, 44, 34, 99, 108, 105, 101, 110, 116, 95, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 99, 108, 105, 101, 110, 116, 95, 49, 95, 49, 55, 53, 53, 50, 49, 51, 51, 57, 49, 48, 54, 57, 34, 44, 34, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 46, 48, 34, 44, 34, 99, 104, 97, 116, 34, 58, 123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -27, -109, -110, -27, -109, -110, 34, 44, 34, 109, 115, 103, 95, 116, 121, 112, 101, 34, 58, 49, 44, 34, 99, 111, 110, 116, 101, 110, 116, 95, 101, 120, 116, 114, 97, 34, 58, 34, 34, 44, 34, 114, 101, 112, 108, 121, 95, 116, 111, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 102, 111, 114, 119, 97, 114, 100, 95, 102, 114, 111, 109, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 109, 101, 110, 116, 105, 111, 110, 115, 34, 58, 34, 34, 44, 34, 105, 115, 95, 112, 105, 110, 110, 101, 100, 34, 58, 102, 97, 108, 115, 101, 44, 34, 105, 115, 95, 101, 100, 105, 116, 101, 100, 34, 58, 102, 97, 108, 115, 101, 44, 34, 101, 100, 105, 116, 95, 99, 111, 117, 110, 116, 34, 58, 48, 125, 125]
2025-08-15 06:16:31.073 [clientInboundChannel-25] DEBUG c.a.i.c.websocket.WebSocketMessageHandler - 用户会话ID: 34ynpute
2025-08-15 06:16:44.424 [MessageBroker-9] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 27, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 9]
2025-08-15 06:16:48.731 [http-nio-8081-exec-7] INFO  c.acme.im.communication.controller.TestController - 🚀 开始测试NATS事件发布: subject=吗敏敏, message=null
2025-08-15 06:16:48.733 [http-nio-8081-exec-7] INFO  c.acme.im.communication.controller.TestController - 📤 准备发布NATS事件: subject=吗敏敏, requestId=test_direct_1755213408731, event=BaseEvent(eventId=376e448c-2b7c-47ce-a0a0-fc8f53fa73db, subject=吗敏敏, eventType=REQUEST, status=PENDING, priority=MEDIUM, sourceService=communication-service, sourceInstance=test-controller, targetService=null, targetInstance=null, userId=null, deviceId=null, sessionId=null, data=UserEvents.TokenValidationRequest(requestId=test_direct_1755213408731, token=test_token_1755213408732, deviceId=test_device_001, timestamp=1755213408732), metadata={requestId=test_direct_1755213408731, testType=manual-test, timestamp=1755213408733}, createdAt=2025-08-15T06:16:48.733720, expiresAt=null, retryCount=0, maxRetries=3, errorMessage=null, errorCode=null)
2025-08-15 06:16:48.740 [http-nio-8081-exec-7] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=吗敏敏, queueSize=1
2025-08-15 06:16:48.968 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 06:16:48.969 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=1, total=10
2025-08-15 06:16:48.972 [async-event-scheduler-2] WARN  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布失败: subject=吗敏敏, retryCount=0, error=Subject must be printable characters only.
2025-08-15 06:16:50.975 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件重试: subject=吗敏敏, retryCount=1
2025-08-15 06:16:51.964 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 06:16:51.965 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=2, total=10
2025-08-15 06:16:51.966 [async-event-scheduler-2] WARN  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布失败: subject=吗敏敏, retryCount=1, error=Subject must be printable characters only.
2025-08-15 06:16:53.746 [http-nio-8081-exec-7] ERROR c.a.i.c.i.nats.publisher.AsyncEventPublisher - 同步发布事件失败: subject=吗敏敏
java.util.concurrent.TimeoutException: null
	at java.base/java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1960)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2095)
	at com.acme.im.common.infrastructure.nats.publisher.AsyncEventPublisher.publishEvent(AsyncEventPublisher.java:248)
	at com.acme.im.communication.controller.TestController.publishNatsEvent(TestController.java:75)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.acme.im.common.security.jwt.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:50)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-08-15 06:16:53.753 [http-nio-8081-exec-7] ERROR c.acme.im.communication.controller.TestController - ❌ NATS事件发布失败: subject=吗敏敏, error=发布事件失败
java.lang.RuntimeException: 发布事件失败
	at com.acme.im.common.infrastructure.nats.publisher.AsyncEventPublisher.publishEvent(AsyncEventPublisher.java:251)
	at com.acme.im.communication.controller.TestController.publishNatsEvent(TestController.java:75)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.acme.im.common.security.jwt.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:50)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.util.concurrent.TimeoutException: null
	at java.base/java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1960)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2095)
	at com.acme.im.common.infrastructure.nats.publisher.AsyncEventPublisher.publishEvent(AsyncEventPublisher.java:248)
	... 133 common frames omitted
2025-08-15 06:16:55.968 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件重试: subject=吗敏敏, retryCount=2
2025-08-15 06:16:56.964 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 06:16:56.964 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=3, total=10
2025-08-15 06:16:56.965 [async-event-scheduler-1] WARN  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布失败: subject=吗敏敏, retryCount=2, error=Subject must be printable characters only.
2025-08-15 06:17:04.966 [async-event-scheduler-1] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件重试: subject=吗敏敏, retryCount=3
2025-08-15 06:17:05.964 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 06:17:05.964 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=4, total=10
2025-08-15 06:17:05.965 [async-event-scheduler-2] WARN  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布失败: subject=吗敏敏, retryCount=3, error=Subject must be printable characters only.
2025-08-15 06:17:05.965 [async-event-scheduler-2] ERROR c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布最终失败: subject=吗敏敏, maxRetries=3
2025-08-15 06:17:12.897 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - 🚀 开始测试NATS事件发布: subject=vvv, message=null
2025-08-15 06:17:12.898 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - 📤 准备发布NATS事件: subject=vvv, requestId=test_direct_1755213432897, event=BaseEvent(eventId=83dc72cb-9968-4175-89f0-5c8c0777407a, subject=vvv, eventType=REQUEST, status=PENDING, priority=MEDIUM, sourceService=communication-service, sourceInstance=test-controller, targetService=null, targetInstance=null, userId=null, deviceId=null, sessionId=null, data=UserEvents.TokenValidationRequest(requestId=test_direct_1755213432897, token=test_token_1755213432897, deviceId=test_device_001, timestamp=1755213432897), metadata={requestId=test_direct_1755213432897, testType=manual-test, timestamp=1755213432898}, createdAt=2025-08-15T06:17:12.898089, expiresAt=null, retryCount=0, maxRetries=3, errorMessage=null, errorCode=null)
2025-08-15 06:17:12.898 [http-nio-8081-exec-8] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件已加入队列: subject=vvv, queueSize=1
2025-08-15 06:17:12.964 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 批量处理事件: size=1
2025-08-15 06:17:12.965 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.config.NatsConnectionPool - 从连接池获取连接: active=5, total=10
2025-08-15 06:17:12.966 [async-event-scheduler-2] DEBUG c.a.i.c.i.nats.publisher.AsyncEventPublisher - 事件发布成功: subject=vvv, useJetStream=false
2025-08-15 06:17:12.966 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - 📤 事件发布请求已发送
2025-08-15 06:17:12.967 [http-nio-8081-exec-8] INFO  c.acme.im.communication.controller.TestController - ✅ NATS事件发布成功: subject=vvv, requestId=test_direct_1755213432897
2025-08-15 06:20:41.256 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:20:43.340 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:20:44.445 [cache-4] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:20:44.446 [cache-3] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:21:41.255 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 06:21:43.342 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 06:25:41.255 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:25:43.342 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:25:44.459 [cache-5] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:25:44.458 [cache-6] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:30:41.261 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:30:43.342 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:30:44.467 [cache-8] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:30:44.469 [cache-7] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:35:41.254 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:35:43.345 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:35:44.472 [cache-9] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:35:44.472 [cache-10] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:40:41.269 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:40:43.356 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:40:44.485 [cache-12] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:40:44.485 [cache-11] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:45:41.266 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:45:43.361 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:45:44.497 [cache-13] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:45:44.497 [cache-14] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:46:44.451 [MessageBroker-10] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 454]
2025-08-15 06:50:41.270 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:50:43.364 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:50:44.511 [cache-15] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:50:44.511 [cache-16] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 06:55:41.275 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:55:43.367 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 06:55:44.524 [cache-17] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 06:55:44.524 [cache-18] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:00:41.282 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:00:43.362 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:00:44.530 [cache-20] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:00:44.530 [cache-19] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:05:41.281 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:05:43.371 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:05:44.540 [cache-22] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:05:44.540 [cache-21] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:10:41.279 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:10:43.365 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:10:44.545 [cache-24] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:10:44.545 [cache-23] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:15:41.279 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:15:43.372 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:15:44.555 [cache-25] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:15:44.556 [cache-26] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:16:44.462 [MessageBroker-13] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 900]
2025-08-15 07:20:41.282 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:20:43.370 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:20:44.566 [cache-28] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:20:44.566 [cache-27] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:25:41.278 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:25:43.375 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:25:44.578 [cache-29] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:25:44.578 [cache-30] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:30:41.286 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:30:43.372 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:30:44.589 [cache-31] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:30:44.588 [cache-32] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:35:41.289 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:35:43.373 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:35:44.603 [cache-34] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:35:44.602 [cache-33] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:40:41.291 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:40:43.374 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:40:44.612 [cache-35] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:40:44.613 [cache-36] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:45:41.252 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:45:43.341 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:45:44.592 [cache-38] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:45:44.592 [cache-37] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:46:44.443 [MessageBroker-1] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 1345]
2025-08-15 07:50:41.259 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:50:43.343 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:50:44.601 [cache-40] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:50:44.601 [cache-39] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 07:55:41.258 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:55:43.341 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 07:55:44.606 [cache-42] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 07:55:44.606 [cache-41] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:00:41.212 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:00:43.307 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:00:44.576 [cache-44] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:00:44.576 [cache-43] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:05:41.215 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:05:43.300 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:05:44.582 [cache-46] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:05:44.582 [cache-45] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:10:41.208 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:10:43.295 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:10:44.585 [cache-48] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:10:44.585 [cache-47] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:15:41.202 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:15:43.297 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:15:44.588 [cache-49] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:15:44.589 [cache-50] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:16:44.403 [MessageBroker-11] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 1791]
2025-08-15 08:20:41.204 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:20:43.286 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:20:44.593 [cache-52] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:20:44.593 [cache-51] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:25:41.249 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:25:43.339 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:25:44.650 [cache-53] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:25:44.650 [cache-54] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:30:41.249 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:30:43.338 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:30:44.657 [cache-55] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:30:44.657 [cache-56] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:35:41.250 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:35:43.336 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:35:44.664 [cache-57] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:35:44.664 [cache-58] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:40:41.251 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:40:43.333 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:40:44.668 [cache-59] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:40:44.669 [cache-60] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:45:41.253 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:45:43.333 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:45:44.677 [cache-61] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:45:44.677 [cache-62] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:46:44.454 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 2236]
2025-08-15 08:50:41.247 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:50:43.339 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:50:44.684 [cache-63] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:50:44.684 [cache-64] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 08:55:41.252 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:55:43.338 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 08:55:44.694 [cache-65] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 08:55:44.694 [cache-66] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:00:41.252 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:00:43.347 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:00:44.707 [cache-67] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:00:44.707 [cache-68] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:05:41.257 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:05:43.346 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:05:44.718 [cache-70] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:05:44.719 [cache-69] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:10:41.260 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:10:43.348 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:10:44.729 [cache-71] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:10:44.730 [cache-72] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:15:41.237 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:15:43.321 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:15:44.704 [cache-73] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:15:44.704 [cache-74] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:16:44.431 [MessageBroker-2] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 2682]
2025-08-15 09:20:41.219 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:20:43.306 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:20:44.700 [cache-76] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:20:44.700 [cache-75] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:25:41.218 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:25:43.298 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:25:44.709 [cache-78] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:25:44.708 [cache-77] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:30:41.215 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:30:43.295 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:30:44.717 [cache-80] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:30:44.717 [cache-79] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:35:41.209 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:35:43.293 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:35:44.718 [cache-81] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:35:44.718 [cache-82] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:40:41.242 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:40:43.329 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:40:44.758 [cache-84] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:40:44.758 [cache-83] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:45:41.242 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:45:43.332 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:45:44.771 [cache-85] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:45:44.771 [cache-86] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:46:44.466 [MessageBroker-6] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 3127]
2025-08-15 09:50:41.242 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:50:43.330 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:50:44.776 [cache-87] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:50:44.776 [cache-88] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 09:55:41.245 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:55:43.333 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 09:55:44.781 [cache-90] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 09:55:44.781 [cache-89] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:00:41.248 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:00:43.335 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:00:44.792 [cache-91] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:00:44.792 [cache-92] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:05:41.248 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:05:43.335 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:05:44.803 [cache-93] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:05:44.804 [cache-94] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:10:41.241 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:10:43.332 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:10:44.815 [cache-95] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:10:44.816 [cache-96] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:15:41.245 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:15:43.332 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:15:44.825 [cache-97] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:15:44.826 [cache-98] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:16:44.480 [MessageBroker-13] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 3573]
2025-08-15 10:20:41.189 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:20:43.280 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:20:44.784 [cache-100] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:20:44.784 [cache-99] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:25:41.187 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:25:43.281 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:25:44.792 [cache-101] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:25:44.793 [cache-102] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:30:41.189 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:30:43.273 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:30:44.799 [cache-104] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:30:44.798 [cache-103] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:35:41.186 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:35:43.273 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:35:44.803 [cache-106] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:35:44.803 [cache-105] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:40:41.218 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:40:43.301 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:40:44.844 [cache-108] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:40:44.844 [cache-107] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:45:41.217 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:45:43.304 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:45:44.848 [cache-110] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:45:44.848 [cache-109] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:46:44.457 [MessageBroker-3] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 4018]
2025-08-15 10:50:41.217 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:50:43.296 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:50:44.858 [cache-112] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:50:44.858 [cache-111] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 10:55:41.234 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:55:43.327 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 10:55:44.891 [cache-114] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 10:55:44.891 [cache-113] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:00:41.239 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:00:43.325 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:00:44.902 [cache-115] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:00:44.902 [cache-116] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:05:41.238 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:05:43.324 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:05:44.913 [cache-118] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:05:44.912 [cache-117] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:10:41.239 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:10:43.329 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:10:44.923 [cache-120] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:10:44.923 [cache-119] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:15:41.243 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:15:43.330 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:15:44.932 [cache-121] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:15:44.933 [cache-122] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:16:44.490 [MessageBroker-8] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 27], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 5, completed tasks = 4464]
2025-08-15 11:20:41.241 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:20:43.324 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:20:44.939 [cache-124] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:20:44.940 [cache-123] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:25:41.185 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:25:43.266 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:25:44.892 [cache-125] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:25:44.893 [cache-126] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:30:41.181 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:30:43.268 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:30:44.895 [cache-128] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:30:44.895 [cache-127] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:34:54.072 [http-nio-8081-exec-1] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket连接断开 - 会话ID: 34ynpute
2025-08-15 11:39:31.325 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m46s266ms).
2025-08-15 11:39:31.802 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m46s265ms).
2025-08-15 11:40:34.675 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m47s331ms).
2025-08-15 11:40:35.125 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m47s333ms).
2025-08-15 11:48:07.895 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:48:09.981 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:48:11.612 [cache-129] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:48:11.612 [cache-130] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:48:11.791 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m40s467ms).
2025-08-15 11:48:12.267 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m40s465ms).
2025-08-15 11:48:14.074 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=7m39s400ms).
2025-08-15 11:48:14.524 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=7m39s399ms).
2025-08-15 11:53:07.891 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:53:09.978 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:53:11.610 [cache-131] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:53:11.610 [cache-132] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:58:07.884 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:58:09.973 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 11:58:11.610 [cache-133] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 11:58:11.609 [cache-134] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 11:59:11.139 [MessageBroker-10] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 1 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 30], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 3], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 4, completed tasks = 4880]
2025-08-15 12:03:07.882 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:03:09.969 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:03:11.606 [cache-136] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:03:11.606 [cache-135] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:08:07.865 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:08:09.952 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:08:11.590 [cache-137] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:08:11.590 [cache-138] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:13:07.861 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:13:09.943 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:13:11.588 [cache-140] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:13:11.588 [cache-139] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:18:07.856 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:18:09.942 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:18:11.592 [cache-142] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:18:11.593 [cache-141] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:23:07.893 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:23:09.983 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:23:11.633 [cache-143] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:23:11.633 [cache-144] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:28:07.894 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:28:09.982 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:28:11.636 [cache-145] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:28:11.636 [cache-146] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:29:11.154 [MessageBroker-11] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 1 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 30], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 3], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 4, completed tasks = 5254]
2025-08-15 12:40:39.008 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m26s933ms).
2025-08-15 12:40:39.520 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m26s932ms).
2025-08-15 12:40:41.318 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m26s934ms).
2025-08-15 12:40:41.775 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m26s934ms).
2025-08-15 12:41:04.821 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:41:06.910 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:41:08.566 [cache-147] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:41:08.566 [cache-148] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:46:04.842 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:46:06.929 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:46:08.590 [cache-150] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:46:08.590 [cache-149] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:51:04.840 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:51:06.928 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:51:08.592 [cache-151] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:51:08.593 [cache-152] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 12:56:04.841 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:56:06.927 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 12:56:08.594 [cache-154] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 12:56:08.594 [cache-153] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:01:04.841 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:01:06.925 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:01:08.598 [cache-155] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:01:08.599 [cache-156] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:06:21.763 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m42s564ms).
2025-08-15 13:06:22.282 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m42s564ms).
2025-08-15 13:06:24.078 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m42s561ms).
2025-08-15 13:06:24.552 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m42s564ms).
2025-08-15 13:07:17.399 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:07:19.487 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:07:21.163 [cache-157] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:07:21.163 [cache-158] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:08:20.663 [MessageBroker-11] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 1 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 30], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 3], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 4, completed tasks = 5627]
2025-08-15 13:12:17.400 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:12:19.487 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:12:21.163 [cache-159] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:12:21.163 [cache-160] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:28:43.673 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m51s874ms).
2025-08-15 13:28:44.209 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m51s875ms).
2025-08-15 13:28:45.996 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m51s876ms).
2025-08-15 13:28:46.476 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m51s874ms).
2025-08-15 13:32:50.084 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m6s411ms).
2025-08-15 13:32:50.619 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m6s410ms).
2025-08-15 13:32:52.403 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m6s407ms).
2025-08-15 13:32:52.884 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m6s408ms).
2025-08-15 13:36:15.670 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:36:17.758 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:36:19.442 [cache-161] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:36:19.442 [cache-162] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:41:15.669 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:41:17.758 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:41:19.448 [cache-164] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:41:19.448 [cache-163] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:46:15.693 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:46:17.781 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:46:19.473 [cache-166] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:46:19.473 [cache-165] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:51:15.691 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:51:17.782 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:51:19.479 [cache-167] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:51:19.479 [cache-168] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:56:15.696 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:56:17.782 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 13:56:19.485 [cache-170] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 13:56:19.484 [cache-169] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 13:57:18.961 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 1 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 30], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 3], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 4, completed tasks = 6001]
2025-08-15 14:01:15.645 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:01:17.734 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:01:19.441 [cache-171] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 14:01:19.442 [cache-172] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 14:03:00.576 [clientOutboundChannel-4] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket连接建立 - 会话ID: uhmhal3y
2025-08-15 14:03:00.578 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: uhmhal3y, 目标: /topic/public
2025-08-15 14:03:00.578 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: uhmhal3y, 目标: /user/queue/private-messages
2025-08-15 14:03:00.578 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: uhmhal3y, 目标: /topic/system
2025-08-15 14:03:00.578 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: uhmhal3y, 目标: /user/queue/auth
2025-08-15 14:03:00.579 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: uhmhal3y, 目标: /user/queue/heartbeat
2025-08-15 14:03:00.579 [http-nio-8081-exec-5] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket订阅 - 会话ID: uhmhal3y, 目标: /user/queue/status
2025-08-15 14:03:00.581 [clientInboundChannel-52] INFO  c.a.i.c.websocket.WebSocketMessageHandler - 收到认证消息: [123, 34, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 97, 117, 116, 104, 95, 49, 55, 53, 53, 50, 52, 49, 51, 56, 48, 53, 55, 55, 34, 44, 34, 116, 121, 112, 101, 34, 58, 49, 48, 44, 34, 115, 116, 97, 116, 117, 115, 34, 58, 48, 44, 34, 115, 101, 110, 100, 101, 114, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 117, 115, 101, 114, 34, 44, 34, 114, 101, 99, 101, 105, 118, 101, 114, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 99, 111, 110, 118, 101, 114, 115, 97, 116, 105, 111, 110, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 116, 105, 109, 101, 115, 116, 97, 109, 112, 34, 58, 49, 55, 53, 53, 50, 52, 49, 51, 56, 48, 53, 55, 55, 44, 34, 115, 101, 113, 117, 101, 110, 99, 101, 34, 58, 48, 44, 34, 99, 108, 105, 101, 110, 116, 95, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 97, 117, 116, 104, 95, 49, 55, 53, 53, 50, 52, 49, 51, 56, 48, 53, 55, 55, 34, 44, 34, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 46, 48, 34, 44, 34, 97, 117, 116, 104, 34, 58, 123, 34, 116, 111, 107, 101, 110, 34, 58, 34, 101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 73, 85, 122, 73, 49, 78, 105, 74, 57, 46, 101, 121, 74, 48, 101, 88, 66, 108, 73, 106, 111, 105, 89, 87, 78, 106, 90, 88, 78, 122, 73, 105, 119, 105, 90, 71, 86, 50, 97, 87, 78, 108, 83, 87, 81, 105, 79, 105, 74, 48, 90, 88, 78, 48, 88, 50, 82, 108, 100, 109, 108, 106, 90, 86, 56, 119, 77, 68, 69, 105, 76, 67, 74, 122, 100, 87, 73, 105, 79, 105, 74, 106, 89, 50, 78, 106, 73, 105, 119, 105, 97, 88, 78, 122, 73, 106, 111, 105, 83, 85, 48, 116, 85, 51, 108, 122, 100, 71, 86, 116, 73, 105, 119, 105, 89, 88, 86, 107, 73, 106, 112, 98, 73, 109, 108, 116, 76, 88, 86, 122, 90, 88, 74, 122, 73, 108, 48, 115, 73, 109, 108, 104, 100, 67, 73, 54, 77, 84, 99, 49, 78, 84, 73, 119, 77, 122, 107, 52, 77, 105, 119, 105, 90, 88, 104, 119, 73, 106, 111, 120, 78, 122, 85, 49, 77, 106, 65, 51, 78, 84, 103, 121, 102, 81, 46, 121, 118, 54, 56, 66, 117, 53, 117, 101, 77, 51, 70, 56, 122, 110, 111, 97, 48, 75, 54, 81, 75, 79, 53, 76, 69, 116, 72, 119, 115, 57, 114, 111, 83, 82, 51, 111, 100, 114, 97, 122, 67, 65, 34, 44, 34, 117, 115, 101, 114, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 117, 115, 101, 114, 34, 44, 34, 100, 101, 118, 105, 99, 101, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 100, 101, 118, 105, 99, 101, 95, 48, 48, 49, 34, 44, 34, 97, 117, 116, 104, 95, 100, 97, 116, 97, 34, 58, 34, 34, 125, 125]
2025-08-15 14:03:05.907 [clientInboundChannel-55] DEBUG c.a.i.c.websocket.WebSocketMessageHandler - 收到心跳消息: [123, 34, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 109, 115, 103, 95, 50, 95, 49, 55, 53, 53, 50, 52, 49, 51, 56, 53, 57, 48, 50, 34, 44, 34, 116, 121, 112, 101, 34, 58, 50, 44, 34, 115, 116, 97, 116, 117, 115, 34, 58, 48, 44, 34, 115, 101, 110, 100, 101, 114, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 117, 115, 101, 114, 34, 44, 34, 114, 101, 99, 101, 105, 118, 101, 114, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 99, 111, 110, 118, 101, 114, 115, 97, 116, 105, 111, 110, 95, 105, 100, 34, 58, 110, 117, 108, 108, 44, 34, 116, 105, 109, 101, 115, 116, 97, 109, 112, 34, 58, 49, 55, 53, 53, 50, 52, 49, 51, 56, 53, 57, 48, 50, 44, 34, 115, 101, 113, 117, 101, 110, 99, 101, 34, 58, 50, 44, 34, 99, 108, 105, 101, 110, 116, 95, 109, 101, 115, 115, 97, 103, 101, 95, 105, 100, 34, 58, 34, 99, 108, 105, 101, 110, 116, 95, 50, 95, 49, 55, 53, 53, 50, 52, 49, 51, 56, 53, 57, 48, 50, 34, 44, 34, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 46, 48, 34, 44, 34, 104, 101, 97, 114, 116, 98, 101, 97, 116, 34, 58, 123, 34, 104, 101, 97, 114, 116, 98, 101, 97, 116, 95, 105, 100, 34, 58, 34, 104, 98, 95, 49, 55, 53, 53, 50, 52, 49, 51, 56, 53, 57, 48, 50, 34, 44, 34, 100, 101, 118, 105, 99, 101, 95, 105, 100, 34, 58, 34, 116, 101, 115, 116, 95, 100, 101, 118, 105, 99, 101, 95, 48, 48, 49, 34, 44, 34, 104, 101, 97, 114, 116, 98, 101, 97, 116, 95, 100, 97, 116, 97, 34, 58, 34, 34, 125, 125]
2025-08-15 14:03:17.554 [SpringApplicationShutdownHook] INFO  c.a.i.c.websocket.WebSocketEventListener - WebSocket连接断开 - 会话ID: uhmhal3y
2025-08-15 14:03:17.554 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-08-15 14:03:17.554 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3cfd9459]]
2025-08-15 14:03:17.554 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-08-15 14:03:17.678 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 14:03:17.792 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 14:03:17.793 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 14:03:17.793 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 14:03:17.793 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 14:03:17.793 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 14:03:17.793 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 14:03:17.793 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 14:03:17.798 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 14:03:17.798 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 14:03:17.798 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 14:03:17.799 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=5
2025-08-15 14:03:22.519 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 66084 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:03:22.520 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:03:22.520 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:03:22.598 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanDefinitionStoreException: Failed to parse configuration class [com.acme.im.communication.CommunicationServiceApplication]
2025-08-15 14:03:22.626 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanDefinitionStoreException: Failed to parse configuration class [com.acme.im.communication.CommunicationServiceApplication]
	at org.springframework.context.annotation.ConfigurationClassParser.parse(ConfigurationClassParser.java:179)
	at org.springframework.context.annotation.ConfigurationClassPostProcessor.processConfigBeanDefinitions(ConfigurationClassPostProcessor.java:417)
	at org.springframework.context.annotation.ConfigurationClassPostProcessor.postProcessBeanDefinitionRegistry(ConfigurationClassPostProcessor.java:290)
	at org.springframework.context.support.PostProcessorRegistrationDelegate.invokeBeanDefinitionRegistryPostProcessors(PostProcessorRegistrationDelegate.java:349)
	at org.springframework.context.support.PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(PostProcessorRegistrationDelegate.java:118)
	at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:789)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:607)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: org.springframework.context.annotation.ConflictingBeanDefinitionException: Annotation-specified bean name 'databaseConfig' for bean class [com.acme.im.common.infrastructure.database.config.DatabaseConfig] conflicts with existing, non-compatible bean definition of same name and class [com.acme.im.common.config.modules.DatabaseConfig]
	at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.checkCandidate(ClassPathBeanDefinitionScanner.java:361)
	at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.doScan(ClassPathBeanDefinitionScanner.java:288)
	at org.springframework.context.annotation.ComponentScanAnnotationParser.parse(ComponentScanAnnotationParser.java:128)
	at org.springframework.context.annotation.ConfigurationClassParser.doProcessConfigurationClass(ConfigurationClassParser.java:306)
	at org.springframework.context.annotation.ConfigurationClassParser.processConfigurationClass(ConfigurationClassParser.java:246)
	at org.springframework.context.annotation.ConfigurationClassParser.parse(ConfigurationClassParser.java:197)
	at org.springframework.context.annotation.ConfigurationClassParser.parse(ConfigurationClassParser.java:165)
	... 13 common frames omitted
2025-08-15 14:03:44.169 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 14:03:44.809 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 14:03:44.811 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 14:03:44.811 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 14:03:44.812 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 14:03:44.812 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 14:03:44.813 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 14:03:44.813 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 14:03:44.822 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 14:03:44.822 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 14:03:44.822 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 14:03:44.824 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 14:03:47.019 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 66173 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:03:47.019 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:03:47.020 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:03:47.097 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanDefinitionStoreException: Failed to parse configuration class [com.acme.im.business.BusinessServiceApplication]
2025-08-15 14:03:47.113 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanDefinitionStoreException: Failed to parse configuration class [com.acme.im.business.BusinessServiceApplication]
	at org.springframework.context.annotation.ConfigurationClassParser.parse(ConfigurationClassParser.java:179)
	at org.springframework.context.annotation.ConfigurationClassPostProcessor.processConfigBeanDefinitions(ConfigurationClassPostProcessor.java:417)
	at org.springframework.context.annotation.ConfigurationClassPostProcessor.postProcessBeanDefinitionRegistry(ConfigurationClassPostProcessor.java:290)
	at org.springframework.context.support.PostProcessorRegistrationDelegate.invokeBeanDefinitionRegistryPostProcessors(PostProcessorRegistrationDelegate.java:349)
	at org.springframework.context.support.PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(PostProcessorRegistrationDelegate.java:118)
	at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:789)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:607)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.business.BusinessServiceApplication.main(BusinessServiceApplication.java:17)
Caused by: org.springframework.context.annotation.ConflictingBeanDefinitionException: Annotation-specified bean name 'databaseConfig' for bean class [com.acme.im.common.infrastructure.database.config.DatabaseConfig] conflicts with existing, non-compatible bean definition of same name and class [com.acme.im.common.config.modules.DatabaseConfig]
	at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.checkCandidate(ClassPathBeanDefinitionScanner.java:361)
	at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.doScan(ClassPathBeanDefinitionScanner.java:288)
	at org.springframework.context.annotation.ComponentScanAnnotationParser.parse(ComponentScanAnnotationParser.java:128)
	at org.springframework.context.annotation.ConfigurationClassParser.doProcessConfigurationClass(ConfigurationClassParser.java:306)
	at org.springframework.context.annotation.ConfigurationClassParser.processConfigurationClass(ConfigurationClassParser.java:246)
	at org.springframework.context.annotation.ConfigurationClassParser.parse(ConfigurationClassParser.java:197)
	at org.springframework.context.annotation.ConfigurationClassParser.parse(ConfigurationClassParser.java:165)
	... 13 common frames omitted
2025-08-15 14:07:47.847 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 67164 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:07:47.848 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:07:47.848 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:07:48.135 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:07:48.136 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:07:48.142 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:07:48.291 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:07:48.291 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:07:48.296 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 14:07:48.691 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 14:07:48.695 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:07:48.695 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:07:48.716 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:07:48.716 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 853 ms
2025-08-15 14:07:48.818 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:07:48.824 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 14:07:48.841 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 14:07:48.876 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 14:07:48.893 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 14:07:48.894 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 14:07:48.897 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 14:07:48.897 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 14:07:48.898 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 14:07:48.898 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 14:07:48.965 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 14:07:48.967 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 14:07:49.229 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 14:07:49.295 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 14:07:49.299 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 14:07:49.317 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 14:07:49.318 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 14:07:49.318 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 14:07:49.318 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 14:07:49.318 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 14:07:49.319 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 14:07:49.325 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 14:07:49.325 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 14:07:49.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 14:07:49.328 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 14:07:49.339 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 14:07:49.339 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 14:07:49.339 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 14:07:49.341 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 14:07:49.341 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 14:07:49.341 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 14:07:49.488 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 14:07:49.488 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 14:07:49.495 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 14:07:49.678 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 14:07:49.699 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 14:07:49.700 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 14:07:49.701 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 14:07:49.701 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@2360ebe2[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:07:49.703 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 14:07:49.704 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 14:07:49.710 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 14:07:49.710 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@64abb917[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:07:49.711 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 14:07:49.711 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@5f0c45ae[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:07:49.712 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 14:07:49.713 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@f1b006b[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:07:49.714 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 14:07:49.714 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@1131fcfd[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:07:49.715 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 14:07:49.715 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@119de68f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:07:49.826 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 14:07:49.838 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 14:07:49.838 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 14:07:49.846 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 14:07:49.846 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 14:07:49.846 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 14:07:49.908 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 14:07:49.963 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 14:07:50.089 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7d6f31ef, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@43051a8d, org.springframework.security.web.context.SecurityContextHolderFilter@33e09baf, org.springframework.security.web.header.HeaderWriterFilter@3bad0efd, org.springframework.web.filter.CorsFilter@70916715, com.acme.im.common.security.jwt.JwtAuthenticationFilter@7e94de5f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@57be28d1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1b58788a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@72d4d9ac, org.springframework.security.web.session.SessionManagementFilter@64a9719a, org.springframework.security.web.access.ExceptionTranslationFilter@10e28d97, org.springframework.security.web.access.intercept.AuthorizationFilter@5e9c6d8a]
2025-08-15 14:07:50.411 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 14:07:50.411 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 14:07:50.411 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 14:07:50.411 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 14:07:50.412 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 14:07:50.414 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 15 个处理器
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 14:07:50.414 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 14:07:50.415 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 14:07:50.416 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 14:07:50.416 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 14:07:50.416 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 14:07:50.416 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 14:07:50.416 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 14:07:50.416 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 14:07:50.416 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 14:07:50.429 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:07:50.429 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:07:50.430 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:07:50.430 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:07:50.439 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 14:07:50.446 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.772 seconds (process running for 2.953)
2025-08-15 14:07:50.448 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 14:07:50.449 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 14:07:50.449 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 14:07:50.449 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 14:07:50.449 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 14:07:50.450 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 14:07:50.451 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 14:07:50.452 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 14:07:50.452 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 27/27 个主题
2025-08-15 14:07:50.452 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated]
2025-08-15 14:07:50.453 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 14:07:50.636 [RMI TCP Connection(3)-127.0.0.1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 14:07:50.636 [RMI TCP Connection(3)-127.0.0.1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 14:07:50.637 [RMI TCP Connection(3)-127.0.0.1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 14:07:54.228 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 67184 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:07:54.230 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:07:54.230 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:07:54.544 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:07:54.545 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:07:54.551 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:07:54.720 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:07:54.720 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:07:54.722 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:07:54.758 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:07:55.131 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:07:55.135 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:07:55.136 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:07:55.157 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:07:55.157 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 908 ms
2025-08-15 14:07:55.264 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:07:55.269 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:07:55.269 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:07:55.269 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:07:55.269 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:07:55.285 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 14:07:55.285 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 14:07:55.286 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 14:07:55.302 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 14:07:55.339 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 14:07:55.355 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 14:07:55.356 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 14:07:55.373 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 14:07:55.378 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 14:07:55.456 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 14:07:55.457 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 14:07:55.457 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 14:07:55.457 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 14:07:55.463 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 14:07:55.463 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 14:07:55.538 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 14:07:55.771 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'messageRoutingService': Unsatisfied dependency expressed through field 'messageService': Error creating bean with name 'messageService' defined in file [/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes/com/acme/im/communication/service/MessageService.class]: Unsatisfied dependency expressed through constructor parameter 4: Error creating bean with name 'messageRoutingService': Requested bean is currently in creation: Is there an unresolvable circular reference?
2025-08-15 14:07:55.884 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 14:07:55.884 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 14:07:55.884 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 14:07:55.886 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 14:07:55.887 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 14:07:55.896 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 14:07:55.905 [main] ERROR o.s.b.diagnostics.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

The dependencies of some of the beans in the application context form a cycle:

┌─────┐
|  messageRoutingService (field private com.acme.im.communication.service.MessageService com.acme.im.communication.service.MessageRoutingService.messageService)
↑     ↓
|  messageService defined in file [/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes/com/acme/im/communication/service/MessageService.class]
└─────┘


Action:

Relying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.

2025-08-15 14:12:34.637 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 68225 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:12:34.638 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:12:34.638 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:12:34.942 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:12:34.942 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:12:34.947 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:12:35.104 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:12:35.105 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:12:35.106 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:12:35.141 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:12:35.509 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:12:35.514 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:12:35.514 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:12:35.536 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:12:35.536 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 881 ms
2025-08-15 14:12:35.641 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:12:35.646 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:12:35.646 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:12:35.646 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:12:35.646 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:12:35.647 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'communicationEventConfig' defined in file [/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes/com/acme/im/communication/config/CommunicationEventConfig.class]: Failed to instantiate [com.acme.im.communication.config.CommunicationEventConfig$$SpringCGLIB$$0]: Constructor threw exception
2025-08-15 14:12:35.648 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 14:12:35.656 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 14:12:35.662 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'communicationEventConfig' defined in file [/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes/com/acme/im/communication/config/CommunicationEventConfig.class]: Failed to instantiate [com.acme.im.communication.config.CommunicationEventConfig$$SpringCGLIB$$0]: Constructor threw exception
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1337)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:971)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.acme.im.communication.config.CommunicationEventConfig$$SpringCGLIB$$0]: Constructor threw exception
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:221)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:94)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1331)
	... 17 common frames omitted
Caused by: java.lang.Error: Unresolved compilation problems: 
	The import com.acme.im.common.infrastructure cannot be resolved
	The import com.acme.im.common.infrastructure cannot be resolved
	EventSubscriber cannot be resolved to a type
	EventTopicManager cannot be resolved
	EventTopicManager cannot be resolved to a variable
	EventSubscriber cannot be resolved to a type

	at com.acme.im.communication.config.CommunicationEventConfig.<init>(CommunicationEventConfig.java:3)
	at com.acme.im.communication.config.CommunicationEventConfig$$SpringCGLIB$$0.<init>(<generated>)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480)
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:195)
	... 19 common frames omitted
2025-08-15 14:12:49.701 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:13:46.350 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 68473 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:13:46.350 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:13:46.351 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:13:46.658 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:13:46.658 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:13:46.664 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:13:46.827 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:13:46.827 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:13:46.829 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:13:46.868 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:13:47.230 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:13:47.235 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:13:47.235 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:13:47.255 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:13:47.255 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 888 ms
2025-08-15 14:13:47.361 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:13:47.366 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:13:47.366 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:13:47.366 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:13:47.366 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:13:47.367 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'communicationPluginConfig' defined in file [/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes/com/acme/im/communication/config/CommunicationPluginConfig.class]: Failed to instantiate [com.acme.im.communication.config.CommunicationPluginConfig$$SpringCGLIB$$0]: Constructor threw exception
2025-08-15 14:13:47.368 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 14:13:47.377 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 14:13:47.382 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'communicationPluginConfig' defined in file [/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes/com/acme/im/communication/config/CommunicationPluginConfig.class]: Failed to instantiate [com.acme.im.communication.config.CommunicationPluginConfig$$SpringCGLIB$$0]: Constructor threw exception
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1337)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:971)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.acme.im.communication.config.CommunicationPluginConfig$$SpringCGLIB$$0]: Constructor threw exception
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:221)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:94)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1331)
	... 17 common frames omitted
Caused by: java.lang.Error: Unresolved compilation problems: 
	The import com.acme.im.common.plugin cannot be resolved
	The import com.acme.im.common.plugin cannot be resolved
	ExtensionPointManager cannot be resolved to a type
	ExtensionPointManager cannot be resolved to a type
	ExtensionPointRegistry cannot be resolved to a variable
	ExtensionPointManager cannot be resolved to a type
	ExtensionPointRegistry cannot be resolved to a variable
	ExtensionPointManager cannot be resolved to a type
	ExtensionPointRegistry cannot be resolved to a variable
	ExtensionPointManager cannot be resolved to a type
	ExtensionPointRegistry cannot be resolved to a variable
	ExtensionPointManager cannot be resolved to a type
	ExtensionPointRegistry cannot be resolved to a variable

	at com.acme.im.communication.config.CommunicationPluginConfig.<init>(CommunicationPluginConfig.java:3)
	at com.acme.im.communication.config.CommunicationPluginConfig$$SpringCGLIB$$0.<init>(<generated>)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480)
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:195)
	... 19 common frames omitted
2025-08-15 14:13:49.703 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 14:14:55.364 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 68714 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:14:55.365 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:14:55.365 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:14:55.680 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:14:55.680 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:14:55.688 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 14:14:55.840 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:14:55.841 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:14:55.842 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:14:55.878 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:14:56.244 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:14:56.248 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:14:56.248 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:14:56.268 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:14:56.268 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 881 ms
2025-08-15 14:14:56.376 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:14:56.382 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:14:56.383 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:14:56.383 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:14:56.383 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:14:56.385 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 14:14:56.385 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成
2025-08-15 14:14:56.390 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'testController': Resolution of declared constructors on bean Class [com.acme.im.communication.controller.TestController] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
2025-08-15 14:14:56.391 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 14:14:56.401 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 14:14:56.407 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'testController': Resolution of declared constructors on bean Class [com.acme.im.communication.controller.TestController] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:383)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1209)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:971)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: java.lang.NoClassDefFoundError: AsyncEventPublisher
	at java.base/java.lang.Class.getDeclaredConstructors0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredConstructors(Class.java:3373)
	at java.base/java.lang.Class.getDeclaredConstructors(Class.java:2555)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:378)
	... 18 common frames omitted
Caused by: java.lang.ClassNotFoundException: AsyncEventPublisher
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)
	... 22 common frames omitted
2025-08-15 14:16:02.815 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 68993 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:16:02.815 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:16:02.816 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:16:03.140 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:16:03.140 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:16:03.147 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 14:16:03.324 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:16:03.324 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:16:03.326 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 14:16:03.368 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:16:03.759 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:16:03.763 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:16:03.764 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:16:03.782 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:16:03.783 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 950 ms
2025-08-15 14:16:03.888 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:16:03.892 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:16:03.892 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:16:03.892 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:16:03.892 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:16:03.894 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 14:16:03.894 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成
2025-08-15 14:16:03.899 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'communicationEventHandler': Lookup method resolution failed
2025-08-15 14:16:03.900 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 14:16:03.910 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 14:16:03.915 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'communicationEventHandler': Lookup method resolution failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:497)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:367)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1209)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:971)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: java.lang.IllegalStateException: Failed to introspect Class [com.acme.im.communication.event.CommunicationEventHandler] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7]
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:483)
	at org.springframework.util.ReflectionUtils.doWithLocalMethods(ReflectionUtils.java:320)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:475)
	... 19 common frames omitted
Caused by: java.lang.NoClassDefFoundError: BaseEvent
	at java.base/java.lang.Class.getDeclaredMethods0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredMethods(Class.java:3402)
	at java.base/java.lang.Class.getDeclaredMethods(Class.java:2504)
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:465)
	... 21 common frames omitted
Caused by: java.lang.ClassNotFoundException: BaseEvent
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)
	... 25 common frames omitted
2025-08-15 14:16:51.530 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 69186 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:16:51.531 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:16:51.531 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:16:51.870 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:16:51.870 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:16:51.877 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 14:16:52.064 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:16:52.065 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:16:52.067 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:16:52.110 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:16:52.524 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:16:52.529 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:16:52.529 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:16:52.552 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:16:52.552 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1000 ms
2025-08-15 14:16:52.673 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:16:52.678 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:16:52.678 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:16:52.678 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:16:52.678 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:16:52.680 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 14:16:52.680 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成
2025-08-15 14:16:52.684 [main] INFO  c.a.i.c.event.CommunicationEventHandler - 通信服务事件处理器初始化完成
2025-08-15 14:16:52.685 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'messageEventPublisher': Resolution of declared constructors on bean Class [com.acme.im.communication.event.MessageEventPublisher] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
2025-08-15 14:16:52.686 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 14:16:52.696 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 14:16:52.702 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'messageEventPublisher': Resolution of declared constructors on bean Class [com.acme.im.communication.event.MessageEventPublisher] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7] failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:383)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1209)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:971)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: java.lang.NoClassDefFoundError: AsyncEventPublisher
	at java.base/java.lang.Class.getDeclaredConstructors0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredConstructors(Class.java:3373)
	at java.base/java.lang.Class.getDeclaredConstructors(Class.java:2555)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:378)
	... 18 common frames omitted
Caused by: java.lang.ClassNotFoundException: AsyncEventPublisher
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)
	... 22 common frames omitted
2025-08-15 14:17:49.701 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:18:17.929 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 69488 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:18:17.930 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:18:17.930 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:18:18.237 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:18:18.237 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:18:18.243 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:18:18.482 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:18:18.552 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:18:18.554 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-08-15 14:18:18.593 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:18:18.958 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:18:18.962 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:18:18.962 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:18:18.981 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:18:18.982 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1035 ms
2025-08-15 14:18:19.087 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:18:19.092 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:18:19.092 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:18:19.092 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:18:19.092 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:18:19.093 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 14:18:19.093 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成
2025-08-15 14:18:19.097 [main] INFO  c.a.i.c.event.CommunicationEventHandler - 通信服务事件处理器初始化完成
2025-08-15 14:18:19.098 [main] INFO  c.a.im.communication.event.MessageEventPublisher - 消息事件发布器初始化完成
2025-08-15 14:18:19.099 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'tokenValidationResponseHandler': Lookup method resolution failed
2025-08-15 14:18:19.100 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-15 14:18:19.108 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-15 14:18:19.114 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'tokenValidationResponseHandler': Lookup method resolution failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:497)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:367)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1209)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:971)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.acme.im.communication.CommunicationServiceApplication.main(CommunicationServiceApplication.java:43)
Caused by: java.lang.IllegalStateException: Failed to introspect Class [com.acme.im.communication.event.TokenValidationResponseHandler] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@251a69d7]
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:483)
	at org.springframework.util.ReflectionUtils.doWithLocalMethods(ReflectionUtils.java:320)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:475)
	... 19 common frames omitted
Caused by: java.lang.NoClassDefFoundError: BaseEvent
	at java.base/java.lang.Class.getDeclaredMethods0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredMethods(Class.java:3402)
	at java.base/java.lang.Class.getDeclaredMethods(Class.java:2504)
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:465)
	... 21 common frames omitted
Caused by: java.lang.ClassNotFoundException: BaseEvent
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)
	... 25 common frames omitted
2025-08-15 14:23:24.517 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m5s145ms).
2025-08-15 14:23:24.981 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m5s147ms).
2025-08-15 14:28:51.912 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m27s396ms).
2025-08-15 14:28:52.376 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m27s395ms).
2025-08-15 14:29:22.365 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:30:17.770 [main] INFO  c.a.i.c.CommunicationServiceApplication - Starting CommunicationServiceApplication using Java 17.0.14 with PID 70718 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/communication-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:30:17.771 [main] DEBUG c.a.i.c.CommunicationServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:30:17.771 [main] INFO  c.a.i.c.CommunicationServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:30:18.075 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:30:18.075 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:30:18.081 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:30:18.238 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:30:18.239 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:30:18.240 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:30:18.276 [main] WARN  org.mybatis.spring.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.acme.im.communication]' package. Please check your configuration.
2025-08-15 14:30:18.637 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-08-15 14:30:18.642 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:30:18.642 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:30:18.662 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:30:18.663 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 875 ms
2025-08-15 14:30:18.764 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:30:18.769 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 通信服务数据源配置初始化完成
2025-08-15 14:30:18.769 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig - 数据源策略: 读写分离
2025-08-15 14:30:18.769 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 读操作: 从库(SECONDARY)
2025-08-15 14:30:18.769 [main] INFO  c.a.i.c.config.CommunicationDataSourceConfig -   - 写操作: 主库(PRIMARY)
2025-08-15 14:30:18.784 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 开始注册通信层扩展点...
2025-08-15 14:30:18.784 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 14:30:18.784 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.route, strategy=FIRST_SUCCESS, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=message.process, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.before.process, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.after.process, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointRegistry - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  com.acme.im.common.plugin.ExtensionPointManager - 注册扩展点: name=websocket.message.on.error, strategy=ALL, required=false
2025-08-15 14:30:18.785 [main] INFO  c.a.i.c.config.CommunicationPluginConfig - 通信层扩展点注册完成，共注册 5 个扩展点
2025-08-15 14:30:18.800 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 14:30:18.837 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 14:30:18.853 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 14:30:18.854 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 14:30:18.869 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 14:30:18.870 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 14:30:18.999 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 14:30:19.168 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 14:30:19.172 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 14:30:19.187 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 14:30:19.188 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 14:30:19.188 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 14:30:19.188 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 14:30:19.188 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 14:30:19.190 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 14:30:19.190 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 跳过Bean扫描: configHotReload
2025-08-15 14:30:19.194 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: secondary
2025-08-15 14:30:19.194 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 通信服务初始化完成，默认使用从库数据源
2025-08-15 14:30:19.194 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 14:30:19.201 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 14:30:19.210 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 14:30:19.210 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 14:30:19.210 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 14:30:19.212 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 14:30:19.212 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 14:30:19.212 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 14:30:19.280 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-08-15 14:30:19.365 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 14:30:19.365 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 14:30:19.375 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 14:30:19.568 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 14:30:19.593 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 14:30:19.593 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 14:30:19.595 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 14:30:19.595 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@60eb9c29[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:19.597 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 14:30:19.597 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 14:30:19.645 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 14:30:19.645 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3a4e6da6[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:19.646 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 14:30:19.647 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@70eced1f[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:19.648 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 14:30:19.648 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@4ca83ec3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:19.649 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 14:30:19.649 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@10c11e36[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:19.650 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 14:30:19.650 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@10f64bc3[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:19.758 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 14:30:19.772 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 14:30:19.772 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 14:30:19.781 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 14:30:19.781 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 14:30:19.781 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 14:30:19.846 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 14:30:19.907 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 14:30:20.013 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@55145dc5, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7dcfe455, org.springframework.security.web.context.SecurityContextHolderFilter@60b721c9, org.springframework.security.web.header.HeaderWriterFilter@4df5b562, org.springframework.web.filter.CorsFilter@2e6066e1, com.acme.im.common.security.jwt.JwtAuthenticationFilter@7a021f49, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4b1339bf, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5f3705e7, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2338c3f9, org.springframework.security.web.session.SessionManagementFilter@64b6d6dd, org.springframework.security.web.access.ExceptionTranslationFilter@29e40db1, org.springframework.security.web.access.intercept.AuthorizationFilter@34bcdc9f]
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.sent, handler=CommunicationEventHandler.handleMessageSent, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.received, handler=CommunicationEventHandler.handleMessageReceived, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.recalled, handler=CommunicationEventHandler.handleMessageRecalled, priority=200, async=true
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.edited, handler=CommunicationEventHandler.handleMessageEdited, priority=200, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.message.read, handler=CommunicationEventHandler.handleMessageRead, priority=150, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.closed, handler=CommunicationEventHandler.handleConnectionClosed, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.heartbeat, handler=CommunicationEventHandler.handleHeartbeat, priority=300, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.sent, handler=CommunicationEventHandler.handlePushSent, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.push.delivered, handler=CommunicationEventHandler.handlePushDelivered, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.user.profile.sync, handler=CommunicationEventHandler.handleUserProfileSync, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.user.status.sync, handler=CommunicationEventHandler.handleUserStatusSync, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=CommunicationEventHandler.onBusinessUserLogin, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=CommunicationEventHandler.onBusinessUserLogout, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=CommunicationEventHandler.onBusinessGroupCreated, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=CommunicationEventHandler.onBusinessFriendAdded, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.connection.established, handler=CommunicationEventHandler.handleConnectionEstablished, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=CommunicationEventHandler.onBusinessUserStatusChanged, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=CommunicationEventHandler.onBusinessUserProfileUpdated, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=CommunicationEventHandler.onBusinessConversationCreated, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=CommunicationEventHandler.onBusinessConversationUpdated, priority=100, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=communication.*, handler=CommunicationEventHandler.handleAllCommunicationEvents, priority=999, async=false
2025-08-15 14:30:20.337 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationResponseHandler.handleTokenValidationResponse, priority=100, async=false
2025-08-15 14:30:20.339 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 22 个处理器
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 14:30:20.340 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 14:30:20.341 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 14:30:20.342 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 14:30:20.342 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 14:30:20.342 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 14:30:20.342 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 14:30:20.342 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 14:30:20.342 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 14:30:20.342 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 14:30:20.342 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 14:30:20.357 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 14:30:20.357 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 14:30:20.359 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 14:30:20.359 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: secondary
2025-08-15 14:30:20.369 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
2025-08-15 14:30:20.369 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-08-15 14:30:20.369 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@39b8313d]]
2025-08-15 14:30:20.370 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-08-15 14:30:20.377 [main] INFO  c.a.i.c.CommunicationServiceApplication - Started CommunicationServiceApplication in 2.768 seconds (process running for 2.946)
2025-08-15 14:30:20.381 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 14:30:20.381 [cache-2] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=0, completed=0, failed=0, queue=0, hits=0, rate=0.00%}
2025-08-15 14:30:20.382 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 14:30:20.382 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 14:30:20.383 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 14:30:20.383 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置初始化开始...
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.message.*
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.message.*, sid=communication.message.*
2025-08-15 14:30:20.383 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.connection.*
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.connection.*, sid=communication.connection.*
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.push.*
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.push.*, sid=communication.push.*
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: communication.sync.*
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=communication.sync.*, sid=communication.sync.*
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 14:30:20.384 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 14:30:20.385 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.validate
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.validate, sid=security.token.validate
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.refresh
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.refresh, sid=security.token.refresh
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.token.revoke
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.token.revoke, sid=security.token.revoke
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.auth.failed
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.auth.failed, sid=security.auth.failed
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: security.permission.denied
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=security.permission.denied, sid=security.permission.denied
2025-08-15 14:30:20.386 [main] INFO  c.a.i.c.config.CommunicationEventConfig - 通信服务事件配置启动成功，成功订阅 35/35 个主题
2025-08-15 14:30:20.386 [main] DEBUG c.a.i.c.config.CommunicationEventConfig - 已订阅的主题: [communication.message.*, communication.connection.*, communication.push.*, communication.sync.*, business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, security.token.validate, security.token.refresh, security.token.revoke, security.auth.failed, security.permission.denied]
2025-08-15 14:30:20.387 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 14:30:20.555 [RMI TCP Connection(2)-127.0.0.1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 14:30:20.555 [RMI TCP Connection(2)-127.0.0.1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 14:30:20.556 [RMI TCP Connection(2)-127.0.0.1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 14:30:25.392 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 14:30:25.394 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 14:30:25.394 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 14:30:25.394 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 14:30:25.415 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 14:30:25.415 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 14:30:31.171 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 正在关闭缓存预热服务...
2025-08-15 14:30:31.671 [SpringApplicationShutdownHook] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务已关闭: 剩余任务数=0
2025-08-15 14:30:31.684 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 正在关闭插件注册中心...
2025-08-15 14:30:31.684 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心已关闭
2025-08-15 14:30:31.684 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 正在关闭插件管理器...
2025-08-15 14:30:31.684 [SpringApplicationShutdownHook] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器已关闭
2025-08-15 14:30:31.685 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 正在关闭动态配置管理器...
2025-08-15 14:30:31.685 [SpringApplicationShutdownHook] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器已关闭
2025-08-15 14:30:31.689 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 正在关闭异步事件发布器...
2025-08-15 14:30:31.690 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器已关闭: 剩余队列事件=0
2025-08-15 14:30:31.690 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 正在关闭NATS连接池...
2025-08-15 14:30:31.691 [SpringApplicationShutdownHook] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池已关闭: 总连接数=10, 活跃连接数=0
2025-08-15 14:30:32.735 [main] INFO  com.acme.im.business.BusinessServiceApplication - Starting BusinessServiceApplication using Java 17.0.14 with PID 70788 (/Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices/business-service/target/classes started by aguang in /Users/aguang/Documents/IM2.0VESION/IMCHAT/im-microservices)
2025-08-15 14:30:32.739 [main] DEBUG com.acme.im.business.BusinessServiceApplication - Running with Spring Boot v3.2.8, Spring v6.1.11
2025-08-15 14:30:32.740 [main] INFO  com.acme.im.business.BusinessServiceApplication - The following 1 profile is active: "common"
2025-08-15 14:30:33.073 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:30:33.073 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:30:33.080 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-08-15 14:30:33.227 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-15 14:30:33.227 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-15 14:30:33.232 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-15 14:30:33.629 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-15 14:30:33.634 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-08-15 14:30:33.634 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.26]
2025-08-15 14:30:33.654 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-15 14:30:33.655 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 888 ms
2025-08-15 14:30:33.753 [main] DEBUG c.a.im.common.security.jwt.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-08-15 14:30:33.762 [main] INFO  c.a.i.b.m.common.config.BusinessDataSourceConfig - 业务服务启用读写分离：写操作使用主库，读操作使用从库
2025-08-15 14:30:33.783 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - 初始化NATS连接池: minConnections=10, maxConnections=50
2025-08-15 14:30:33.820 [main] INFO  c.a.i.c.i.nats.config.NatsConnectionPool - NATS连接池初始化完成: 创建连接数=10
2025-08-15 14:30:33.835 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 初始化异步事件发布器...
2025-08-15 14:30:33.836 [main] INFO  c.a.i.c.i.nats.publisher.AsyncEventPublisher - 异步事件发布器初始化完成: 线程池大小=4, 队列容量=10000
2025-08-15 14:30:33.839 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 开始初始化事件处理器注册器...
2025-08-15 14:30:33.839 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 注册事件处理器: subject=common.message.chat, processor=MessageEventProcessor, priority=50
2025-08-15 14:30:33.839 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 为主题 common.message.chat 注册了 1 个事件处理器
2025-08-15 14:30:33.839 [main] INFO  c.a.i.b.module.common.event.EventProcessorRegistry - 事件处理器注册器初始化完成，共注册 1 个主题，1 个处理器
2025-08-15 14:30:33.909 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置主数据源: jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 14:30:33.911 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Primary-HikariCP
2025-08-15 14:30:34.164 [main] WARN  i.n.resolver.dns.DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2025-08-15 14:30:34.238 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 正在连接NATS服务器: nats://localhost:4222
2025-08-15 14:30:34.243 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - NATS连接成功: nats://localhost:4222
2025-08-15 14:30:34.261 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 初始化动态配置管理器...
2025-08-15 14:30:34.262 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=redis, priority=100
2025-08-15 14:30:34.262 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 注册配置源: name=system-properties, priority=50
2025-08-15 14:30:34.262 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=config.change, sid=config.change
2025-08-15 14:30:34.262 [main] INFO  com.acme.im.common.config.DynamicConfigManager - 动态配置管理器初始化完成: 配置源数量=2
2025-08-15 14:30:34.264 [main] INFO  com.acme.im.common.config.ConfigHotReload - 初始化配置热更新机制...
2025-08-15 14:30:34.269 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 切换到数据源: primary
2025-08-15 14:30:34.269 [main] INFO  c.a.i.c.i.database.config.DataSourceSelector - 业务服务初始化完成，默认使用主库数据源
2025-08-15 14:30:34.270 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: databaseProperties -> com.acme.im.common.infrastructure.database.config.DatabaseProperties
2025-08-15 14:30:34.273 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 开始自动注册NATS事件处理器...
2025-08-15 14:30:34.283 [main] INFO  com.acme.im.common.plugin.PluginManager - 初始化插件管理器...
2025-08-15 14:30:34.283 [main] INFO  com.acme.im.common.plugin.PluginManager - 未发现插件JAR文件
2025-08-15 14:30:34.283 [main] INFO  com.acme.im.common.plugin.PluginManager - 插件管理器初始化完成: 已加载插件数=0
2025-08-15 14:30:34.285 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 初始化插件注册中心...
2025-08-15 14:30:34.285 [main] DEBUG com.acme.im.common.plugin.PluginRegistry - 添加事件监听器: eventType=PLUGIN_UNLOADED
2025-08-15 14:30:34.285 [main] INFO  com.acme.im.common.plugin.PluginRegistry - 插件注册中心初始化完成
2025-08-15 14:30:34.428 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 配置从数据源: jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true
2025-08-15 14:30:34.428 [main] INFO  c.a.i.c.i.database.config.DatabaseConfig - 创建HikariCP配置: url=jdbc:mysql://localhost:3306/im_system_copy?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowMultiQueries=true, username=root, poolName=IM-Secondary-HikariCP
2025-08-15 14:30:34.435 [main] INFO  c.a.i.c.i.database.config.DataSourceRouter - 数据源路由初始化完成: primary=HikariDataSource (IM-Primary-HikariCP), secondary=HikariDataSource (IM-Secondary-HikariCP)
2025-08-15 14:30:34.612 [main] INFO  o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 9 endpoint(s) beneath base path '/actuator'
2025-08-15 14:30:34.634 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 初始化分布式缓存管理器...
2025-08-15 14:30:34.634 [main] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 分布式缓存管理器初始化完成: 本地缓存大小限制=10000
2025-08-15 14:30:34.636 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建缓存操作线程池
2025-08-15 14:30:34.636 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 缓存操作线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@564e0a6c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:34.638 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 初始化缓存预热服务...
2025-08-15 14:30:34.638 [main] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热服务初始化完成: 工作线程数=3
2025-08-15 14:30:34.644 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建默认异步线程池: corePoolSize=4, maxPoolSize=20, queueCapacity=1000
2025-08-15 14:30:34.644 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 默认异步线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@673a702a[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:34.645 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建事件处理线程池: corePoolSize=2, maxPoolSize=8, queueCapacity=5000
2025-08-15 14:30:34.646 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 事件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@502f6f6a[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:34.647 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建消息处理线程池
2025-08-15 14:30:34.647 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 消息处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@3ce60feb[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:34.648 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建文件处理线程池
2025-08-15 14:30:34.648 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 文件处理线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@4a0dd851[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:34.649 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 创建监控统计线程池
2025-08-15 14:30:34.649 [main] INFO  com.acme.im.common.config.AsyncConfiguration - 监控统计线程池创建完成: org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor$1@25a81f28[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
2025-08-15 14:30:34.757 [OkHttp http://localhost:9000/...] DEBUG c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO请求: HEAD http://localhost:9000/im-files
2025-08-15 14:30:34.767 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - 存储桶连接正常: im-files
2025-08-15 14:30:34.767 [main] INFO  c.a.i.c.infrastructure.minio.config.MinioConfig - MinIO客户端初始化成功: endpoint=http://localhost:9000, region=us-east-1
2025-08-15 14:30:34.775 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - JetStream初始化成功
2025-08-15 14:30:34.775 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 开始初始化默认流...
2025-08-15 14:30:34.775 [main] INFO  c.a.i.common.infrastructure.nats.config.NatsConfig - 默认流初始化完成（需要手动创建）
2025-08-15 14:30:34.832 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-08-15 14:30:34.886 [redisson-netty-4-4] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-08-15 14:30:35.004 [main] INFO  o.s.security.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@595626b8, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1928930, org.springframework.security.web.context.SecurityContextHolderFilter@2c95cb24, org.springframework.security.web.header.HeaderWriterFilter@522db06e, org.springframework.web.filter.CorsFilter@707b0b9b, com.acme.im.common.security.jwt.JwtAuthenticationFilter@5da3f32a, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5b52ce28, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3794621d, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@43ac1fa0, org.springframework.security.web.session.SessionManagementFilter@3c9cd930, org.springframework.security.web.access.ExceptionTranslationFilter@68fe866b, org.springframework.security.web.access.intercept.AuthorizationFilter@625ae6d]
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.profile.updated, handler=BusinessEventHandler.handleUserProfileUpdated, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.status.changed, handler=BusinessEventHandler.handleUserStatusChanged, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.login, handler=BusinessEventHandler.handleUserLogin, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.user.logout, handler=BusinessEventHandler.handleUserLogout, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.created, handler=BusinessEventHandler.handleConversationCreated, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.conversation.updated, handler=BusinessEventHandler.handleConversationUpdated, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.created, handler=BusinessEventHandler.handleGroupCreated, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.group.member.joined, handler=BusinessEventHandler.handleGroupMemberJoined, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.request.sent, handler=BusinessEventHandler.handleFriendRequestSent, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=business.friend.added, handler=BusinessEventHandler.handleFriendAdded, priority=100, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.chat, handler=MessageEventHandler.handleChatMessage, priority=50, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.message.control, handler=MessageEventHandler.handleControlMessage, priority=60, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=common.auth.validate, handler=AuthEventHandler.handleAuthValidation, priority=10, async=false
2025-08-15 14:30:35.321 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=security.token.validate, handler=TokenValidationEventHandler.handleTokenValidationRequest, priority=100, async=false
2025-08-15 14:30:35.322 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - 注册事件处理器: subject=websocket.*, handler=WebSocketEventHandler.handleWebSocketEvents, priority=100, async=false
2025-08-15 14:30:35.324 [main] INFO  c.a.i.c.i.n.handler.EventHandlerAutoRegistration - NATS事件处理器自动注册完成，共注册 15 个处理器
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: redisProperties -> com.acme.im.common.infrastructure.redis.config.RedisProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.ssl-org.springframework.boot.autoconfigure.ssl.SslProperties -> org.springframework.boot.autoconfigure.ssl.SslProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: server-org.springframework.boot.autoconfigure.web.ServerProperties -> org.springframework.boot.autoconfigure.web.ServerProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.mvc-org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties -> org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties -> org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.web-org.springframework.boot.autoconfigure.web.WebProperties -> org.springframework.boot.autoconfigure.web.WebProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties -> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: mybatis-plus-com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties -> com.baomidou.mybatisplus.autoconfigure.MybatisPlusProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.BulkheadProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.thread-pool-bulkhead-io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties -> io.github.resilience4j.springboot3.bulkhead.autoconfigure.ThreadPoolBulkheadProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.metrics-org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties -> org.springframework.boot.actuate.autoconfigure.metrics.MetricsProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.prometheus.metrics.export-org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties -> org.springframework.boot.actuate.autoconfigure.metrics.export.prometheus.PrometheusProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.circuitbreaker-io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties -> io.github.resilience4j.springboot3.circuitbreaker.autoconfigure.CircuitBreakerProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.ratelimiter-io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties -> io.github.resilience4j.springboot3.ratelimiter.autoconfigure.RateLimiterProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.retry-io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties -> io.github.resilience4j.springboot3.retry.autoconfigure.RetryProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: resilience4j.timelimiter-io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties -> io.github.resilience4j.springboot3.timelimiter.autoconfigure.TimeLimiterProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.redis.redisson-org.redisson.spring.starter.RedissonProperties -> org.redisson.spring.starter.RedissonProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties -> org.springframework.boot.autoconfigure.data.redis.RedisProperties
2025-08-15 14:30:35.324 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties -> org.springframework.boot.autoconfigure.jackson.JacksonProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.transaction-org.springframework.boot.autoconfigure.transaction.TransactionProperties -> org.springframework.boot.autoconfigure.transaction.TransactionProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.health-org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties -> org.springframework.boot.actuate.autoconfigure.health.HealthEndpointProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties -> org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.info-org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties -> org.springframework.boot.actuate.autoconfigure.info.InfoContributorProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.configprops-org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties -> org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties -> org.springframework.boot.autoconfigure.jmx.JmxProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.jmx-org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web-org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.env-org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties -> org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.diskspace-org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.system.DiskSpaceHealthIndicatorProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.health.db-org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties -> org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthIndicatorProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoint.logfile-org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties -> org.springframework.boot.actuate.autoconfigure.logging.LogFileWebEndpointProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.task.scheduling-org.springframework.boot.autoconfigure.task.TaskSchedulingProperties -> org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.observations-org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties -> org.springframework.boot.actuate.autoconfigure.observation.ObservationProperties
2025-08-15 14:30:35.325 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.gson-org.springframework.boot.autoconfigure.gson.GsonProperties -> org.springframework.boot.autoconfigure.gson.GsonProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.lifecycle-org.springframework.boot.autoconfigure.context.LifecycleProperties -> org.springframework.boot.autoconfigure.context.LifecycleProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.data.web-org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties -> org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.jdbc-org.springframework.boot.autoconfigure.jdbc.JdbcProperties -> org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.netty-org.springframework.boot.autoconfigure.netty.NettyProperties -> org.springframework.boot.autoconfigure.netty.NettyProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.reactor-org.springframework.boot.autoconfigure.reactor.ReactorProperties -> org.springframework.boot.autoconfigure.reactor.ReactorProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.security-org.springframework.boot.autoconfigure.security.SecurityProperties -> org.springframework.boot.autoconfigure.security.SecurityProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.sql.init-org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties -> org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: spring.servlet.multipart-org.springframework.boot.autoconfigure.web.servlet.MultipartProperties -> org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.endpoints.web.cors-org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties -> org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 发现配置属性Bean: management.server-org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties -> org.springframework.boot.actuate.autoconfigure.web.server.ManagementServerProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.ConfigHotReload - 创建动态属性源: dynamicConfigProperties
2025-08-15 14:30:35.326 [main] DEBUG com.acme.im.common.config.DynamicConfigManager - 添加配置监听器: key=*
2025-08-15 14:30:35.326 [main] INFO  com.acme.im.common.config.ConfigHotReload - 配置热更新机制初始化完成: 配置Bean数量=45
2025-08-15 14:30:35.340 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:30:35.340 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:30:35.341 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:30:35.341 [main] DEBUG c.a.i.c.i.database.config.DataSourceRouter - 当前使用数据源: primary
2025-08-15 14:30:35.350 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-08-15 14:30:35.357 [main] INFO  com.acme.im.business.BusinessServiceApplication - Started BusinessServiceApplication in 2.788 seconds (process running for 2.976)
2025-08-15 14:30:35.360 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置初始化开始...
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.status.changed
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.status.changed, sid=business.user.status.changed
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.login
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.login, sid=business.user.login
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.logout
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.logout, sid=business.user.logout
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.profile.updated
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.profile.updated, sid=business.user.profile.updated
2025-08-15 14:30:35.360 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.avatar.updated
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.avatar.updated, sid=business.user.avatar.updated
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.user.online.status.changed
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.user.online.status.changed, sid=business.user.online.status.changed
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.created
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.created, sid=business.conversation.created
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.updated
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.updated, sid=business.conversation.updated
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.deleted
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.deleted, sid=business.conversation.deleted
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.added
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.added, sid=business.conversation.member.added
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.conversation.member.removed
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.conversation.member.removed, sid=business.conversation.member.removed
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.created
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.created, sid=business.group.created
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.updated
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.updated, sid=business.group.updated
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.deleted
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.deleted, sid=business.group.deleted
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.joined
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.joined, sid=business.group.member.joined
2025-08-15 14:30:35.361 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.member.left
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.member.left, sid=business.group.member.left
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.group.role.changed
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.group.role.changed, sid=business.group.role.changed
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.sent
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.sent, sid=business.friend.request.sent
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.accepted
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.accepted, sid=business.friend.request.accepted
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.request.rejected
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.request.rejected, sid=business.friend.request.rejected
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.added
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.added, sid=business.friend.added
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.removed
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.removed, sid=business.friend.removed
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.blocked
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.blocked, sid=business.friend.blocked
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: business.friend.unblocked
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=business.friend.unblocked, sid=business.friend.unblocked
2025-08-15 14:30:35.362 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 14:30:35.363 [main] INFO  c.a.i.b.module.common.config.BusinessEventConfig - 业务层事件配置启动成功，成功订阅 27/27 个主题
2025-08-15 14:30:35.363 [main] DEBUG c.a.i.b.module.common.config.BusinessEventConfig - 已订阅的主题: [business.user.status.changed, business.user.login, business.user.logout, business.user.profile.updated, business.user.avatar.updated, business.user.online.status.changed, business.conversation.created, business.conversation.updated, business.conversation.deleted, business.conversation.member.added, business.conversation.member.removed, business.group.created, business.group.updated, business.group.deleted, business.group.member.joined, business.group.member.left, business.group.role.changed, business.friend.request.sent, business.friend.request.accepted, business.friend.request.rejected, business.friend.added, business.friend.removed, business.friend.blocked, business.friend.unblocked, common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated]
2025-08-15 14:30:35.363 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置初始化开始...
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.token.expired
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.token.expired, sid=common.auth.token.expired
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.auth.permission.denied
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.auth.permission.denied, sid=common.auth.permission.denied
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: common.cache.invalidated
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=common.cache.invalidated, sid=common.cache.invalidated
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.monitoring.health.check
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.monitoring.health.check, sid=admin.monitoring.health.check
2025-08-15 14:30:35.363 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 🔔 订阅主题: admin.system.alert
2025-08-15 14:30:35.364 [main] INFO  c.a.i.c.i.nats.subscriber.EventSubscriber - 事件订阅成功: subject=admin.system.alert, sid=admin.system.alert
2025-08-15 14:30:35.364 [main] INFO  com.acme.im.common.config.EventManagementConfig - 公共模块事件管理配置启动成功，成功订阅 5/5 个通用主题
2025-08-15 14:30:35.364 [main] DEBUG com.acme.im.common.config.EventManagementConfig - 已订阅的通用主题: [common.auth.token.expired, common.auth.permission.denied, common.cache.invalidated, admin.monitoring.health.check, admin.system.alert]
2025-08-15 14:30:35.365 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 应用启动完成，开始执行系统级缓存预热...
2025-08-15 14:30:35.485 [RMI TCP Connection(4)-127.0.0.1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-15 14:30:35.485 [RMI TCP Connection(4)-127.0.0.1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-15 14:30:35.486 [RMI TCP Connection(4)-127.0.0.1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-15 14:30:40.368 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 开始系统级缓存预热...
2025-08-15 14:30:40.370 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 执行预热任务: key=system:config, priority=CRITICAL
2025-08-15 14:30:40.370 [cache-1] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 添加预热任务: key=system:config, priority=CRITICAL
2025-08-15 14:30:40.370 [cache-1] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 系统级缓存预热任务已添加
2025-08-15 14:30:40.380 [cache-warmup-worker] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 缓存已设置: key=system:config, redisTtl=PT12H, localTtl=PT5M
2025-08-15 14:30:40.380 [cache-warmup-worker] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 预热任务完成: key=system:config
2025-08-15 14:31:20.358 [MessageBroker-4] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 7, active threads = 1, queued tasks = 3, completed tasks = 3]
2025-08-15 14:35:19.597 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:35:20.387 [cache-3] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 14:35:20.387 [cache-4] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 14:35:34.640 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=0, localSize=1, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:36:19.589 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 14:36:34.609 [cache-cleanup] DEBUG c.a.im.common.utils.cache.DistributedCacheManager - 清理过期本地缓存: 清理前=1, 清理后=0
2025-08-15 14:40:19.550 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:40:20.345 [cache-6] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 14:40:20.347 [cache-5] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 14:40:34.589 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:45:19.548 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:45:20.349 [cache-7] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 14:45:20.350 [cache-8] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 14:45:34.589 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:50:19.544 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:50:20.356 [cache-10] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 14:50:20.356 [cache-9] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 14:50:34.583 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:55:19.542 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 14:55:20.361 [cache-11] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 14:55:20.361 [cache-12] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 14:55:34.583 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 15:00:19.540 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 15:00:20.369 [cache-13] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 15:00:20.369 [cache-14] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 15:00:34.577 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 15:01:20.305 [MessageBroker-6] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 3, completed tasks = 16]
2025-08-15 15:05:19.535 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 15:05:20.375 [cache-16] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 15:05:20.375 [cache-15] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 15:05:34.574 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 15:11:15.728 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m26s470ms).
2025-08-15 15:11:16.192 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m26s470ms).
2025-08-15 15:59:00.395 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=51m56s121ms).
2025-08-15 15:59:00.845 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=51m56s121ms).
2025-08-15 16:04:32.015 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=53m16s286ms).
2025-08-15 16:04:32.473 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=53m16s281ms).
2025-08-15 16:04:47.030 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m46s636ms).
2025-08-15 16:04:47.480 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m46s635ms).
2025-08-15 16:07:02.275 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:07:03.121 [cache-18] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:07:03.121 [cache-17] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:07:17.314 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:12:02.272 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:12:03.121 [cache-19] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:12:03.121 [cache-20] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:12:17.310 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:17:02.266 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:17:03.124 [cache-21] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:17:03.124 [cache-22] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:17:17.308 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:22:44.872 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m12s713ms).
2025-08-15 16:22:44.975 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:22:45.327 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m12s715ms).
2025-08-15 16:22:45.839 [cache-23] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:22:45.839 [cache-24] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:22:59.869 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m12s719ms).
2025-08-15 16:23:00.017 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:23:00.338 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m12s719ms).
2025-08-15 16:27:44.975 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:27:45.841 [cache-25] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:27:45.841 [cache-26] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:28:00.016 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:28:45.742 [MessageBroker-13] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 3, completed tasks = 30]
2025-08-15 16:32:44.971 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:32:45.842 [cache-27] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:32:45.842 [cache-28] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:33:00.013 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:37:44.970 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:37:45.847 [cache-30] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:37:45.847 [cache-29] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:38:00.011 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:42:44.967 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:42:45.848 [cache-32] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:42:45.848 [cache-31] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:43:00.008 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:47:44.963 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:47:45.851 [cache-34] DEBUG com.acme.im.common.utils.cache.CacheWarmupService - 开始智能预热分析...
2025-08-15 16:47:45.851 [cache-33] INFO  com.acme.im.common.utils.cache.CacheWarmupService - 缓存预热统计: WarmupStats{total=1, completed=1, failed=0, queue=0, hits=0, rate=100.00%}
2025-08-15 16:48:00.004 [cache-cleanup] INFO  c.a.im.common.utils.cache.DistributedCacheManager - 缓存统计信息: CacheStats{hit=0, miss=0, localHit=0, redisHit=0, load=0, evict=1, localSize=0, hitRate=0.00%, localHitRate=0.00%}
2025-08-15 16:59:58.460 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=11m28s419ms).
2025-08-15 16:59:58.935 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=11m28s417ms).
2025-08-15 17:12:47.623 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=24m2s560ms).
2025-08-15 17:12:48.048 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=24m2s560ms).
2025-08-15 17:33:14.125 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=33m15s666ms).
2025-08-15 17:33:14.600 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=33m15s665ms).
2025-08-15 17:33:29.151 [IM-Primary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Primary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=20m41s528ms).
2025-08-15 17:33:29.576 [IM-Secondary-HikariCP housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - IM-Secondary-HikariCP - Thread starvation or clock leap detected (housekeeper delta=20m41s528ms).
