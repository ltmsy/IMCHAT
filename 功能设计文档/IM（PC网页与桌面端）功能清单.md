
# IM（PC网页与桌面端）功能清单（含可配置策略项）
布局：三栏（左侧：头像/会话/好友/群组/收藏/设置/退出；中栏：列表；右栏：聊天/详情）。主题：紫色（亮/暗/随系统）。本清单强调“可配置策略项”，确保关键能力不遗漏；交互细节将于功能确认后另行输出。

---

## 0. 全局与外观
- 三栏布局（记忆宽度、低宽度自动双栏）
- 多窗口（会话新窗口/小窗置顶）
- 主题与可访问性（紫色主题强度、暗色、字号/密度、色弱/高对比）
- 快捷键（模块切换、搜索、发送/换行、批量、多选、开新窗）
- 全局搜索入口、会话内搜索入口
- 语言与地区（多语言包、日期与时区）

---

## 1. 账户与身份
- 登录/登出：账号密码/扫码/SSO（OIDC/SAML 可选）
- 在线状态：在线/忙碌/离开/勿扰/离线（手动/自动）
- 个人资料：头像/昵称/签名/ID/二维码；资料可见性范围（公开/好友/仅自己）
- 设备管理：在线设备列表、远程登出、设备备注
- 黑名单：添加/移除；被拉黑者的行为限制（消息、加好友、查看资料）

---

## 2. 会话（单聊/群聊/服务号/系统）
- 会话创建：从好友/搜索/名片、一键发起群聊
- 会话列表：置顶、未读计数、免打扰标识、草稿标识、分组/折叠
- 会话管理（通用）
  - 打开/新窗口打开
  - 置顶/取消置顶
  - 标为未读/已读
  - 免打扰/取消免打扰（是否仅消息/同时静音@）
  - 删除会话（仅移出列表，不删云端历史）
  - 清空会话消息（范围：仅本端/云端同步；可配置）
- 会话权限策略（可配置）
  - 是否允许清空云端消息
  - 免打扰是否屏蔽@我/仅静音
  - 会话历史是否可被导出（用户/仅管理员/禁止）
- 群会话特有
  - 退出群（成员）
  - 解散群（群主/管理员）
  - 查看群资料/成员/公告/置顶区/文件中心
  - 修改我的群昵称
  - 邀请入群（成员/管理员/群主，权限可配）

---

## 3. 消息能力与策略
- 消息类型：文本、表情/贴纸、图片、文件、视频片段、语音（可开关）、链接卡片、代码片段、名片、投票、位置（可开关）
- 发送与输入：拖拽/粘贴、表格转图片/Markdown（策略：默认/询问/记忆选择）、模板短语
- 消息操作（单条）
  - 引用/回复（是否支持跨会话引用：可配）
  - 复制（纯文本/含格式）
  - 转发（单条/合并转发；是否允许跨组织/跨域：可配）
  - 撤回（是否允许；撤回时限；撤回后提示样式；是否保留影子审计：可配）
  - 编辑（是否允许；时限；是否标注“已编辑”）
  - 置顶（会话内置顶区；是否允许普通成员置顶；置顶数量上限）
  - 删除（对自己可见删除；是否允许管理员删除他人消息）
  - 翻译（目标语言列表；是否支持自动检测）
  - 收藏（收藏夹分组）
  - 标记（重点/待办；是否联动任务系统）
- 批量操作：多选转发/删除/收藏/导出（是否允许导出原文或仅截图：可配）
- 已读与送达：单聊已读/送达、群聊是否显示“已读人数”（可配）
- 富文本：粗/斜/下划线/列表/引用/分割线/行内代码；代码块语法高亮
- 风险/内容安全策略
  - 敏感词检测（拦截/提醒/替换）
  - 外链风险标注；禁止域名单
  - 文件白名单与最大体积（原图策略）

---

## 4. 好友与通讯录
- 好友列表：分组（默认/星标/自定义）、备注、在线状态
- 搜索：姓名/备注/组织字段（部门、职务，可选）
- 好友关系管理
  - 添加好友（是否需要验证；验证方式：自由通过/问答/备注必填）
  - 同意/拒绝/忽略；是否允许对方再次申请的间隔
  - 设置备注、移动分组、设为星标/取消
  - 删除好友（是否保留会话与历史）
  - 拉黑/移出黑名单（拉黑范围：消息/查看资料/申请）
- 隐私策略（可配置）
  - 谁可以向我发起好友申请（所有人/同组织/共同群成员/仅通过链接）
  - 是否允许被通过后自动建会话
  - 是否允许从群聊直接添加为好友（开启/需验证/禁止）

---

## 5. 群组与群治理
- 创建与加入
  - 新建群（选择成员）；通过邀请链接/二维码加入（是否开启；是否需要审批；有效期与次数限制）
- 群资料
  - 群头像、名称、描述、公告
  - 邀请方式（链接/二维码/管理员邀请）
- 成员与角色
  - 角色：群主、管理员、普通成员
  - 设置/撤销管理员
  - 邀请成员/移除成员（权限：群主/管理员）
- 群设置（策略项，易遗漏已补齐）
  - 新成员是否可查看历史消息（不可见/可见部分（X天）/全部可见）
  - 群禁言（全员禁言/分角色例外；单人禁言（时长））
  - @全体权限（仅群主/管理员/全员禁用）
  - 置顶消息（是否允许；谁可置顶；置顶数量上限）
  - 是否允许普通成员编辑自己消息（可配）
  - 是否允许撤回消息（时限；角色例外）
  - 是否允许从群内添加好友（开启/需验证/禁止）
  - 入群审批（开启/关闭；审批人范围）
  - 入群验证问题（开启/关闭；问题库）
  - 加群方式（搜索可见/仅邀请/链接入群）
  - 群昵称要求（是否必填；重复策略）
  - 文件与外发策略（类型白名单；最大体积；外链/外域限制）
  - 群公告推送（是否强提醒；是否@全体）
- 群内容沉淀
  - 置顶区（消息卡片/链接/文件）
  - 文件/图片/链接页签（筛选/搜索/批量）
- 解散与退出
  - 退出群（成员）；转让群主（支持/不支持）
  - 解散群（群主）；解散后历史可见性（仅管理员/所有成员只读/彻底不可见）

---

## 6. 文件与下载
- 上传/发送：拖拽/粘贴/选择器；断点续传；失败重试；并发控制
- 预览：图片/视频内联；PDF/Office/Markdown 在线预览；压缩包结构预览（沙箱）
- 文件策略（可配置）
  - 单文件大小上限；每日外发带宽/次数
  - 原图/压缩默认；超过阈值询问
  - 禁止类型/高风险类型拦截；敏感内容检测
- 下载管理器（桌面端优先）：队列、历史、打开文件夹、校验、限速（可选）
- 会话文件中心：类型/发送人/时间筛选；批量转发/收藏/下载/删除记录

---

## 7. 搜索与检索
- 全局搜索：对象（人/群/消息/文件/链接/收藏）；条件（关键词、发送人、时间、类型、群/单聊）
- 会话内搜索：关键词、上一条/下一条、仅看图片/文件/链接/代码、按日期跳转
- 收藏搜索：按类型/来源/时间
- 索引策略（可配置）：云端/本地混合；本地容量与清理；离线可搜索范围

---

## 8. 通知与状态
- 通知：普通/仅@我/免打扰；工作时间段策略；前台聚焦抑制
- 徽标与计数：应用图标/托盘/任务栏计数（桌面端）
- 已读回执：单聊开启；群聊是否展示已读人数（可配）
- 在线状态展示：列表/名片；状态同步来源（手动/系统日历/第三方）

---

## 9. 收藏与标记
- 收藏对象：消息/图片/文件/链接/代码片段
- 收藏夹：分组/重命名/批量操作/导出（是否允许导出：可配）
- 标记：重点/待办（是否启用；是否同步到任务中心）

---

## 10. 设置中心（策略与开关）
- 账号与安全：密码/二步验证/设备管理/全部登出
- 聊天与输入：Enter行为；表格粘贴策略；字体/字号/密度；代码主题
- 外观与主题：亮/暗/随系统；紫色强度；色弱/高对比
- 文件与下载：默认目录；并发/断点续传；原图策略；限速（可选）
- 通知与声音：开关；免打扰时间；仅@我；铃声包（可选）
- 隐私与权限：
  - 添加我的验证（自由通过/需验证/问题/仅同组织/共同群成员）
  - 谁可向我发起会话（所有人/仅好友/同组织/共同群成员）
  - 是否允许通过群直接加我为好友（开启/需验证/禁止）
  - 是否允许向我发送文件（限制扩展名/大小）
- 高级与实验：多窗口；小窗置顶；本地全文索引；性能诊断；日志级别
- 关于：版本/检查更新/协议

---

## 11. 安全与合规
- 登录安全：短期Token+刷新（网页端）；CSRF；Cookie SameSite
- 本地数据（桌面端）：数据库加密；密钥轮换；日志脱敏；崩溃自恢复
- 内容安全：敏感词/涉政/涉黄/木马文件检测；外域限制；可疑链接提示
- 审计与留存（企业可选）：消息留存策略；审计导出；撤回影子保留；外发审批
- 权限矩阵（建议产出）：角色×操作（群治理/消息管理/导出/置顶/公告）

---

## 12. 诊断与性能
- 诊断面板：连接状态/重连次数/消息队列/服务地址；导出诊断包
- 网络策略：WS断线重连回退（WS→SSE→轮询）；休眠唤醒恢复
- 性能目标（参考）：首屏≤2s；会话切换≤150ms；搜索首包≤800ms；大列表虚拟化稳定
- 可靠性：文件上传失败率≤0.3%；断点续传成功率≥99%

---

## 13. 版本里程碑（建议）
- V1 基础：会话与消息全套操作（引用/复制/转发/撤回/编辑/置顶/删除/翻译/收藏）、会话管理（置顶/免打扰/删除/清空；群：退出/解散）、好友（验证/删除/拉黑）、搜索、文件发送/预览、收藏、通知与设置
- V2 治理：批量操作、群禁言/审批/公告、置顶区、文件中心、下载管理器
- V3 组织与合规：本地索引、权限矩阵、留存/审计、外发策略扩展

---

## 14. 复查重点清单（变更/新增项一览）
- 群设置：新成员历史可见度（不可见/部分X天/全部）✅
- 群禁言：全员/单人（时长）；角色例外✅
- 群置顶消息：是否允许；权限与上限✅
- 消息编辑：是否允许；时限；编辑标注✅
- 从群添加好友：开启/需验证/禁止✅
- 撤回消息：是否允许；时限；审计影子✅
- 好友添加策略：是否需验证；验证方式；再次申请间隔✅
- 免打扰粒度：是否屏蔽@我；是否静音仅消息✅
- 清空会话范围：仅本端或云端同步✅
- 已读回执：群聊是否展示已读人数✅
- 导出能力：消息/收藏/会话历史是否允许导出与范围✅
