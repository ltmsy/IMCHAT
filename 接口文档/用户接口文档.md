# ç”¨æˆ·æ¥å£æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [1. æ¥å£æ¦‚è¿°](#1-æ¥å£æ¦‚è¿°)
- [2. åŸºç¡€ä¿¡æ¯](#2-åŸºç¡€ä¿¡æ¯)
- [3. ç”¨æˆ·æ³¨å†Œ](#3-ç”¨æˆ·æ³¨å†Œ)
- [4. ç”¨æˆ·ç™»å½•](#4-ç”¨æˆ·ç™»å½•)
- [5. ç”¨æˆ·ç™»å‡º](#5-ç”¨æˆ·ç™»å‡º)
- [6. è·å–ç”¨æˆ·ä¿¡æ¯](#6-è·å–ç”¨æˆ·ä¿¡æ¯)
- [7. æ›´æ–°ç”¨æˆ·ä¿¡æ¯](#7-æ›´æ–°ç”¨æˆ·ä¿¡æ¯)
- [8. æ›´æ–°ç”¨æˆ·å¤´åƒ](#8-æ›´æ–°ç”¨æˆ·å¤´åƒ)
- [9. ä¿®æ”¹å¯†ç ](#9-ä¿®æ”¹å¯†ç )
- [10. é‡ç½®å¯†ç ](#10-é‡ç½®å¯†ç )
- [11. æœç´¢ç”¨æˆ·](#11-æœç´¢ç”¨æˆ·)
- [12. é”™è¯¯ç è¯´æ˜](#12-é”™è¯¯ç è¯´æ˜)

---

## 1. æ¥å£æ¦‚è¿°

### 1.1 æœåŠ¡ä¿¡æ¯
- **æœåŠ¡åç§°**: IMç”¨æˆ·ç®¡ç†æœåŠ¡
- **æœåŠ¡åœ°å€**: `http://localhost:8081`
- **åŸºç¡€è·¯å¾„**: `/api/users`
- **åè®®**: HTTP/HTTPS
- **æ•°æ®æ ¼å¼**: JSON

### 1.2 è®¤è¯æ–¹å¼
- **è®¤è¯ç±»å‹**: JWT (JSON Web Token)
- **Headeræ ¼å¼**: `Authorization: Bearer {token}`
- **Tokenæœ‰æ•ˆæœŸ**: 30åˆ†é’Ÿï¼ˆè®¿é—®ä»¤ç‰Œï¼‰

### 1.3 å“åº”æ ¼å¼
æ‰€æœ‰æ¥å£ç»Ÿä¸€ä½¿ç”¨ä»¥ä¸‹å“åº”æ ¼å¼ï¼š

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {},
  "timestamp": "2025-08-13 13:50:21",
  "error": false,
  "success": true
}
```

---

## 2. åŸºç¡€ä¿¡æ¯

### 2.1 è¯·æ±‚å¤´
| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| Content-Type | String | æ˜¯ | å›ºå®šå€¼ï¼šapplication/json |
| Authorization | String | å¦ | Bearer {JWT Token} |

### 2.2 é€šç”¨å“åº”å­—æ®µ
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | Integer | å“åº”çŠ¶æ€ç  |
| message | String | å“åº”æ¶ˆæ¯ |
| data | Object | å“åº”æ•°æ® |
| timestamp | String | å“åº”æ—¶é—´æˆ³ |
| error | Boolean | æ˜¯å¦é”™è¯¯ |
| success | Boolean | æ˜¯å¦æˆåŠŸ |

### 2.3 çŠ¶æ€ç è¯´æ˜
| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒ |
| 403 | ç¦æ­¢è®¿é—® |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## 3. ç”¨æˆ·æ³¨å†Œ

### 3.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `POST /api/users/register`
- **æ¥å£æè¿°**: ç”¨æˆ·æ³¨å†Œ
- **è®¤è¯è¦æ±‚**: æ— éœ€è®¤è¯

### 3.2 è¯·æ±‚å‚æ•°
```json
{
  "username": "testuser",
  "password": "123456",
  "deviceId": "device001"
}
```

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é•¿åº¦é™åˆ¶ | è¯´æ˜ |
|--------|------|------|----------|------|
| username | String | æ˜¯ | 3-20å­—ç¬¦ | ç”¨æˆ·åï¼Œåªèƒ½åŒ…å«å­—æ¯ |
| password | String | æ˜¯ | 6-20å­—ç¬¦ | å¯†ç  |
| deviceId | String | æ˜¯ | 1-50å­—ç¬¦ | è®¾å¤‡æ ‡è¯† |

### 3.3 å“åº”ç¤ºä¾‹
```json
{
  "code": 201,
  "message": "ç”¨æˆ·æ³¨å†ŒæˆåŠŸ",
  "data": {
    "id": 5,
    "username": "testuser",
    "nickname": "testuser",
    "status": 1,
    "onlineStatus": 0,
    "createdAt": "2025-08-13T13:24:19",
    "updatedAt": "2025-08-13T13:24:19"
  },
  "timestamp": "2025-08-13 13:24:19",
  "error": false,
  "success": true
}
```

---

## 4. ç”¨æˆ·ç™»å½•

### 4.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `POST /api/users/login`
- **æ¥å£æè¿°**: ç”¨æˆ·ç™»å½•
- **è®¤è¯è¦æ±‚**: æ— éœ€è®¤è¯

### 4.2 è¯·æ±‚å‚æ•°
```json
{
  "username": "testuser",
  "password": "123456",
  "deviceId": "device001"
}
```

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| username | String | æ˜¯ | ç”¨æˆ·å |
| password | String | æ˜¯ | å¯†ç  |
| deviceId | String | æ˜¯ | è®¾å¤‡æ ‡è¯† |

### 4.3 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "ç”¨æˆ·ç™»å½•æˆåŠŸ",
  "data": "eyJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoiYWNjZXNzIiwiZGV2aWNlSWQiOiJkZXZpY2UwMDEiLCJzdWIiOiJ0ZXN0dXNlciIsImlzcyI6ImltLXN5c3RlbSIsImF1ZCI6WyJpbS11c2VycyJdLCJpYXQiOjE3NTUwNjc4MjEsImV4cCI6MTc1NTI4MzgyMX0.GNXcTs7Y517-dVWKBLaoSCzLzPn9N5WcGQ5xQKB1mME",
  "timestamp": "2025-08-13 13:50:21",
  "error": false,
  "success": true
}
```

---

## 5. ç”¨æˆ·ç™»å‡º

### 5.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `POST /api/users/logout`
- **æ¥å£æè¿°**: ç”¨æˆ·ç™»å‡º
- **è®¤è¯è¦æ±‚**: éœ€è¦JWTè®¤è¯

### 5.2 è¯·æ±‚å¤´
```
Authorization: Bearer {JWT Token}
```

### 5.3 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "ç”¨æˆ·ç™»å‡ºæˆåŠŸ",
  "data": "ç™»å‡ºæˆåŠŸ",
  "timestamp": "2025-08-13 13:55:00",
  "error": false,
  "success": true
}
```

---

## 6. è·å–ç”¨æˆ·ä¿¡æ¯

### 6.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `GET /api/users/profile`
- **æ¥å£æè¿°**: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- **è®¤è¯è¦æ±‚**: éœ€è¦JWTè®¤è¯

### 6.2 è¯·æ±‚å¤´
```
Authorization: Bearer {JWT Token}
```

### 6.3 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ",
  "data": {
    "id": 5,
    "username": "testuser",
    "email": null,
    "phone": null,
    "nickname": "æ–°æ˜µç§°",
    "avatarUrl": "https://example.com/avatar.jpg",
    "signature": "è¿™æ˜¯æˆ‘çš„ä¸ªæ€§ç­¾å",
    "gender": 1,
    "birthday": null,
    "region": null,
    "status": 1,
    "onlineStatus": 1,
    "lastLoginAt": "2025-08-13T13:50:21",
    "lastActiveAt": "2025-08-13T13:50:21",
    "createdAt": "2025-08-13T13:24:19",
    "updatedAt": "2025-08-13T13:50:42"
  },
  "timestamp": "2025-08-13 13:55:30",
  "error": false,
  "success": true
}
```

---

## 7. æ›´æ–°ç”¨æˆ·ä¿¡æ¯

### 7.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `PUT /api/users/profile`
- **æ¥å£æè¿°**: æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- **è®¤è¯è¦æ±‚**: éœ€è¦JWTè®¤è¯

### 7.2 è¯·æ±‚å¤´
```
Authorization: Bearer {JWT Token}
Content-Type: application/json
```

### 7.3 è¯·æ±‚å‚æ•°
```json
{
  "nickname": "æ–°æ˜µç§°",
  "signature": "è¿™æ˜¯æˆ‘çš„ä¸ªæ€§ç­¾å",
  "gender": 1
}
```

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| nickname | String | å¦ | æ˜µç§° |
| signature | String | å¦ | ä¸ªæ€§ç­¾å |
| gender | Integer | å¦ | æ€§åˆ«ï¼š0-æœªçŸ¥ï¼Œ1-ç”·ï¼Œ2-å¥³ |
| birthday | String | å¦ | ç”Ÿæ—¥ï¼ˆISO 8601æ ¼å¼ï¼‰ |
| region | String | å¦ | åœ°åŒº |

### 7.4 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸ",
  "data": {
    "id": 5,
    "username": "testuser",
    "nickname": "æ–°æ˜µç§°",
    "signature": "è¿™æ˜¯æˆ‘çš„ä¸ªæ€§ç­¾å",
    "gender": 1,
    "updatedAt": "2025-08-13T13:55:45.869144"
  },
  "timestamp": "2025-08-13 13:55:45",
  "error": false,
  "success": true
}
```

---

## 8. æ›´æ–°ç”¨æˆ·å¤´åƒ

### 8.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `PUT /api/users/avatar`
- **æ¥å£æè¿°**: æ›´æ–°ç”¨æˆ·å¤´åƒ
- **è®¤è¯è¦æ±‚**: éœ€è¦JWTè®¤è¯

### 8.2 è¯·æ±‚å¤´
```
Authorization: Bearer {JWT Token}
```

### 8.3 è¯·æ±‚å‚æ•°
```
avatarUrl=https://example.com/avatar.jpg
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| avatarUrl | String | æ˜¯ | å¤´åƒURLåœ°å€ |

### 8.4 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "å¤´åƒæ›´æ–°æˆåŠŸ",
  "data": "æ›´æ–°æˆåŠŸ",
  "timestamp": "2025-08-13 13:56:00",
  "error": false,
  "success": true
}
```

---

## 9. ä¿®æ”¹å¯†ç 

### 9.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `PUT /api/users/password`
- **æ¥å£æè¿°**: ä¿®æ”¹ç”¨æˆ·å¯†ç 
- **è®¤è¯è¦æ±‚**: éœ€è¦JWTè®¤è¯

### 9.2 è¯·æ±‚å¤´
```
Authorization: Bearer {JWT Token}
Content-Type: application/json
```

### 9.3 è¯·æ±‚å‚æ•°
```json
{
  "oldPassword": "123456",
  "newPassword": "newpass123"
}
```

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| oldPassword | String | æ˜¯ | æ—§å¯†ç  |
| newPassword | String | æ˜¯ | æ–°å¯†ç  |

### 9.4 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸ",
  "data": "ä¿®æ”¹æˆåŠŸ",
  "timestamp": "2025-08-13 13:56:30",
  "error": false,
  "success": true
}
```

---

## 10. é‡ç½®å¯†ç 

### 10.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `POST /api/users/reset-password`
- **æ¥å£æè¿°**: é‡ç½®ç”¨æˆ·å¯†ç 
- **è®¤è¯è¦æ±‚**: æ— éœ€è®¤è¯

### 10.2 è¯·æ±‚å‚æ•°
```
email=user@example.com
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| email | String | æ˜¯ | ç”¨æˆ·é‚®ç®± |

### 10.3 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "å¯†ç é‡ç½®æˆåŠŸï¼Œè¯·æŸ¥çœ‹é‚®ç®±",
  "data": "é‡ç½®æˆåŠŸ",
  "timestamp": "2025-08-13 13:57:00",
  "error": false,
  "success": true
}
```

---

## 11. æœç´¢ç”¨æˆ·

### 11.1 æ¥å£ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `GET /api/users/search`
- **æ¥å£æè¿°**: æœç´¢ç”¨æˆ·
- **è®¤è¯è¦æ±‚**: éœ€è¦JWTè®¤è¯

### 11.2 è¯·æ±‚å¤´
```
Authorization: Bearer {JWT Token}
```

### 11.3 è¯·æ±‚å‚æ•°
```
keyword=test&limit=10
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| keyword | String | æ˜¯ | - | æœç´¢å…³é”®è¯ |
| limit | Integer | å¦ | 20 | è¿”å›ç»“æœæ•°é‡é™åˆ¶ |

### 11.4 å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "æœç´¢ç”¨æˆ·æˆåŠŸ",
  "data": [
    {
      "id": 5,
      "username": "testuser",
      "nickname": "æ–°æ˜µç§°",
      "avatarUrl": "https://example.com/avatar.jpg",
      "signature": "è¿™æ˜¯æˆ‘çš„ä¸ªæ€§ç­¾å",
      "gender": 1,
      "status": 1,
      "onlineStatus": 1,
      "lastLoginAt": "2025-08-13T13:50:21",
      "lastActiveAt": "2025-08-13T13:50:21",
      "createdAt": "2025-08-13T13:24:19",
      "updatedAt": "2025-08-13T13:50:42"
    }
  ],
  "timestamp": "2025-08-13 13:57:30",
  "error": false,
  "success": true
}
```

---

## 12. é”™è¯¯ç è¯´æ˜

### 12.1 é€šç”¨é”™è¯¯ç 
| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼å’Œå¿…å¡«å­—æ®µ |
| 401 | æœªæˆæƒ | æ£€æŸ¥JWT Tokenæ˜¯å¦æœ‰æ•ˆ |
| 403 | ç¦æ­¢è®¿é—® | æ£€æŸ¥ç”¨æˆ·æƒé™ |
| 404 | èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥è¯·æ±‚çš„èµ„æºæ˜¯å¦å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | è”ç³»æŠ€æœ¯æ”¯æŒ |

### 12.2 ä¸šåŠ¡é”™è¯¯ç 
| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|
| USER_NOT_FOUND | ç”¨æˆ·ä¸å­˜åœ¨ | æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦æ­£ç¡® |
| PASSWORD_ERROR | å¯†ç é”™è¯¯ | æ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡® |
| USERNAME_EXISTS | ç”¨æˆ·åå·²å­˜åœ¨ | é€‰æ‹©å…¶ä»–ç”¨æˆ·å |
| TOKEN_EXPIRED | Tokenå·²è¿‡æœŸ | é‡æ–°ç™»å½•è·å–æ–°Token |
| INVALID_TOKEN | æ— æ•ˆçš„Token | æ£€æŸ¥Tokenæ ¼å¼æ˜¯å¦æ­£ç¡® |

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿï¼š
- **é‚®ç®±**: dev@im-system.com
- **æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
- **æ›´æ–°æ—¶é—´**: 2025-08-13
